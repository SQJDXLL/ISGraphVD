int __fastcall set_dns_listeners(time_t now)
{
  tftp_transfer *tftp_trans; // $s0
  int i; // $s1
  serverfd *sfds; // $s0
  dnsmasq_daemon *v5; // $v0
  int osport; // $s0
  char *v7; // $v0
  listener *listeners; // $s0
  int tcpfd; // $a0
  dnsmasq_daemon *tcp_pids; // $v0
  auth_zone *auth_zones; // $v1
  dnsmasq_daemon *v12; // $v0
  int tftpfd; // $a0
  int result; // $v0
  int j; // $s0
  int v16; // $a0
  int wait; // [sp+18h] [-Ch] BYREF

  wait = 0;
  if ( (dnsmasq_daemon_0->options[1] & 0x10000000) != 0 )
  {
    i = 0;
  }
  else
  {
    tftp_trans = dnsmasq_daemon_0->tftp_trans;
    for ( i = 0; tftp_trans; ++i )
    {
      poll_listen(tftp_trans->sockfd, 1);
      tftp_trans = tftp_trans->next;
    }
  }
  if ( dnsmasq_daemon_0->port )
  {
    get_new_frec(now, &wait, 0);
    sfds = dnsmasq_daemon_0->sfds;
    if ( !sfds )
    {
      v5 = dnsmasq_daemon_0;
      goto LABEL_10;
    }
  }
  else
  {
    sfds = dnsmasq_daemon_0->sfds;
    if ( !sfds )
      goto LABEL_18;
  }
  do
  {
    poll_listen(sfds->fd, 1);
    sfds = sfds->next;
  }
  while ( sfds );
  v5 = dnsmasq_daemon_0;
LABEL_10:
  if ( v5->port )
  {
    osport = v5->osport;
    if ( !osport )
    {
      do
      {
        v7 = (char *)dnsmasq_daemon_0 + 8 * osport;
        if ( *((_WORD *)v7 + 402) )
          poll_listen(*((_DWORD *)v7 + 200), 1);
        ++osport;
      }
      while ( osport != 64 );
    }
  }
LABEL_18:
  listeners = dnsmasq_daemon_0->listeners;
  while ( listeners )
  {
    if ( listeners->fd == -1 || wait )
    {
      tcpfd = listeners->tcpfd;
    }
    else
    {
      poll_listen(listeners->fd, 1);
      tcpfd = listeners->tcpfd;
    }
    if ( tcpfd == -1 )
    {
LABEL_33:
      v12 = dnsmasq_daemon_0;
      goto LABEL_34;
    }
    tcp_pids = (dnsmasq_daemon *)dnsmasq_daemon_0->tcp_pids;
    while ( tcp_pids->options[0] )
    {
      tcp_pids = (dnsmasq_daemon *)((char *)tcp_pids + 4);
LABEL_23:
      if ( dnsmasq_daemon_0->tcp_pipes == (int *)tcp_pids )
        goto LABEL_33;
    }
    auth_zones = tcp_pids->auth_zones;
    tcp_pids = (dnsmasq_daemon *)((char *)tcp_pids + 4);
    if ( auth_zones != (auth_zone *)-1 )
      goto LABEL_23;
    poll_listen(tcpfd, 1);
    v12 = dnsmasq_daemon_0;
LABEL_34:
    if ( v12->tftp_max < i || (tftpfd = listeners->tftpfd, tftpfd == -1) )
    {
      listeners = listeners->next;
    }
    else
    {
      poll_listen(tftpfd, 1);
      listeners = listeners->next;
    }
  }
  result = wait;
  if ( (dnsmasq_daemon_0->options[0] & 0x40) == 0 )
  {
    for ( j = 0; j != 20; ++j )
    {
      v16 = dnsmasq_daemon_0->tcp_pipes[j];
      if ( v16 != -1 )
        poll_listen(v16, 1);
      result = wait;
    }
  }
  return result;
}
