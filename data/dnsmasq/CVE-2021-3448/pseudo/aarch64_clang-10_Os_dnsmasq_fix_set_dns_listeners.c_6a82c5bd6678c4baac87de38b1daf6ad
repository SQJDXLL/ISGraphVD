int __fastcall set_dns_listeners(time_t now)
{
  __int64 v1; // x8
  unsigned int *v3; // x22
  int v4; // w21
  unsigned int *v5; // x19
  __int64 v6; // x19
  __int64 v7; // x22
  __int64 v8; // x9
  _QWORD *v9; // x19
  unsigned int *v10; // x19
  __int64 v11; // x0
  __int64 v12; // x0
  __int64 v13; // x9
  __int64 v14; // x0
  __int64 i; // x19
  __int64 v16; // x0
  int wait; // [xsp+Ch] [xbp-4h] BYREF

  v1 = dnsmasq_daemon_0;
  wait = 0;
  if ( (*(_BYTE *)(dnsmasq_daemon_0 + 7) & 0x10) != 0 || (v3 = *(unsigned int **)(dnsmasq_daemon_0 + 1456)) == 0LL )
  {
    v4 = 0;
  }
  else
  {
    v4 = 0;
    do
    {
      ++v4;
      poll_listen(*v3, 1LL);
      v3 = (unsigned int *)*((_QWORD *)v3 + 13);
    }
    while ( v3 );
    v1 = dnsmasq_daemon_0;
  }
  if ( *(_DWORD *)(v1 + 412) )
  {
    get_new_frec(now, &wait, 0LL);
    v1 = dnsmasq_daemon_0;
  }
  v5 = *(unsigned int **)(v1 + 1016);
  if ( v5 )
  {
    do
    {
      poll_listen(*v5, 1LL);
      v5 = (unsigned int *)*((_QWORD *)v5 + 8);
    }
    while ( v5 );
    v1 = dnsmasq_daemon_0;
  }
  if ( *(int *)(v1 + 1248) >= 1 )
  {
    v6 = 0LL;
    v7 = 0LL;
    do
    {
      v8 = *(_QWORD *)(v1 + 1256) + v6;
      if ( *(_WORD *)(v8 + 12) )
      {
        poll_listen(*(unsigned int *)(v8 + 8), 1LL);
        v1 = dnsmasq_daemon_0;
      }
      ++v7;
      v6 += 0x10LL;
    }
    while ( v7 < *(int *)(v1 + 1248) );
  }
  v9 = *(_QWORD **)(v1 + 1272);
  if ( v9 )
  {
    do
    {
      poll_listen(*(unsigned int *)(*v9 + 8LL), 1LL);
      v9 = (_QWORD *)v9[1];
    }
    while ( v9 );
    v1 = dnsmasq_daemon_0;
  }
  v10 = *(unsigned int **)(v1 + 1032);
  if ( v10 )
  {
    do
    {
      v11 = *v10;
      if ( (_DWORD)v11 != -1 && !wait )
        poll_listen(v11, 1LL);
      v12 = v10[1];
      if ( (_DWORD)v12 != -1 )
      {
        v13 = 0LL;
        while ( *(_DWORD *)(dnsmasq_daemon_0 + v13 + 1084) || *(_DWORD *)(dnsmasq_daemon_0 + v13 + 1164) != -1 )
        {
          v13 += 4LL;
          if ( v13 == 80 )
            goto LABEL_31;
        }
        poll_listen(v12, 1LL);
      }
LABEL_31:
      if ( v4 <= *(_DWORD *)(dnsmasq_daemon_0 + 748) )
      {
        v14 = v10[2];
        if ( (_DWORD)v14 != -1 )
          poll_listen(v14, 1LL);
      }
      v10 = (unsigned int *)*((_QWORD *)v10 + 7);
    }
    while ( v10 );
    v1 = dnsmasq_daemon_0;
  }
  if ( (*(_BYTE *)v1 & 0x40) == 0 )
  {
    for ( i = 1164LL; ; i += 4LL )
    {
      v16 = *(unsigned int *)(v1 + i);
      if ( (_DWORD)v16 != -1 )
        poll_listen(v16, 1LL);
      if ( i == 1240 )
        break;
      v1 = dnsmasq_daemon_0;
    }
  }
  return wait;
}
