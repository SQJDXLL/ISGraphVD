int __fastcall set_dns_listeners(time_t now)
{
  _DWORD *i; // [sp+14h] [+14h]
  int v3; // [sp+18h] [+18h]
  int k; // [sp+1Ch] [+1Ch]
  int n; // [sp+1Ch] [+1Ch]
  int ii; // [sp+1Ch] [+1Ch]
  int v7; // [sp+20h] [+20h] BYREF
  _DWORD *m; // [sp+24h] [+24h]
  _DWORD *j; // [sp+28h] [+28h]
  time_t v10; // [sp+2Ch] [+2Ch]

  v10 = now;
  v7 = 0;
  v3 = 0;
  if ( (*(_BYTE *)(dnsmasq_daemon_0 + 7) & 0x10) == 0 )
  {
    for ( i = *(_DWORD **)(dnsmasq_daemon_0 + 1420); i; i = (_DWORD *)i[22] )
    {
      ++v3;
      poll_listen(*i, 1);
    }
  }
  if ( *(_DWORD *)(dnsmasq_daemon_0 + 224) )
    get_new_frec(v10, &v7, 0);
  for ( j = *(_DWORD **)(dnsmasq_daemon_0 + 600); j; j = (_DWORD *)j[16] )
    poll_listen(*j, 1);
  if ( *(_DWORD *)(dnsmasq_daemon_0 + 224) && !*(_DWORD *)(dnsmasq_daemon_0 + 140) )
  {
    for ( k = 0; k < 64; ++k )
    {
      if ( *(_WORD *)(dnsmasq_daemon_0 + 8 * k + 804) )
        poll_listen(*(_DWORD *)(dnsmasq_daemon_0 + 8 * k + 800), 1);
    }
  }
  for ( m = *(_DWORD **)(dnsmasq_daemon_0 + 608); m; m = (_DWORD *)m[12] )
  {
    if ( *m != -1 && !v7 )
      poll_listen(*m, 1);
    if ( m[1] != -1 )
    {
      for ( n = 0; n < 20; ++n )
      {
        if ( !*(_DWORD *)(dnsmasq_daemon_0 + 4 * n + 636) && *(_DWORD *)(dnsmasq_daemon_0 + 4 * n + 716) == -1 )
        {
          poll_listen(m[1], 1);
          break;
        }
      }
    }
    if ( *(_DWORD *)(dnsmasq_daemon_0 + 408) >= v3 && m[2] != -1 )
      poll_listen(m[2], 1);
  }
  if ( (*(_BYTE *)dnsmasq_daemon_0 & 0x40) == 0 )
  {
    for ( ii = 0; ii < 20; ++ii )
    {
      if ( *(_DWORD *)(dnsmasq_daemon_0 + 4 * ii + 716) != -1 )
        poll_listen(*(_DWORD *)(dnsmasq_daemon_0 + 4 * ii + 716), 1);
    }
  }
  return v7;
}
