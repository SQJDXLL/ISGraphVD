int __fastcall set_dns_listeners(time_t now)
{
  tftp_transfer *tftp_trans; // $s0
  int i; // $s2
  serverfd *j; // $s0
  dnsmasq_daemon *v5; // $v1
  int v6; // $s1
  int v7; // $s0
  randfd *v8; // $v0
  randfd_list *k; // $s0
  listener *listeners; // $s0
  int tcpfd; // $a0
  dnsmasq_daemon *tcp_pids; // $v0
  auth_zone *auth_zones; // $v1
  dnsmasq_daemon *v14; // $v0
  int tftpfd; // $a0
  int result; // $v0
  int m; // $s0
  int v18; // $a0
  int wait; // [sp+18h] [-Ch] BYREF

  wait = 0;
  if ( (dnsmasq_daemon_0->options[1] & 0x10000000) != 0 )
  {
    i = 0;
  }
  else
  {
    tftp_trans = dnsmasq_daemon_0->tftp_trans;
    for ( i = 0; tftp_trans; ++i )
    {
      poll_listen(tftp_trans->sockfd, 1);
      tftp_trans = tftp_trans->next;
    }
  }
  if ( dnsmasq_daemon_0->port )
    get_new_frec(now, &wait, 0);
  for ( j = dnsmasq_daemon_0->sfds; j; j = j->next )
    poll_listen(j->fd, 1);
  v5 = dnsmasq_daemon_0;
  v6 = 0;
  if ( dnsmasq_daemon_0->numrrand > 0 )
  {
    v7 = 0;
    do
    {
      v8 = &v5->randomsocks[v6];
      if ( v8->refcount )
        poll_listen(v8->fd, 1);
      ++v7;
      v5 = dnsmasq_daemon_0;
      ++v6;
    }
    while ( v7 < dnsmasq_daemon_0->numrrand );
  }
  for ( k = v5->rfl_poll; k; k = k->next )
    poll_listen(k->rfd->fd, 1);
  listeners = dnsmasq_daemon_0->listeners;
  while ( listeners )
  {
    if ( listeners->fd == -1 || wait )
    {
      tcpfd = listeners->tcpfd;
    }
    else
    {
      poll_listen(listeners->fd, 1);
      tcpfd = listeners->tcpfd;
    }
    if ( tcpfd == -1 )
    {
LABEL_32:
      v14 = dnsmasq_daemon_0;
      goto LABEL_33;
    }
    tcp_pids = (dnsmasq_daemon *)dnsmasq_daemon_0->tcp_pids;
    while ( tcp_pids->options[0] )
    {
      tcp_pids = (dnsmasq_daemon *)((char *)tcp_pids + 4);
LABEL_22:
      if ( tcp_pids == (dnsmasq_daemon *)dnsmasq_daemon_0->tcp_pipes )
        goto LABEL_32;
    }
    auth_zones = tcp_pids->auth_zones;
    tcp_pids = (dnsmasq_daemon *)((char *)tcp_pids + 4);
    if ( auth_zones != (auth_zone *)-1 )
      goto LABEL_22;
    poll_listen(tcpfd, 1);
    v14 = dnsmasq_daemon_0;
LABEL_33:
    if ( v14->tftp_max < i || (tftpfd = listeners->tftpfd, tftpfd == -1) )
    {
      listeners = listeners->next;
    }
    else
    {
      poll_listen(tftpfd, 1);
      listeners = listeners->next;
    }
  }
  result = wait;
  if ( (dnsmasq_daemon_0->options[0] & 0x40) == 0 )
  {
    for ( m = 0; m != 20; ++m )
    {
      v18 = dnsmasq_daemon_0->tcp_pipes[m];
      if ( v18 != -1 )
        poll_listen(v18, 1);
      result = wait;
    }
  }
  return result;
}
