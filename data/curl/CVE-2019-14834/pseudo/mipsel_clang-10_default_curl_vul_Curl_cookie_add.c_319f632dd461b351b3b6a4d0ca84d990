Cookie *__fastcall Curl_cookie_add(
        Curl_easy *data,
        CookieInfo *c,
        int httpheader,
        int noexpire,
        int a5,
        int a6,
        int a7,
        int a8,
        const char *lineptr,
        const char *domain,
        const char *path,
        int secure)
{
  int v16; // $s3
  time_t v17; // $v0
  int v18; // $v0
  int v19; // $s1
  char *v20; // $s5
  char *i; // $s1
  int v22; // $s2
  size_t v23; // $v0
  size_t v24; // $s4
  char *v25; // $v1
  unsigned int v26; // $s6
  int v27; // $v0
  size_t v28; // $v0
  size_t v29; // $a3
  size_t v30; // $a2
  char *v31; // $fp
  int v32; // $v1
  char *v33; // $a0
  int j; // $v1
  int v35; // $a2
  size_t v36; // $s1
  size_t v37; // $s7
  int v38; // $s1
  int v39; // $v0
  const char *v40; // $v0
  char *v41; // $s2
  size_t v42; // $s4
  char *v43; // $v1
  int v44; // $v0
  int v45; // $v0
  const char *v46; // $s2
  int v47; // $s5
  int v48; // $at
  int v49; // $v0
  int v50; // $v0
  size_t v51; // $s2
  _BYTE *v52; // $v0
  const char *v53; // $s5
  int v54; // $s4
  int v55; // $v0
  const char *v56; // $a0
  int v57; // $v0
  size_t v58; // $v0
  const char *v59; // $v1
  size_t v60; // $s5
  size_t v61; // $s6
  int v62; // $v0
  int v63; // $v0
  int v64; // $v0
  int v65; // $v1
  _BOOL4 v66; // $v0
  int v67; // $v0
  unsigned int v68; // $v1
  _BOOL4 v69; // $a1
  int v70; // $v0
  int v71; // $v0
  int v72; // $s1
  char *v73; // $v0
  int v74; // $v0
  char *v75; // $v0
  char *v76; // $v0
  int v77; // $at
  int v78; // $s0
  __int64 v79; // $s2
  int next_expiration_high; // $v0
  _BOOL4 v81; // $a0
  unsigned int next_expiration; // $v1
  Cookie *v83; // $s1
  Cookie **v84; // $s0
  Cookie *next; // $v0
  Cookie **v86; // $s2
  Cookie *v87; // $s7
  char v88; // $s6
  Cookie *v89; // $s3
  int v90; // $a1
  const char *spath; // $s4
  int v92; // $s5
  char *v93; // $v0
  size_t v94; // $a2
  int v95; // $a1
  int v96; // $at
  bool v97; // dc
  int v98; // $at
  int v99; // $a1
  const char *v100; // $a0
  Cookie *v101; // $at
  Cookie *v102; // $v0
  Cookie *v103; // $v1
  Cookie *v104; // $a0
  char *v105; // $a1
  char *v106; // $a2
  char *v107; // $a3
  Cookie *v108; // $t0
  Cookie *v109; // $s2
  Cookie **v110; // $s7
  Cookie *v111; // $fp
  Cookie **p_next; // $s1
  Cookie *v113; // $s4
  __int64 v114; // $v0
  _BOOL4 v115; // $a2
  int v116; // $at
  _BOOL4 v117; // $a1
  const char *v118; // $a2
  __int64 v119; // $v0
  int v120; // $at
  _BOOL4 v121; // $a1
  int v122; // $s0
  void *v123; // $v0
  const char *v124; // $v0
  char *v125; // $s2
  size_t v126; // $s4
  char *v127; // $v1
  int v128; // $v0
  int v130; // [sp+34h] [-BCh]
  unsigned int *v131; // [sp+40h] [-B0h]
  char v132; // [sp+44h] [-ACh]
  Curl_easy *v134; // [sp+4Ch] [-A4h]
  int v135; // [sp+50h] [-A0h]
  int v136; // [sp+58h] [-98h]
  int v137; // [sp+60h] [-90h]
  int v138; // [sp+64h] [-8Ch]
  CookieInfo *v139; // [sp+68h] [-88h]
  char *v140[32]; // [sp+70h] [-80h] BYREF

  v16 = 0;
  v17 = time(0u);
  if ( data->req.setcookies >= 0x32u )
    return (Cookie *)v16;
  v136 = v17;
  v139 = c;
  v18 = Curl_ccalloc(1, 48);
  if ( !v18 )
    return (Cookie *)v16;
  v19 = v18;
  v135 = noexpire;
  v20 = (char *)lineptr;
  v138 = v18;
  if ( !httpheader )
  {
    v140[0] = 0;
    if ( !strncmp(lineptr, "#HttpOnly_", 0xAu) )
    {
      *(_BYTE *)(v19 + 35) = 1;
      v20 = (char *)(lineptr + 10);
    }
    if ( *v20 != 35 )
    {
      v75 = strchr(v20, 13);
      if ( v75 )
        *v75 = 0;
      v76 = strchr(v20, 10);
      if ( v76 )
        *v76 = 0;
      if ( strtok_r(v20, "\t", v140) )
        JUMPOUT(0x1410);
      Curl_cfree(*(_DWORD *)(v19 + 20));
      Curl_cfree(*(_DWORD *)(v19 + 12));
      Curl_cfree(*(_DWORD *)(v19 + 16));
      Curl_cfree(*(_DWORD *)(v19 + 4));
      Curl_cfree(*(_DWORD *)(v19 + 8));
      Curl_cfree(v19);
      return (Cookie *)v16;
    }
LABEL_5:
    Curl_cfree(v19);
    return (Cookie *)v16;
  }
  if ( strlen(lineptr) >= 0x1389 )
    goto LABEL_5;
  v134 = data;
  v130 = 0x7FFFFFFF - (v136 >> 31);
  v131 = (unsigned int *)(v19 + 0x18);
  v132 = 0;
  do
  {
    for ( i = v20 + 1; ; ++i )
    {
      v22 = (unsigned __int8)*v20;
      if ( v22 != 32 && v22 != 9 )
        break;
      ++v20;
    }
    v23 = strcspn(v20, ";\t\r\n=");
    if ( !v23 )
      goto LABEL_150;
    v24 = v23;
    v25 = &v20[v23];
    v26 = v23;
    while ( 1 )
    {
      v27 = (unsigned __int8)v20[v26 - 1];
      if ( v27 != 32 && v27 != 9 )
        break;
      if ( !--v26 )
      {
        v26 = 0;
        break;
      }
    }
    if ( *v25 == 61 )
    {
      v28 = strcspn(&v20[v24 + 1], ";\r\n");
      v29 = v24 + v28;
      v30 = 0;
      if ( v28 )
      {
        v31 = &i[v29];
        while ( 1 )
        {
          v32 = (unsigned __int8)*(v31 - 1);
          if ( v32 != 32 && v32 != 9 )
            break;
          --v28;
          --v31;
          if ( !v28 )
          {
            v36 = v29;
            v31 = &v20[v24 + 1];
            goto LABEL_37;
          }
        }
        v33 = &i[v24];
        for ( j = 0; j != v28; ++j )
        {
          v35 = (unsigned __int8)v33[j];
          if ( v35 != 32 && v35 != 9 )
          {
            v36 = v29;
            v30 = v28 - j;
            v31 = &v33[j];
            goto LABEL_37;
          }
        }
        v36 = v29;
        v30 = 0;
      }
      else
      {
        v36 = v24 + v28;
        v31 = &v20[v24 + 1];
      }
LABEL_37:
      v37 = v30;
      if ( ((int (__fastcall *)(char *, int))memchr)(v31, 9) )
      {
        Curl_cfree(*(_DWORD *)(v138 + 20));
        Curl_cfree(*(_DWORD *)(v138 + 12));
        Curl_cfree(*(_DWORD *)(v138 + 16));
        Curl_cfree(*(_DWORD *)(v138 + 4));
        Curl_cfree(*(_DWORD *)(v138 + 8));
        Curl_cfree(v138);
        v16 = 0;
        if ( (*((_BYTE *)&data->set + 1338) & 0x10) == 0 )
          return (Cookie *)v16;
        goto LABEL_224;
      }
      v137 = (int)&v20[v36 + 1];
      v38 = 1;
    }
    else
    {
      v137 = (int)v25;
      v37 = 0;
      v38 = 0;
      v31 = 0;
    }
    if ( v26 >= 0xFFF || v37 >= 0xFFF || v37 + v26 >= 0x1001 )
    {
      Curl_cfree(*(_DWORD *)(v138 + 20));
      Curl_cfree(*(_DWORD *)(v138 + 12));
      Curl_cfree(*(_DWORD *)(v138 + 16));
      Curl_cfree(*(_DWORD *)(v138 + 4));
      Curl_cfree(*(_DWORD *)(v138 + 8));
      Curl_cfree(v138);
      v16 = 0;
      if ( (*((_BYTE *)&data->set + 1338) & 0x10) == 0 )
        return (Cookie *)v16;
LABEL_224:
      ((void (*)(void))Curl_infof)();
      return (Cookie *)v16;
    }
    if ( v22 == 95 && v26 >= 7 && v20[1] == 95 )
    {
      if ( curl_strnequal("__Secure-", v20, 9) )
      {
        *(_BYTE *)(v138 + 40) |= 1u;
      }
      else if ( curl_strnequal("__Host-", v20, 7) )
      {
        *(_BYTE *)(v138 + 40) |= 2u;
      }
    }
    if ( *(_DWORD *)(v138 + 4) )
    {
      if ( !v37 )
      {
        if ( v26 == 8 )
        {
          if ( curl_strnequal("httponly", v20, 8) )
          {
            *(_BYTE *)(v138 + 35) = 1;
            v20 = (char *)v137;
            goto LABEL_150;
          }
        }
        else if ( v26 == 6 && curl_strnequal("secure", v20, 6) )
        {
          if ( !secure && v139->running )
            goto LABEL_303;
          *(_BYTE *)(v138 + 33) = 1;
          v20 = (char *)v137;
          goto LABEL_150;
        }
        if ( !v38 )
        {
          v20 = (char *)v137;
          goto LABEL_150;
        }
      }
      switch ( v26 )
      {
        case 7u:
          if ( curl_strnequal("version", v20, 7) )
          {
            v20 = (char *)v137;
          }
          else if ( curl_strnequal("max-age", v20, 7) )
          {
            if ( *v31 == 0x22 )
              ++v31;
            v55 = ((int (__fastcall *)(char *, _DWORD, int, unsigned int *))curlx_strtoofft)(v31, 0, 10, v131);
            if ( v55 )
            {
              v20 = (char *)v137;
              if ( v55 == 2 )
              {
                *v131 = 1;
                v131[1] = 0;
              }
              else if ( v55 == 1 )
              {
                *v131 = -1;
                v131[1] = 0x7FFFFFFF;
              }
            }
            else
            {
              v67 = v131[1];
              v68 = *v131;
              v20 = (char *)v137;
              if ( *(_QWORD *)v131 )
              {
                v69 = v130 >= v67;
                if ( v130 == v67 )
                  v69 = ~v136 >= v68;
                if ( v69 )
                {
                  *v131 = v68 + v136;
                  v131[1] = v67 + (v136 >> 31) + __CFADD__(v68, v136);
                }
                else
                {
                  *v131 = -1;
                  v131[1] = 0x7FFFFFFF;
                }
              }
              else
              {
                *v131 = 1;
                v131[1] = 0;
              }
            }
          }
          else if ( curl_strnequal("expires", v20, 7) )
          {
            if ( v37 < 0x80 && !*(_QWORD *)v131 )
            {
              memcpy(v140, v31, v37);
              *((_BYTE *)v140 + v37) = 0;
              v63 = ((int (__fastcall *)(char **))Curl_getdate_capped)(v140);
              *(_QWORD *)v131 = v63;
              if ( v63 )
              {
                if ( v63 < 0 )
                {
                  v131[1] = 0;
                  *v131 = 0;
                }
              }
              else
              {
                *v131 = 1;
                v131[1] = 0;
              }
            }
            v20 = (char *)v137;
          }
          else
          {
            v20 = (char *)v137;
          }
          break;
        case 6u:
          v49 = curl_strnequal("domain", v20, 6);
          if ( !v37 )
          {
            v20 = (char *)v137;
            break;
          }
          if ( !v49 )
          {
            v20 = (char *)v137;
            break;
          }
          v50 = (unsigned __int8)*v31;
          if ( v50 == 0x2E )
            ++v31;
          v51 = (__PAIR64__(v37, v50 ^ 0x2Eu) - 1) >> 32;
          if ( v51 == 9 && curl_strnequal(v31, "localhost", 9)
            || (v52 = (_BYTE *)memchr(v31, 46, v51)) != 0 && (unsigned int)(&v31[v51] - v52) >= 2 )
          {
            v56 = v31;
            v53 = domain;
            if ( domain )
              v56 = domain;
            v57 = ((int (__fastcall *)(const char *))Curl_host_is_ipnum)(v56);
            v54 = v57;
            if ( domain )
            {
              if ( !v57 )
                goto LABEL_110;
LABEL_90:
              domain = v53;
              if ( strncmp(v31, v53, v51) )
                goto LABEL_114;
              v54 = 1;
              if ( v51 != strlen(v53) )
                goto LABEL_114;
            }
            else
            {
              domain = 0;
            }
          }
          else
          {
            v53 = ":";
            if ( ((int (__fastcall *)(const char *))Curl_host_is_ipnum)(v53) )
              goto LABEL_90;
LABEL_110:
            v58 = strlen(v53);
            v59 = v53;
            domain = v53;
            if ( v58 < v51
              || (v60 = v58, v61 = (size_t)&v59[v58 - v51], !curl_strnequal(v31, v61, v51))
              || (v54 = 0, v60 != v51) && *(_BYTE *)(v61 - 1) != 46 )
            {
LABEL_114:
              v132 = 1;
              if ( (*((_BYTE *)&data->set + 1338) & 0x10) != 0 )
                Curl_infof(data, "skipped cookie with bad tailmatch domain: %s", v31);
              v20 = (char *)v137;
              break;
            }
          }
          Curl_cfree(*(_DWORD *)(v138 + 20));
          v64 = Curl_memdup(v31, v51 + 1);
          *(_DWORD *)(v138 + 20) = v64;
          if ( !v64 )
            goto LABEL_303;
          *(_BYTE *)(v64 + v51) = 0;
          v65 = *(_DWORD *)(v138 + 20);
          v66 = v65 == 0;
          if ( v54 | v66 )
          {
            if ( !v65 )
              goto LABEL_303;
            v132 |= v66;
            v20 = (char *)v137;
          }
          else
          {
            *(_BYTE *)(v138 + 32) = 1;
            v20 = (char *)v137;
          }
          break;
        case 4u:
          if ( curl_strnequal("path", v20, 4) )
          {
            Curl_cfree(*(_DWORD *)(v138 + 12));
            v39 = Curl_memdup(v31, v37 + 1);
            *(_DWORD *)(v138 + 12) = v39;
            if ( !v39 )
              goto LABEL_303;
            *(_BYTE *)(v39 + v37) = 0;
            if ( !*(_DWORD *)(v138 + 12) )
              goto LABEL_303;
            Curl_cfree(*(_DWORD *)(v138 + 16));
            v40 = (const char *)Curl_cstrdup(*(_DWORD *)(v138 + 12));
            if ( !v40 )
              goto LABEL_291;
            v41 = (char *)v40;
            v42 = strlen(v40);
            if ( *v41 == 34 )
              memmove(v41, v41 + 1, v42--);
            if ( v42 )
            {
              v43 = &v41[v42 - 1];
              if ( *v43 == 34 )
              {
                *v43 = 0;
                --v42;
              }
            }
            else
            {
              v42 = 0;
            }
            if ( *v41 == 47 )
            {
              v20 = (char *)v137;
              if ( v42 && v41[v42 - 1] == 47 )
                v41[v42 - 1] = 0;
              *(_DWORD *)(v138 + 16) = v41;
            }
            else
            {
              Curl_cfree(v41);
              v62 = Curl_memdup("/", 2);
              if ( !v62 )
              {
LABEL_291:
                *(_DWORD *)(v138 + 16) = 0;
                goto LABEL_303;
              }
              *(_BYTE *)(v62 + 1) = 0;
              v20 = (char *)v137;
              *(_DWORD *)(v138 + 16) = v62;
            }
          }
          else
          {
            v20 = (char *)v137;
          }
          break;
        default:
          v20 = (char *)v137;
          break;
      }
    }
    else
    {
      if ( !v38 )
        goto LABEL_303;
      Curl_cfree(0);
      v44 = Curl_memdup(v20, v26 + 1);
      *(_DWORD *)(v138 + 4) = v44;
      if ( v44 )
        *(_BYTE *)(v44 + v26) = 0;
      Curl_cfree(*(_DWORD *)(v138 + 8));
      v45 = Curl_memdup(v31, v37 + 1);
      *(_DWORD *)(v138 + 8) = v45;
      if ( v45 )
        *(_BYTE *)(v45 + v37) = 0;
      v46 = *(const char **)(v138 + 4);
      if ( !v46 )
        goto LABEL_303;
      v47 = *(_DWORD *)(v138 + 8);
      if ( !v47 )
        goto LABEL_303;
      v48 = *(unsigned __int8 *)(v47 + strcspn(*(const char **)(v138 + 8), invalid_octets_badoctets));
      v20 = (char *)v137;
      if ( v48 || v46[strcspn(v46, invalid_octets_badoctets)] )
      {
        if ( (*((_BYTE *)&data->set + 1338) & 0x10) != 0 )
          Curl_infof(data, "invalid octets in name/value, cookie dropped");
        goto LABEL_303;
      }
    }
LABEL_150:
    ++v20;
    while ( 1 )
    {
      v70 = (unsigned __int8)*(v20 - 1);
      if ( v70 != 32 && v70 != 9 )
        break;
      ++v20;
    }
  }
  while ( v70 == 59 );
  if ( (v132 & 1) != 0 )
    goto LABEL_303;
  if ( domain )
  {
    if ( !*(_DWORD *)(v138 + 20) )
    {
      v71 = Curl_cstrdup(domain);
      *(_DWORD *)(v138 + 20) = v71;
      if ( !v71 )
        goto LABEL_303;
    }
  }
  v72 = v138;
  if ( !path || *(_DWORD *)(v138 + 12) )
    goto LABEL_300;
  v73 = strchr(path, 63);
  v74 = v73 ? ((int (__fastcall *)(const char *, int, int))Curl_memrchr)(path, 47, v73 - path) : (int)strrchr(path, 47);
  if ( !v74 )
    goto LABEL_300;
  v122 = v74 - (_DWORD)path;
  v123 = (void *)Curl_cmalloc(v74 - (_DWORD)path + 2);
  *(_DWORD *)(v138 + 12) = v123;
  if ( !v123 )
  {
LABEL_303:
    Curl_cfree(*(_DWORD *)(v138 + 20));
    Curl_cfree(*(_DWORD *)(v138 + 12));
    Curl_cfree(*(_DWORD *)(v138 + 16));
    Curl_cfree(*(_DWORD *)(v138 + 4));
    Curl_cfree(*(_DWORD *)(v138 + 8));
    Curl_cfree(v138);
    return 0;
  }
  memcpy(v123, path, v122 + 1);
  v72 = v138;
  *(_BYTE *)(*(_DWORD *)(v138 + 12) + v122 + 1) = 0;
  v124 = (const char *)Curl_cstrdup(*(_DWORD *)(v138 + 12));
  if ( !v124 )
  {
LABEL_302:
    *(_DWORD *)(v138 + 16) = 0;
    goto LABEL_303;
  }
  v125 = (char *)v124;
  v126 = strlen(v124);
  if ( *v125 == 34 )
    memmove(v125, v125 + 1, v126--);
  if ( v126 )
  {
    v127 = &v125[v126 - 1];
    if ( *v127 == 34 )
    {
      *v127 = 0;
      --v126;
    }
  }
  else
  {
    v126 = 0;
  }
  if ( *v125 != 47 )
  {
    Curl_cfree(v125);
    v128 = Curl_memdup("/", 2);
    if ( v128 )
    {
      v125 = (char *)v128;
      *(_BYTE *)(v128 + 1) = 0;
      goto LABEL_299;
    }
    goto LABEL_302;
  }
  if ( v126 && v125[v126 - 1] == 47 )
    v125[v126 - 1] = 0;
LABEL_299:
  *(_DWORD *)(v138 + 16) = v125;
LABEL_300:
  if ( !*(_DWORD *)(v72 + 4) )
    goto LABEL_303;
  ++v134->req.setcookies;
  v16 = 0;
  if ( (*(_BYTE *)(v138 + 40) & 1) != 0 && !*(_BYTE *)(v138 + 33)
    || (*(_BYTE *)(v138 + 40) & 2) != 0
    && (!*(_BYTE *)(v138 + 33) || (v100 = *(const char **)(v138 + 12)) == 0
                               || strcmp(v100, "/")
                               || *(_BYTE *)(v138 + 32))
    || !v139->running && v139->newsession && !*(_QWORD *)(v138 + 24) )
  {
    Curl_cfree(*(_DWORD *)(v138 + 20));
    Curl_cfree(*(_DWORD *)(v138 + 12));
    Curl_cfree(*(_DWORD *)(v138 + 16));
    Curl_cfree(*(_DWORD *)(v138 + 4));
    Curl_cfree(*(_DWORD *)(v138 + 8));
    Curl_cfree(v138);
    return (Cookie *)v16;
  }
  *(_BYTE *)(v138 + 34) = v139->running;
  v77 = v139->lastct + 1;
  v139->lastct = v77;
  *(_DWORD *)(v138 + 36) = v77;
  if ( !v135 )
  {
    v78 = 0;
    v79 = time(0u);
    next_expiration_high = HIDWORD(v139->next_expiration);
    v81 = SHIDWORD(v79) >= next_expiration_high;
    next_expiration = v139->next_expiration;
    if ( next_expiration_high == HIDWORD(v79) )
      v81 = (unsigned int)v79 >= next_expiration;
    if ( v81 || !(~next_expiration | next_expiration_high ^ 0x7FFFFFFF) )
    {
      LODWORD(v139->next_expiration) = -1;
      HIDWORD(v139->next_expiration) = 0x7FFFFFFF;
      do
      {
        v110 = &v139->cookies[v78];
        v111 = *v110;
        if ( *v110 )
        {
          p_next = 0;
          do
          {
            v113 = v111;
            LODWORD(v114) = HIDWORD(v111->expires);
            HIDWORD(v114) = v111->expires;
            v111 = v111->next;
            if ( !v114 )
              goto LABEL_259;
            v115 = (int)v114 >= SHIDWORD(v79);
            if ( (unsigned int)v114 == HIDWORD(v79) )
              v115 = HIDWORD(v114) >= (unsigned int)v79;
            if ( v115 )
            {
LABEL_259:
              if ( v114 )
              {
                v116 = HIDWORD(v139->next_expiration);
                v117 = (int)v114 >= v116;
                if ( (unsigned int)v114 == v116 )
                  v117 = HIDWORD(v114) >= LODWORD(v139->next_expiration);
                if ( !v117 )
                {
                  LODWORD(v139->next_expiration) = HIDWORD(v114);
                  HIDWORD(v139->next_expiration) = v114;
                }
                p_next = &v113->next;
              }
              else
              {
                p_next = &v113->next;
              }
            }
            else
            {
              if ( p_next )
                *p_next = v111;
              else
                *v110 = v111;
              --v139->numcookies;
              Curl_cfree(v113->domain);
              Curl_cfree(v113->path);
              Curl_cfree(v113->spath);
              Curl_cfree(v113->name);
              Curl_cfree(v113->value);
              Curl_cfree(v113);
            }
          }
          while ( v111 );
        }
        ++v78;
      }
      while ( v78 != 63 );
    }
  }
  v83 = (Cookie *)v138;
  v84 = &v139->cookies[cookiehash(*(const char *const *)(v138 + 20))];
  next = *v84;
  if ( !*v84 )
  {
    v89 = 0;
    v88 = 0;
    goto LABEL_241;
  }
  v86 = 0;
  v87 = 0;
  v88 = 0;
  while ( 2 )
  {
    v89 = next;
    if ( ((int (__fastcall *)(char *, _DWORD))curl_strequal)(next->name, *(_DWORD *)(v138 + 4)) )
    {
      v90 = *(_DWORD *)(v138 + 20);
      if ( v89->domain )
      {
        if ( v90 && curl_strequal() )
        {
LABEL_188:
          spath = v89->spath;
          if ( spath )
          {
            v92 = *(_DWORD *)(v138 + 16);
            if ( v92 )
            {
              if ( v89->secure && !*(_BYTE *)(v138 + 33) && !secure )
              {
                v93 = strchr(spath + 1, 47);
                v94 = v93 ? v93 - spath : strlen(spath);
                if ( curl_strnequal(spath, v92, v94) )
                {
                  if ( v134 && (*((_BYTE *)&v134->set + 1338) & 0x10) != 0 )
                    ((void (*)(void))Curl_infof)();
                  goto LABEL_303;
                }
              }
            }
          }
        }
      }
      else if ( !v90 )
      {
        goto LABEL_188;
      }
    }
    if ( !v86 )
    {
      if ( !((int (__fastcall *)(char *, _DWORD))curl_strequal)(v89->name, *(_DWORD *)(v138 + 4)) )
      {
        v86 = 0;
        goto LABEL_183;
      }
      v95 = *(_DWORD *)(v138 + 20);
      if ( v89->domain )
      {
        if ( v95 && curl_strequal() )
        {
          v96 = v88 & 1 | (v89->tailmatch == *(unsigned __int8 *)(v138 + 32));
          v88 = 0;
          if ( !v96 )
          {
            v86 = 0;
            goto LABEL_183;
          }
        }
        else
        {
          v97 = (v88 & 1) != 0;
          v88 = 0;
          if ( !v97 )
          {
            v86 = 0;
            goto LABEL_183;
          }
        }
      }
      else
      {
        v98 = v88 & 1 | (v95 == 0);
        v88 = 0;
        if ( !v98 )
        {
          v86 = 0;
          goto LABEL_183;
        }
      }
      v99 = *(_DWORD *)(v138 + 16);
      if ( v89->spath )
      {
        if ( v99 )
        {
          if ( !curl_strequal() )
          {
            v88 = 0;
            v86 = 0;
            goto LABEL_183;
          }
          v88 = 0;
          v86 = 0;
          if ( (v89->spath != 0) == (*(_DWORD *)(v138 + 16) == 0) )
            goto LABEL_183;
        }
        else if ( !*(_DWORD *)(v138 + 16) )
        {
          v88 = 0;
          v86 = 0;
          goto LABEL_183;
        }
      }
      else
      {
        v88 = 0;
        v86 = 0;
        if ( v99 )
          goto LABEL_183;
      }
      v88 = 1;
      if ( *(_BYTE *)(v138 + 34) )
      {
        v87 = v89;
        v86 = (Cookie **)v138;
      }
      else
      {
        v87 = v89;
        v86 = (Cookie **)v138;
        if ( v89->livecookie )
          goto LABEL_303;
      }
    }
LABEL_183:
    next = v89->next;
    if ( v89->next )
      continue;
    break;
  }
  if ( v86 )
  {
    *v86 = v87->next;
    v86[9] = (Cookie *)v87->creationtime;
    Curl_cfree(v87->name);
    Curl_cfree(v87->value);
    Curl_cfree(v87->domain);
    Curl_cfree(v87->path);
    Curl_cfree(v87->spath);
    v101 = v86[7];
    v102 = v86[8];
    v103 = v86[9];
    v104 = v86[10];
    v105 = (char *)v86[3];
    v106 = (char *)v86[4];
    v107 = (char *)v86[5];
    v108 = v86[6];
    *((_DWORD *)&v87->prefix + 1) = v86[11];
    *(_DWORD *)&v87->prefix = v104;
    v87->creationtime = (int)v103;
    *(_DWORD *)&v87->tailmatch = v102;
    HIDWORD(v87->expires) = v101;
    LODWORD(v87->expires) = v108;
    v87->domain = v107;
    v87->spath = v106;
    v87->path = v105;
    v87->value = (char *)v86[2];
    v87->name = (char *)v86[1];
    v87->next = *v86;
    Curl_cfree(v86);
    v83 = v87;
  }
LABEL_241:
  if ( v134 && v139->running && (*((_BYTE *)&v134->set + 1338) & 0x10) != 0 )
  {
    v109 = v83;
    v118 = "Added";
    if ( (v88 & 1) != 0 )
      v118 = "Replaced";
    Curl_infof(v134, "%s cookie %s=\"%s\" for domain %s, path %s, expire %lld", v118, v83->name);
    if ( (v88 & 1) == 0 )
    {
LABEL_270:
      if ( v89 )
        v89->next = v109;
      else
        *v84 = v109;
      ++v139->numcookies;
    }
  }
  else
  {
    v109 = v83;
    if ( (v88 & 1) == 0 )
      goto LABEL_270;
  }
  LODWORD(v119) = HIDWORD(v109->expires);
  HIDWORD(v119) = v109->expires;
  if ( !v119 )
    return v109;
  v120 = HIDWORD(v139->next_expiration);
  v121 = (int)v119 >= v120;
  if ( (unsigned int)v119 == v120 )
    v121 = HIDWORD(v119) >= LODWORD(v139->next_expiration);
  if ( !v121 )
  {
    LODWORD(v139->next_expiration) = HIDWORD(v119);
    HIDWORD(v139->next_expiration) = v119;
  }
  return v109;
}
