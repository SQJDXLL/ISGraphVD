Cookie *__fastcall Curl_cookie_add(
        Curl_easy *data,
        CookieInfo *c,
        bool httpheader,
        bool noexpire,
        const char *lineptr,
        const char *domain,
        const char *path,
        bool secure)
{
  _BOOL4 v8; // r8
  char *v10; // r7
  time_t v11; // r0
  unsigned int setcookies; // r3
  Cookie *v13; // r9
  int v14; // r10
  bool v15; // zf
  size_t v16; // r6
  int v17; // t1
  bool v18; // zf
  const char *v19; // r2
  char *v20; // r3
  int v21; // r5
  int v22; // t1
  unsigned int v23; // r1
  bool v24; // zf
  CookieInfo *v25; // r5
  unsigned __int8 *v26; // r11
  size_t v27; // r0
  size_t v28; // r8
  const char *v29; // r1
  int v30; // r3
  int v31; // t1
  bool v32; // zf
  unsigned __int8 *v33; // r2
  int v34; // r3
  int v35; // t1
  bool v36; // zf
  bool v37; // cc
  _BOOL4 v38; // r3
  _BOOL4 v39; // r3
  int prefix; // r3
  unsigned int v41; // r6
  char *v43; // r0
  char *v44; // r0
  char *v45; // r10
  int v46; // r6
  int v47; // r6
  int v48; // r4
  char *v49; // r0
  int v50; // r3
  int v51; // r0
  char v52; // r3
  int v53; // r0
  int (__fastcall *v54)(const char *); // r6
  const char *v55; // r0
  char *v56; // r6
  char *v57; // r0
  int v58; // r3
  unsigned int v59; // r3
  int v60; // r4
  int v61; // r0
  int (__fastcall *v62)(const char *); // r2
  int v63; // r6
  int v64; // r0
  _BOOL4 v65; // r6
  char *v66; // r0
  int v67; // r3
  int v68; // r6
  char *v69; // r0
  _BOOL4 v70; // r3
  int v71; // r1
  int v72; // r6
  char v73; // r10
  int v74; // r0
  void (__fastcall *v75)(char *); // r2
  const char *v76; // r0
  const char *name; // r6
  bool v78; // zf
  char *v79; // r7
  _BYTE *v80; // r0
  int v81; // r0
  const char *v82; // r5
  int v83; // r0
  int v84; // r0
  int v85; // r0
  char *v86; // r0
  int v87; // r0
  unsigned int expires; // r3
  __int64 v89; // r0
  int v90; // r2
  unsigned int v91; // kr04_4
  const char *v92; // r3
  int v93; // r0
  char *v94; // r3
  _BOOL4 v95; // r2
  CookieInfo *v96; // r2
  int v97; // r3
  size_t v98; // r0
  unsigned int v99; // r4
  size_t v100; // r10
  int livecookie; // r7
  Cookie *v102; // r5
  unsigned int v103; // r3
  int v104; // r0
  char *v105; // r1
  const char *v106; // r8
  char *spath; // r11
  int v108; // r0
  char *v109; // r1
  int v110; // r0
  char *v111; // r1
  char *value; // r2
  char *v113; // r3
  void (__fastcall *v114)(Cookie *); // r8
  char *v115; // r1
  int v116; // r2
  int expires_high; // r3
  int creationtime; // r1
  int v119; // r2
  int v120; // r3
  const char *v121; // r2
  int is_ipnum; // r5
  int v123; // r0
  int v124; // r0
  char *v125; // r1
  __int64 v126; // r2
  Curl_easy *v127; // r12
  char *v128; // r0
  size_t v129; // r2
  const char *v130; // r1
  char *v131; // r0
  char *v132; // r3
  int v133; // r3
  size_t v134; // r5
  char *v135; // r0
  char *v136; // r0
  int v137; // r0
  bool v138; // zf
  void *v139; // r0
  int v140; // r0
  const char *v141; // r1
  _BOOL4 v142; // r3
  _BOOL4 v143; // r3
  CookieInfo *v144; // r3
  int v145; // [sp+0h] [bp-100h] BYREF
  char *badcookie_0; // [sp+18h] [bp-E8h]
  char *reject; // [sp+1Ch] [bp-E4h]
  CookieInfo *ca; // [sp+20h] [bp-E0h]
  const char *v149; // [sp+24h] [bp-DCh]
  Curl_easy *dataa; // [sp+28h] [bp-D8h]
  Curl_easy *v151; // [sp+30h] [bp-D0h]
  const char *noexpirea; // [sp+34h] [bp-CCh]
  time_t now; // [sp+38h] [bp-C8h]
  _BOOL4 v154; // [sp+3Ch] [bp-C4h]
  time_t badcookie; // [sp+40h] [bp-C0h]
  const char *v156; // [sp+44h] [bp-BCh]
  CookieInfo *v157; // [sp+48h] [bp-B8h]
  char *v158; // [sp+4Ch] [bp-B4h]
  char *tok_buf; // [sp+50h] [bp-B0h] BYREF
  char date[128]; // [sp+54h] [bp-ACh] BYREF

  ca = (CookieInfo *)httpheader;
  v8 = httpheader;
  v154 = noexpire;
  v151 = data;
  dataa = (Curl_easy *)c;
  noexpirea = domain;
  now = secure;
  v10 = (char *)lineptr;
  v11 = time(0u);
  setcookies = data->req.setcookies;
  badcookie = v11;
  if ( setcookies > 0x31 )
    return 0;
  v13 = (Cookie *)Curl_ccalloc(1, 48);
  if ( !v13 )
    return 0;
  if ( v8 )
  {
    if ( strlen(lineptr) <= (unsigned int)&loc_1388 )
    {
      v14 = *(unsigned __int8 *)lineptr;
      reject = ";\t\r\n=";
      v158 = (char *)&badoctets_0;
      v156 = "path";
      v157 = 0;
      if ( v14 )
        goto LABEL_6;
LABEL_17:
      v16 = strcspn(v10, reject);
      if ( !v16 )
      {
LABEL_54:
        if ( v157 )
          goto LABEL_65;
        v38 = v13->domain == 0;
        if ( !noexpirea )
          v38 = 0;
        if ( v38 )
        {
          v137 = Curl_cstrdup(noexpirea);
          v13->domain = (char *)v137;
          if ( !v137 )
            goto LABEL_65;
        }
        v39 = v13->path == 0;
        if ( !path )
          v39 = 0;
        if ( v39 )
        {
          v131 = strchr(path, 63);
          v132 = v131 ? (char *)Curl_memrchr(path, 47, v131 - path) : strrchr(path, 47);
          if ( v132 )
          {
            v133 = v132 - path;
            v134 = v133 + 1;
            v135 = (char *)Curl_cmalloc(v133 + 2);
            v13->path = v135;
            if ( !v135 )
              goto LABEL_65;
            memcpy(v135, path, v134);
            v13->path[v134] = 0;
            v136 = sanitize_cookie_path(v13->path);
            v13->spath = v136;
            if ( !v136 )
              goto LABEL_65;
          }
        }
        if ( !v13->name )
          goto LABEL_65;
        ++v151->req.setcookies;
        LOBYTE(prefix) = v13->prefix;
        if ( (prefix & 1) != 0 )
          goto LABEL_192;
        goto LABEL_63;
      }
      while ( 1 )
      {
        v19 = &v10[v16];
        v20 = &v10[v16];
        while ( 1 )
        {
          v22 = (unsigned __int8)*--v20;
          v21 = v22;
          v23 = v16;
          v24 = v22 == 9;
          if ( v22 != 9 )
            v24 = v21 == 32;
          v25 = (CookieInfo *)v24;
          --v16;
          if ( !v24 )
            break;
          if ( !v16 )
          {
            if ( *v19 == 61 )
              goto LABEL_28;
            if ( v13->name )
            {
LABEL_167:
              v14 = *(unsigned __int8 *)v19;
              v10 = (char *)v19;
              goto LABEL_53;
            }
LABEL_65:
            freecookie(v13);
            return 0;
          }
        }
        if ( *v19 == 61 )
        {
          v16 = v23;
LABEL_28:
          v26 = (unsigned __int8 *)(v19 + 1);
          v149 = v19;
          v27 = strcspn(v19 + 1, ";\r\n");
          v28 = v27;
          badcookie_0 = (char *)&v26[v27];
          if ( v27 )
          {
            v29 = &v149[v27 + 1];
            do
            {
              v31 = *(unsigned __int8 *)--v29;
              v30 = v31;
              v32 = v31 == 9;
              if ( v31 != 9 )
                v32 = v30 == 32;
              if ( !v32 )
              {
                v33 = v26;
                while ( 1 )
                {
                  v26 = v33;
                  v35 = *v33++;
                  v34 = v35;
                  v36 = v35 == 9;
                  if ( v35 != 9 )
                    v36 = v34 == 32;
                  if ( !v36 )
                    break;
                  if ( !--v28 )
                  {
                    v26 = v33;
LABEL_40:
                    v37 = v28 > 0xFFE;
                    if ( v28 <= 0xFFE )
                      v37 = v16 > 0xFFE;
                    if ( !v37 && v28 + v16 <= 0x1000 )
                    {
                      v25 = ca;
                      goto LABEL_45;
                    }
LABEL_268:
                    freecookie(v13);
                    if ( (*(&v151->set.connect_only + 4) & 0x20) != 0 )
                      Curl_infof(v151, "oversized cookie dropped, name/val %zu + %zu bytes", v16, v28);
                    return 0;
                  }
                }
                if ( !memchr(v26, 9, v28) )
                  goto LABEL_40;
                freecookie(v13);
                if ( (*(&v151->set.connect_only + 4) & 0x20) != 0 )
                  Curl_infof(v151, "cookie contains TAB, dropping");
                return 0;
              }
              --v28;
            }
            while ( v28 );
          }
          if ( v16 > 0xFFE )
          {
            v28 = 0;
            goto LABEL_268;
          }
          v25 = ca;
          v28 = 0;
        }
        else
        {
          v16 = v23;
          if ( v23 > 0xFFE )
          {
            v28 = (size_t)v25;
            goto LABEL_268;
          }
          v26 = (unsigned __int8 *)v25;
          v28 = (size_t)v25;
          badcookie_0 = (char *)v19;
        }
LABEL_45:
        if ( v16 <= 6 )
        {
          if ( !v13->name )
            goto LABEL_132;
          if ( v28 )
          {
            if ( v16 == 4 )
              goto LABEL_172;
            if ( v16 != 6 )
              goto LABEL_52;
            if ( !curl_strnequal("domain", v10, 6) )
              goto LABEL_138;
            if ( *v26 == 46 )
            {
              --v28;
              ++v26;
            }
            if ( v28 == 9 && curl_strnequal(v26, "localhost", 9)
              || (v80 = memchr(v26, 46, v28)) != 0 && v28 - (v80 - v26) > 1 )
            {
              if ( !noexpirea )
              {
                is_ipnum = Curl_host_is_ipnum(v26);
                Curl_cfree(v13->domain);
                v123 = Curl_strndup(v26, v28);
                v13->domain = (char *)v123;
                if ( !v123 )
                  goto LABEL_65;
                if ( is_ipnum )
                  goto LABEL_138;
LABEL_162:
                v13->tailmatch = 1;
                v14 = (unsigned __int8)*badcookie_0;
                v10 = badcookie_0;
                goto LABEL_53;
              }
              if ( !Curl_host_is_ipnum(noexpirea) )
                goto LABEL_160;
LABEL_153:
              v82 = noexpirea;
              if ( !strncmp((const char *)v26, noexpirea, v28) && strlen(v82) == v28 )
              {
                Curl_cfree(v13->domain);
                v83 = Curl_strndup(v26, v28);
                v13->domain = (char *)v83;
                if ( !v83 )
                  goto LABEL_65;
                goto LABEL_138;
              }
            }
            else
            {
              v81 = Curl_host_is_ipnum(":");
              noexpirea = ":";
              if ( v81 )
                goto LABEL_153;
LABEL_160:
              if ( cookie_tailmatch((const char *)v26, v28, noexpirea) )
              {
                Curl_cfree(v13->domain);
                v84 = Curl_strndup(v26, v28);
                v13->domain = (char *)v84;
                if ( !v84 )
                  goto LABEL_65;
                goto LABEL_162;
              }
            }
            if ( (*(&v151->set.connect_only + 4) & 0x20) != 0 )
              Curl_infof(v151, "skipped cookie with bad tailmatch domain: %s", (const char *)v26);
            v10 = badcookie_0;
            v14 = (unsigned __int8)*badcookie_0;
            v157 = ca;
            goto LABEL_53;
          }
          v19 = badcookie_0;
          if ( v16 != 6 )
          {
            if ( !v25 )
              goto LABEL_167;
            if ( v16 != 4 )
            {
LABEL_52:
              v10 = badcookie_0;
              v14 = (unsigned __int8)*badcookie_0;
              goto LABEL_53;
            }
LABEL_172:
            if ( curl_strnequal(v156, v10, 4) )
            {
              Curl_cfree(v13->path);
              v85 = Curl_strndup(v26, v28);
              v13->path = (char *)v85;
              if ( !v85 )
                goto LABEL_65;
              Curl_cfree(v13->spath);
              v86 = sanitize_cookie_path(v13->path);
              v13->spath = v86;
              if ( !v86 )
                goto LABEL_65;
            }
LABEL_138:
            v10 = badcookie_0;
            v14 = (unsigned __int8)*badcookie_0;
            goto LABEL_53;
          }
          if ( !curl_strnequal("secure", v10, 6) )
          {
            if ( v25 )
              curl_strnequal("domain", v10, 6);
            goto LABEL_138;
          }
          if ( !now && *(&dataa->req.writer_stack_depth + 1) )
            goto LABEL_65;
          v13->secure = 1;
          v14 = (unsigned __int8)*badcookie_0;
          v10 = badcookie_0;
          goto LABEL_53;
        }
        if ( v14 == 95 && v10[1] == 95 )
        {
          if ( curl_strnequal("__Secure-", v10, 9) )
          {
            v13->prefix |= 1u;
            if ( !v13->name )
              goto LABEL_132;
            goto LABEL_48;
          }
          if ( curl_strnequal("__Host-", v10, 7) )
          {
            v13->prefix |= 2u;
            if ( !v13->name )
            {
LABEL_132:
              if ( !v25 )
                goto LABEL_65;
              Curl_cfree(0);
              v74 = Curl_strndup(v10, v16);
              v75 = (void (__fastcall *)(char *))Curl_cfree;
              v13->name = (char *)v74;
              v75(v13->value);
              v76 = (const char *)Curl_strndup(v26, v28);
              name = v13->name;
              v78 = v76 == 0;
              if ( v76 )
                v78 = name == 0;
              v13->value = (char *)v76;
              if ( v78 )
                goto LABEL_65;
              v79 = v158;
              if ( v76[strcspn(v76, v158)] || name[strcspn(name, v79)] )
              {
                if ( (*(&v151->set.connect_only + 4) & 0x20) != 0 )
                  Curl_infof(v151, "invalid octets in name/value, cookie dropped");
                goto LABEL_65;
              }
              goto LABEL_138;
            }
            goto LABEL_48;
          }
        }
        if ( !v13->name )
          goto LABEL_132;
LABEL_48:
        if ( !v28 )
        {
          if ( v16 == 8 )
          {
            if ( !curl_strnequal("httponly", v10, 8) )
              goto LABEL_138;
            v13->httponly = 1;
            v14 = (unsigned __int8)*badcookie_0;
            v10 = badcookie_0;
            goto LABEL_53;
          }
          if ( !v25 )
            goto LABEL_138;
        }
        if ( v16 != 7 )
          goto LABEL_52;
        if ( curl_strnequal("version", v10, 7) )
          goto LABEL_138;
        if ( !curl_strnequal("max-age", v10, 7) )
        {
          if ( curl_strnequal("expires", v10, 7) )
          {
            v138 = v28 == 127;
            if ( v28 <= 0x7F )
              v138 = v13->expires == 0;
            if ( v138 )
            {
              v139 = memcpy(date, v26, v28);
              *((_BYTE *)&v145 + v28 + 0x54) = 0;
              v140 = Curl_getdate_capped(v139);
              if ( v140 )
              {
                if ( v140 >> 31 == -1 )
                  v13->expires = 0LL;
                else
                  v13->expires = v140;
              }
              else
              {
                v13->expires = 1LL;
              }
            }
          }
          goto LABEL_138;
        }
        if ( *v26 == 34 )
          ++v26;
        v87 = curlx_strtoofft(v26, 0, 10, &v13->expires);
        if ( v87 == 1 )
          goto LABEL_285;
        if ( v87 != 2 )
        {
          if ( v87 )
            goto LABEL_138;
          expires = v13->expires;
          HIDWORD(v89) = HIDWORD(v13->expires);
          if ( v13->expires )
          {
            v90 = badcookie >> 31;
            if ( __SPAIR64__(0x7FFFFFFF - (badcookie >> 0x1F), ~badcookie) >= __SPAIR64__(HIDWORD(v89), expires) )
            {
              LODWORD(v89) = badcookie;
              v91 = v13->expires;
              LODWORD(v13->expires) = expires + badcookie;
              v92 = badcookie_0;
              HIDWORD(v13->expires) = (__PAIR64__(v90, v91) + v89) >> 32;
              v10 = (char *)v92;
              v14 = *(unsigned __int8 *)v92;
              goto LABEL_53;
            }
LABEL_285:
            v130 = badcookie_0;
            v13->expires = 0x7FFFFFFFFFFFFFFFLL;
            v14 = *(unsigned __int8 *)v130;
            v10 = (char *)v130;
            goto LABEL_53;
          }
        }
        v141 = badcookie_0;
        v13->expires = 1LL;
        v14 = *(unsigned __int8 *)v141;
        v10 = (char *)v141;
LABEL_53:
        if ( !v14 )
          goto LABEL_54;
        while ( 1 )
        {
LABEL_12:
          v18 = v14 == 9;
          if ( v14 != 9 )
            v18 = v14 == 32;
          if ( !v18 )
            break;
          v17 = (unsigned __int8)*++v10;
          v14 = v17;
          if ( !v17 )
            goto LABEL_54;
        }
        if ( v14 != 59 )
          goto LABEL_54;
        do
        {
          v14 = (unsigned __int8)*++v10;
          if ( !v14 )
            goto LABEL_17;
LABEL_6:
          v15 = v14 == 9;
          if ( v14 != 9 )
            v15 = v14 == 32;
        }
        while ( v15 );
        v16 = strcspn(v10, ";\t\r\n=");
        if ( !v16 )
          goto LABEL_12;
      }
    }
LABEL_270:
    Curl_cfree(v13);
    return 0;
  }
  tok_buf = (char *)ca;
  if ( !strncmp(lineptr, "#HttpOnly_", 0xAu) )
  {
    v10 = (char *)(lineptr + 0xA);
    v13->httponly = 1;
  }
  if ( *v10 == 35 )
    goto LABEL_270;
  v43 = strchr(v10, 13);
  if ( v43 )
    *v43 = 0;
  v44 = strchr(v10, 10);
  if ( v44 )
    *v44 = 0;
  v45 = strtok_r(v10, "\t", &tok_buf);
  if ( !v45 )
    goto LABEL_65;
  badcookie_0 = "\t";
  v46 = 0;
  while ( 2 )
  {
    switch ( v46 )
    {
      case 0:
        if ( *v45 == 46 )
          ++v45;
        v47 = Curl_cstrdup(v45);
        LOBYTE(v48) = v47;
        v13->domain = (char *)v47;
        if ( v47 )
          LOBYTE(v48) = 1;
        v49 = strtok_r(0u, "\t", &tok_buf);
        if ( v49 )
          v50 = v48 & 1;
        else
          v50 = 0;
        v45 = v49;
        if ( v50 )
          goto LABEL_86;
        v143 = v47 == 0;
        v46 = 1;
        ca = (CookieInfo *)v143;
        goto LABEL_99;
      case 1:
LABEL_86:
        v51 = curl_strequal(v45, "TRUE");
        v52 = v51;
        if ( v51 )
          v52 = 1;
        v13->tailmatch = v52;
        v45 = strtok_r(0u, "\t", &tok_buf);
        if ( v45 )
          goto LABEL_89;
        v46 = 2;
        goto LABEL_128;
      case 2:
LABEL_89:
        v53 = strcmp("TRUE", v45);
        v54 = (int (__fastcall *)(const char *))Curl_cstrdup;
        if ( !v53 || !strcmp("FALSE", v45) )
        {
          reject = "/";
          v61 = v54("/");
          v62 = (int (__fastcall *)(const char *))Curl_cstrdup;
          v63 = v61;
          v13->path = (char *)v61;
          v64 = v62("/");
          v13->spath = (char *)v64;
          if ( !v64 )
          {
            v13->secure = 0;
            if ( !curl_strequal(v45, "TRUE") )
              goto LABEL_235;
            v65 = 1;
            goto LABEL_233;
          }
          v65 = v63 == 0;
        }
        else
        {
          v55 = (const char *)v54(v45);
          v13->path = (char *)v55;
          if ( !v55 )
            goto LABEL_235;
          v56 = sanitize_cookie_path(v55);
          LOBYTE(v48) = (_BYTE)v56;
          v13->spath = v56;
          if ( v56 )
            LOBYTE(v48) = 1;
          v57 = strtok_r(0u, "\t", &tok_buf);
          if ( v57 )
            v58 = v48 & 1;
          else
            v58 = 0;
          v45 = v57;
          if ( !v58 )
          {
            v59 = __clz((unsigned int)v56);
            v46 = 3;
            ca = (CookieInfo *)(v59 >> 5);
            goto LABEL_99;
          }
LABEL_230:
          v65 = 0;
        }
        v13->secure = 0;
        if ( !curl_strequal(v45, "TRUE") )
        {
          LOBYTE(v48) = !v65;
          goto LABEL_108;
        }
LABEL_233:
        if ( !now && !*(&dataa->req.writer_stack_depth + 1) )
        {
LABEL_235:
          strtok_r(0u, "\t", &tok_buf);
          goto LABEL_65;
        }
        LOBYTE(v48) = !v65;
        v13->secure = 1;
LABEL_108:
        v66 = strtok_r(0u, "\t", &tok_buf);
        if ( v66 )
          v67 = v48 & 1;
        else
          v67 = 0;
        v45 = v66;
        if ( !v67 )
        {
          ca = (CookieInfo *)v65;
          v46 = 4;
          goto LABEL_99;
        }
LABEL_112:
        v68 = curlx_strtoofft(v45, 0, 10, &v13->expires);
        v69 = strtok_r(0u, badcookie_0, &tok_buf);
        LOBYTE(v48) = v68 == 0;
        if ( v69 )
          v70 = v68 == 0;
        else
          v70 = 0;
        v45 = v69;
        if ( !v70 )
        {
          v144 = (CookieInfo *)v68;
          if ( v68 )
            v144 = (CookieInfo *)(freecookie + 1);
          v46 = 5;
          ca = v144;
          goto LABEL_99;
        }
LABEL_116:
        v71 = Curl_cstrdup(v45);
        v13->name = (char *)v71;
        if ( v71 )
        {
          if ( curl_strnequal("__Secure-", v71, 9) )
          {
            v13->prefix |= 1u;
          }
          else if ( curl_strnequal("__Host-", v13->name, 7) )
          {
            v13->prefix |= 2u;
          }
          v45 = strtok_r(0u, "\t", &tok_buf);
          if ( !v45 )
            goto LABEL_189;
LABEL_120:
          v72 = Curl_cstrdup(v45);
          v73 = v72;
          v13->value = (char *)v72;
          if ( v72 )
            v73 = 1;
          if ( strtok_r(0u, "\t", &tok_buf) )
            v48 = v73 & 1;
          else
            v48 = 0;
          if ( !v48 )
          {
            v142 = v72 == 0;
            LOBYTE(v48) = v73;
            v46 = 7;
            ca = (CookieInfo *)v142;
LABEL_99:
            if ( v46 == 7 )
              v60 = 0;
            else
              v60 = v48 & 1;
            if ( v60 )
              goto LABEL_65;
            goto LABEL_190;
          }
          v46 = 8;
          if ( !strtok_r(0u, "\t", &tok_buf) )
            goto LABEL_99;
LABEL_127:
          ++v46;
          v45 = strtok_r(0u, "\t", &tok_buf);
          if ( !v45 )
          {
LABEL_128:
            LOBYTE(v48) = 1;
            goto LABEL_99;
          }
          continue;
        }
        strtok_r(0u, "\t", &tok_buf);
        ca = (CookieInfo *)(freecookie + 1);
LABEL_189:
        v93 = Curl_cstrdup(&LC1);
        v13->value = (char *)v93;
        if ( !v93 )
          goto LABEL_65;
LABEL_190:
        if ( ca )
          goto LABEL_65;
        prefix = v13->prefix;
        if ( (v13->prefix & 1) != 0 )
        {
LABEL_192:
          if ( !v13->secure )
            goto LABEL_65;
          if ( (prefix & 2) != 0 )
            goto LABEL_194;
          goto LABEL_198;
        }
LABEL_63:
        if ( (prefix & 2) != 0 )
        {
          if ( !v13->secure )
            goto LABEL_65;
LABEL_194:
          v94 = v13->path;
          if ( !v94 || *v94 != 47 || v94[1] || v13->tailmatch )
            goto LABEL_65;
        }
LABEL_198:
        if ( !*(&dataa->req.writer_stack_depth + 1) && *(&dataa->req.writer_stack_depth + 2) && !v13->expires )
          goto LABEL_65;
        v95 = v154;
        v13->livecookie = *(&dataa->req.writer_stack_depth + 1);
        v15 = !v95;
        v96 = (CookieInfo *)dataa;
        v97 = *(_DWORD *)dataa->req.fread_eof + 1;
        *(_DWORD *)dataa->req.fread_eof = v97;
        v13->creationtime = v97;
        if ( v15 )
          remove_expired(v96);
        v98 = cookiehash(v13->domain);
        v99 = *(&dataa->magic + v98);
        v100 = v98;
        if ( !v99 )
        {
          if ( *(&dataa->req.writer_stack_depth + 1) )
          {
            v41 = (unsigned int)v13;
            if ( (*(&v151->set.connect_only + 4) & 0x20) != 0 )
            {
              livecookie = *(&dataa->magic + v98);
              v121 = "Added";
LABEL_282:
              Curl_infof(
                v151,
                "%s cookie %s=\"%s\" for domain %s, path %s, expire %lld",
                v121,
                *(const char **)(v41 + 4),
                *(const char **)(v41 + 8),
                *(const char **)(v41 + 20),
                *(const char **)(v41 + 12),
                *(_QWORD *)(v41 + 0x18));
              if ( livecookie )
                goto LABEL_254;
              if ( v99 )
                goto LABEL_252;
            }
          }
          else
          {
            v41 = (unsigned int)v13;
          }
          *(&dataa->magic + v100) = v41;
          goto LABEL_253;
        }
        livecookie = 0;
        v41 = 0;
        v102 = 0;
        while ( 2 )
        {
          if ( curl_strequal(*(_DWORD *)(v99 + 4), v13->name) )
          {
            v104 = *(_DWORD *)(v99 + 20);
            v105 = v13->domain;
            if ( v104 )
            {
              if ( v105 && curl_strequal(v104, v105) )
              {
LABEL_211:
                v106 = *(const char **)(v99 + 16);
                if ( v106 )
                {
                  spath = v13->spath;
                  if ( spath )
                  {
                    if ( *(_BYTE *)(v99 + 33) && !(now | v13->secure) )
                    {
                      v128 = strchr(v106 + 1, 47);
                      v129 = v128 ? v128 - v106 : strlen(v106);
                      if ( curl_strnequal(v106, spath, v129) )
                      {
                        if ( (*(&v151->set.connect_only + 4) & 0x20) != 0 )
                          Curl_infof(
                            v151,
                            "cookie '%s' for domain '%s' dropped, would overlay an existing cookie",
                            v13->name,
                            v13->domain);
                        goto LABEL_65;
                      }
                    }
                  }
                }
              }
            }
            else if ( !v105 )
            {
              goto LABEL_211;
            }
          }
          if ( v102 || !curl_strequal(*(_DWORD *)(v99 + 4), v13->name) )
          {
LABEL_205:
            v103 = *(_DWORD *)v99;
            if ( !*(_DWORD *)v99 )
              break;
            goto LABEL_206;
          }
          v108 = *(_DWORD *)(v99 + 20);
          v109 = v13->domain;
          if ( v108 )
          {
            if ( !v109 || !curl_strequal(v108, v109) || *(unsigned __int8 *)(v99 + 32) != v13->tailmatch )
            {
LABEL_221:
              if ( !livecookie )
                goto LABEL_222;
            }
          }
          else if ( v109 )
          {
            goto LABEL_221;
          }
          v124 = *(_DWORD *)(v99 + 16);
          v125 = v13->spath;
          if ( !v124 )
          {
LABEL_246:
            if ( (v124 == 0) != (v125 == 0) )
              goto LABEL_222;
            livecookie = v13->livecookie;
            if ( v13->livecookie )
            {
              v41 = v99;
              v102 = v13;
            }
            else
            {
              if ( *(_BYTE *)(v99 + 34) )
                goto LABEL_65;
              v41 = v99;
              v102 = v13;
              livecookie = 1;
            }
            goto LABEL_205;
          }
          if ( v125 && curl_strequal(v124, v125) )
          {
            v124 = *(_DWORD *)(v99 + 16);
            v125 = v13->spath;
            goto LABEL_246;
          }
LABEL_222:
          v103 = *(_DWORD *)v99;
          livecookie = 0;
          if ( *(_DWORD *)v99 )
          {
LABEL_206:
            v99 = v103;
            continue;
          }
          break;
        }
        if ( v102 )
        {
          v102->next = *(Cookie **)v41;
          v110 = *(_DWORD *)(v41 + 4);
          v102->creationtime = *(_DWORD *)(v41 + 36);
          Curl_cfree(v110);
          Curl_cfree(*(_DWORD *)(v41 + 8));
          Curl_cfree(*(_DWORD *)(v41 + 20));
          Curl_cfree(*(_DWORD *)(v41 + 12));
          Curl_cfree(*(_DWORD *)(v41 + 16));
          v111 = v102->name;
          value = v102->value;
          v113 = v102->path;
          v114 = (void (__fastcall *)(Cookie *))Curl_cfree;
          *(_DWORD *)v41 = v102->next;
          *(_DWORD *)(v41 + 4) = v111;
          *(_DWORD *)(v41 + 8) = value;
          *(_DWORD *)(v41 + 12) = v113;
          v115 = v102->domain;
          v116 = v102->expires;
          expires_high = HIDWORD(v102->expires);
          *(_DWORD *)(v41 + 16) = v102->spath;
          *(_DWORD *)(v41 + 20) = v115;
          *(_DWORD *)(v41 + 24) = v116;
          *(_DWORD *)(v41 + 28) = expires_high;
          creationtime = v102->creationtime;
          v119 = *(_DWORD *)&v102->prefix;
          v120 = *((_DWORD *)&v102->prefix + 1);
          *(_DWORD *)(v41 + 32) = *(_DWORD *)&v102->tailmatch;
          *(_DWORD *)(v41 + 36) = creationtime;
          *(_DWORD *)(v41 + 40) = v119;
          *(_DWORD *)(v41 + 44) = v120;
          v114(v102);
        }
        else
        {
          v41 = (unsigned int)v13;
        }
        if ( *(&dataa->req.writer_stack_depth + 1) && (*(&v151->set.connect_only + 4) & 0x20) != 0 )
        {
          if ( livecookie )
            v121 = "Replaced";
          else
            v121 = "Added";
          goto LABEL_282;
        }
        if ( livecookie )
          goto LABEL_254;
LABEL_252:
        *(_DWORD *)v99 = v41;
LABEL_253:
        ++dataa->req.doh;
LABEL_254:
        v126 = *(_QWORD *)(v41 + 0x18);
        if ( v126 )
        {
          v127 = dataa;
          if ( v126 < *(_QWORD *)&dataa->req.upload_fromhere )
          {
            dataa->req.upload_fromhere = (char *)v126;
            v127->req.p.file = (FILEPROTO *)HIDWORD(v126);
          }
        }
        return (Cookie *)v41;
      case 3:
        goto LABEL_230;
      case 4:
        goto LABEL_112;
      case 5:
        goto LABEL_116;
      case 6:
        goto LABEL_120;
      default:
        goto LABEL_127;
    }
  }
}
