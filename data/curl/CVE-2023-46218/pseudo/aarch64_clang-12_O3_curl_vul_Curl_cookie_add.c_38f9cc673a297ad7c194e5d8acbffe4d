Cookie *__fastcall Curl_cookie_add(
        Curl_easy *data,
        CookieInfo *c,
        bool httpheader,
        bool noexpire,
        char *lineptr,
        const char *domain,
        char *path,
        bool secure)
{
  time_t v15; // x0
  unsigned int setcookies; // w8
  __int64 v17; // x28
  __int64 v18; // x0
  __int64 v19; // x19
  const char *j; // x25
  int v21; // w26
  size_t v22; // x0
  size_t v23; // x28
  const char *v24; // x20
  unsigned __int64 v25; // x22
  int v26; // w8
  const char *v27; // x21
  int v28; // w24
  const char *v29; // x23
  size_t v30; // x0
  size_t v31; // x20
  const char *v32; // x8
  int v33; // w9
  __int64 k; // x9
  int v35; // w11
  size_t v36; // x28
  char v37; // w8
  __int64 v38; // x0
  const char *v39; // x0
  _BYTE *v40; // x22
  size_t v41; // x23
  size_t v42; // x8
  __int64 v43; // x0
  __int64 v44; // x0
  const char *v45; // x22
  __int64 v46; // x23
  int v47; // w0
  _BOOL8 v48; // x9
  const char *v49; // x22
  size_t v50; // x23
  _BYTE *v51; // x0
  const char *v52; // x0
  char is_ipnum; // w27
  size_t v54; // x0
  const char *v55; // x28
  size_t v56; // x27
  _QWORD *v57; // x22
  const char *v58; // x0
  int v59; // w0
  __int64 v60; // x0
  __int64 v61; // x8
  __int64 v62; // x0
  int v63; // w8
  __int64 v64; // x0
  __int64 v65; // x8
  int v66; // t1
  char *v67; // x0
  char *v68; // x0
  char *v69; // x0
  const char *v70; // x22
  int v71; // w20
  char v72; // w23
  const char *v73; // x0
  __int64 v74; // x0
  __int64 v75; // x0
  const char *v76; // x0
  _BYTE *v77; // x22
  size_t v78; // x23
  size_t v79; // x8
  __int64 v80; // x0
  char v81; // w8
  __int64 v82; // x0
  __int64 v83; // x0
  bool v84; // w20
  __int64 v85; // x0
  __int64 v86; // x0
  char *v87; // x0
  __int64 v88; // x0
  char v89; // w8
  __int64 v90; // x0
  char *v91; // x0
  char *v92; // x0
  signed __int64 v93; // x20
  void *v94; // x0
  const char *v95; // x0
  _BYTE *v96; // x22
  size_t v97; // x23
  size_t v98; // x8
  __int64 v99; // x0
  int v100; // w8
  time_t v101; // x0
  curl_off_t next_expiration; // x8
  time_t v103; // x22
  Cookie **v104; // x20
  Cookie *next; // x8
  __int64 v106; // x22
  int v107; // w26
  Cookie *v108; // x25
  char *v109; // x0
  __int64 v110; // x1
  const char *spath; // x23
  __int64 v112; // x24
  char *v113; // x0
  size_t v114; // x2
  char *v115; // x0
  __int64 v116; // x1
  bool v117; // zf
  int v118; // w8
  char *v119; // x0
  __int64 v120; // x1
  const char *v121; // x0
  __int128 v122; // q0
  __int128 v123; // q1
  __int128 v124; // q2
  Cookie **v125; // x8
  curl_off_t v126; // x8
  __int64 i; // x20
  Cookie *v128; // x26
  Cookie *v129; // x27
  Cookie *v130; // x23
  curl_off_t expires; // x8
  Cookie **p_next; // x8
  const char *v133; // x2
  __int64 v135; // [xsp+8h] [xbp-D8h]
  char *s; // [xsp+10h] [xbp-D0h]
  __int64 *v137; // [xsp+18h] [xbp-C8h]
  char v138; // [xsp+24h] [xbp-BCh]
  bool v139; // [xsp+34h] [xbp-ACh]
  CookieInfo *v140; // [xsp+38h] [xbp-A8h]
  Curl_easy *v141; // [xsp+40h] [xbp-A0h]
  time_t v143; // [xsp+50h] [xbp-90h]
  char *dest[17]; // [xsp+58h] [xbp-88h] BYREF

  v15 = time(0uLL);
  setcookies = data->req.setcookies;
  v17 = 0LL;
  v143 = v15;
  if ( setcookies > 0x31 )
    return (Cookie *)v17;
  v141 = data;
  v18 = Curl_ccalloc(1LL, 72LL);
  if ( !v18 )
    return 0LL;
  v19 = v18;
  if ( !httpheader )
  {
    dest[0] = 0LL;
    if ( !strncmp(lineptr, "#HttpOnly_", 0xAuLL) )
    {
      *(_BYTE *)(v19 + 59) = 1;
      v66 = (unsigned __int8)lineptr[10];
      lineptr += 10;
      if ( v66 == 35 )
        goto LABEL_146;
    }
    else if ( *lineptr == 35 )
    {
      goto LABEL_146;
    }
    v67 = strchr(lineptr, 13);
    if ( v67 )
      *v67 = 0;
    v139 = secure;
    v68 = strchr(lineptr, 10);
    if ( v68 )
      *v68 = 0;
    v69 = strtok_r(lineptr, "\t", dest);
    if ( !v69 )
      goto LABEL_207;
    v70 = v69;
    v71 = 0;
    while ( 1 )
    {
      v72 = 0;
      switch ( v71 )
      {
        case 0:
          if ( *v70 == 46 )
            v73 = v70 + 1;
          else
            v73 = v70;
          v74 = Curl_cstrdup(v73);
          v71 = 0;
          *(_QWORD *)(v19 + 40) = v74;
          v72 = v74 == 0;
          goto LABEL_195;
        case 1:
          v72 = 0;
          *(_BYTE *)(v19 + 56) = (unsigned int)curl_strequal(v70, "TRUE") != 0;
          v71 = 1;
          goto LABEL_195;
        case 2:
          if ( !strcmp("TRUE", v70) || !strcmp("FALSE", v70) )
          {
            v83 = Curl_cstrdup("/");
            *(_QWORD *)(v19 + 24) = v83;
            v84 = v83 == 0;
            v85 = Curl_cstrdup("/");
            v72 = v84 || v85 == 0;
            *(_QWORD *)(v19 + 32) = v85;
            goto LABEL_179;
          }
          v75 = Curl_cstrdup(v70);
          *(_QWORD *)(v19 + 24) = v75;
          if ( !v75 )
          {
            v71 = 2;
            v72 = 1;
            goto LABEL_195;
          }
          v76 = (const char *)Curl_cstrdup(v75);
          v77 = v76;
          if ( !v76 )
            goto LABEL_194;
          v78 = strlen(v76);
          if ( *v77 == 34 )
            memmove(v77, v77 + 1, v78--);
          if ( v78 )
          {
            v79 = v78 - 1;
            if ( v77[v78 - 1] == 34 )
            {
              --v78;
              v77[v79] = 0;
            }
            if ( *v77 != 47 )
            {
LABEL_192:
              Curl_cfree(v77);
              v86 = Curl_memdup("/", 2LL);
              v77 = (_BYTE *)v86;
              if ( v86 )
                *(_BYTE *)(v86 + 1) = 0;
              goto LABEL_194;
            }
            if ( v78 && v77[v78 - 1] == 47 )
              v77[v78 - 1] = 0;
          }
          else if ( *v77 != 47 )
          {
            goto LABEL_192;
          }
LABEL_194:
          *(_QWORD *)(v19 + 32) = v77;
          v72 = v77 == 0LL;
          v71 = 2;
LABEL_195:
          v87 = strtok_r(0uLL, "\t", dest);
          ++v71;
          if ( (v72 & 1) != 0 || (v70 = v87) == 0LL )
          {
            if ( v71 == 6 )
            {
              v88 = Curl_cstrdup(&unk_2A65);
              v72 |= v88 == 0;
              if ( v88 )
                v71 = 7;
              else
                v71 = 6;
              *(_QWORD *)(v19 + 16) = v88;
            }
            if ( (v72 & 1) == 0 && v71 == 7 )
            {
              v89 = *(_BYTE *)(v19 + 64);
              if ( (v89 & 1) != 0 )
              {
LABEL_205:
                if ( !*(_BYTE *)(v19 + 57) )
                  goto LABEL_335;
              }
LABEL_241:
              if ( (v89 & 2) != 0 )
              {
                if ( !*(_BYTE *)(v19 + 57) )
                  goto LABEL_335;
                v121 = *(const char **)(v19 + 24);
                if ( !v121 || strcmp(v121, "/") || *(_BYTE *)(v19 + 56) )
                  goto LABEL_335;
              }
              if ( !c->running && c->newsession && !*(_QWORD *)(v19 + 48) )
                goto LABEL_335;
              *(_BYTE *)(v19 + 58) = c->running;
              v100 = c->lastct + 1;
              c->lastct = v100;
              *(_DWORD *)(v19 + 60) = v100;
              if ( !noexpire )
              {
                v101 = time(0uLL);
                next_expiration = c->next_expiration;
                v103 = v101;
                if ( v101 >= next_expiration || next_expiration == 0x7FFFFFFFFFFFFFFFLL )
                {
                  c->next_expiration = 0x7FFFFFFFFFFFFFFFLL;
                  for ( i = 0LL; i != 63; ++i )
                  {
                    v128 = c->cookies[i];
                    if ( v128 )
                    {
                      v129 = 0LL;
                      do
                      {
                        while ( 1 )
                        {
                          v130 = v128;
                          expires = v128->expires;
                          v128 = v128->next;
                          if ( !expires || expires >= v103 )
                            break;
                          if ( v129 )
                            p_next = &v129->next;
                          else
                            p_next = &c->cookies[i];
                          *p_next = v128;
                          --c->numcookies;
                          Curl_cfree(v130->domain);
                          Curl_cfree(v130->path);
                          Curl_cfree(v130->spath);
                          Curl_cfree(v130->name);
                          Curl_cfree(v130->value);
                          Curl_cfree(v130);
                          if ( !v128 )
                            goto LABEL_315;
                        }
                        if ( expires && expires < c->next_expiration )
                          c->next_expiration = expires;
                        v129 = v130;
                      }
                      while ( v128 );
                    }
LABEL_315:
                    ;
                  }
                }
              }
              v104 = &c->cookies[cookiehash(*(const char *const *)(v19 + 40))];
              next = *v104;
              if ( *v104 )
              {
                v106 = 0LL;
                v17 = 0LL;
                v107 = 0;
                while ( 1 )
                {
                  v108 = next;
                  if ( !(unsigned int)curl_strequal(next->name, *(_QWORD *)(v19 + 8)) )
                    goto LABEL_249;
                  v109 = v108->domain;
                  v110 = *(_QWORD *)(v19 + 40);
                  if ( v109 )
                  {
                    if ( !v110 || !(unsigned int)curl_strequal(v109, v110) )
                      goto LABEL_249;
                  }
                  else if ( v110 )
                  {
                    goto LABEL_249;
                  }
                  spath = v108->spath;
                  if ( spath )
                  {
                    v112 = *(_QWORD *)(v19 + 32);
                    if ( v112 )
                    {
                      if ( v108->secure && !*(_BYTE *)(v19 + 57) && !v139 )
                      {
                        v113 = strchr(spath + 1, 47);
                        v114 = v113 ? v113 - spath : strlen(spath);
                        if ( (unsigned int)curl_strnequal(spath, v112, v114) )
                        {
                          if ( v141 && (*((_BYTE *)&v141->set + 2238) & 0x10) != 0 )
                            Curl_infof(
                              v141,
                              "cookie '%s' for domain '%s' dropped, would overlay an existing cookie",
                              *(const char **)(v19 + 8),
                              *(const char **)(v19 + 40));
                          goto LABEL_335;
                        }
                      }
                    }
                  }
LABEL_249:
                  if ( !v106 )
                  {
                    if ( (unsigned int)curl_strequal(v108->name, *(_QWORD *)(v19 + 8)) )
                    {
                      v115 = v108->domain;
                      v116 = *(_QWORD *)(v19 + 40);
                      if ( v115 )
                      {
                        if ( v116 && (unsigned int)curl_strequal(v115, v116) )
                        {
                          v117 = v108->tailmatch == *(unsigned __int8 *)(v19 + 56);
                          goto LABEL_270;
                        }
                        if ( (v107 & 1) == 0 )
                        {
LABEL_280:
                          v107 = 0;
                          goto LABEL_281;
                        }
                      }
                      else
                      {
                        v117 = v116 == 0;
LABEL_270:
                        v118 = v117;
                        if ( ((v107 | v118) & 1) == 0 )
                          goto LABEL_280;
                      }
                      v119 = v108->spath;
                      v120 = *(_QWORD *)(v19 + 32);
                      if ( v119 )
                      {
                        if ( v120 )
                        {
                          if ( (unsigned int)curl_strequal(v119, v120)
                            && (v108->spath != 0LL) != (*(_QWORD *)(v19 + 32) == 0LL) )
                          {
LABEL_283:
                            if ( !*(_BYTE *)(v19 + 58) && v108->livecookie )
                              goto LABEL_335;
                            v107 = 1;
                            v17 = (__int64)v108;
                            v106 = v19;
                            goto LABEL_250;
                          }
                        }
                        else if ( *(_QWORD *)(v19 + 32) )
                        {
                          goto LABEL_283;
                        }
                      }
                      else if ( !v120 )
                      {
                        goto LABEL_283;
                      }
                      goto LABEL_280;
                    }
LABEL_281:
                    v106 = 0LL;
                  }
LABEL_250:
                  next = v108->next;
                  if ( !v108->next )
                  {
                    if ( !v106 )
                      goto LABEL_302;
                    *(_QWORD *)v106 = *(_QWORD *)v17;
                    *(_DWORD *)(v106 + 60) = *(_DWORD *)(v17 + 60);
                    Curl_cfree(*(_QWORD *)(v17 + 8));
                    Curl_cfree(*(_QWORD *)(v17 + 16));
                    Curl_cfree(*(_QWORD *)(v17 + 40));
                    Curl_cfree(*(_QWORD *)(v17 + 24));
                    Curl_cfree(*(_QWORD *)(v17 + 32));
                    *(_OWORD *)v17 = *(_OWORD *)v106;
                    v123 = *(_OWORD *)(v106 + 0x20);
                    v122 = *(_OWORD *)(v106 + 48);
                    v124 = *(_OWORD *)(v106 + 16);
                    *(_QWORD *)(v17 + 64) = *(_QWORD *)(v106 + 64);
                    *(_OWORD *)(v17 + 0x20) = v123;
                    *(_OWORD *)(v17 + 48) = v122;
                    *(_OWORD *)(v17 + 16) = v124;
                    Curl_cfree(v106);
                    goto LABEL_303;
                  }
                }
              }
              v108 = 0LL;
              LOBYTE(v107) = 0;
LABEL_302:
              v17 = v19;
LABEL_303:
              if ( v141 && c->running && (*((_BYTE *)&v141->set + 2238) & 0x10) != 0 )
              {
                if ( (v107 & 1) != 0 )
                  v133 = "Replaced";
                else
                  v133 = "Added";
                Curl_infof(
                  v141,
                  "%s cookie %s=\"%s\" for domain %s, path %s, expire %ld",
                  v133,
                  *(const char **)(v17 + 8),
                  *(const char **)(v17 + 16),
                  *(const char **)(v17 + 0x28),
                  *(const char **)(v17 + 24),
                  *(_QWORD *)(v17 + 48));
                if ( (v107 & 1) == 0 )
                {
LABEL_307:
                  if ( v108 )
                    v125 = &v108->next;
                  else
                    v125 = v104;
                  *v125 = (Cookie *)v17;
                  ++c->numcookies;
                }
              }
              else if ( (v107 & 1) == 0 )
              {
                goto LABEL_307;
              }
              v126 = *(_QWORD *)(v17 + 48);
              if ( v126 && v126 < c->next_expiration )
                c->next_expiration = v126;
              return (Cookie *)v17;
            }
LABEL_207:
            Curl_cfree(*(_QWORD *)(v19 + 40));
            Curl_cfree(*(_QWORD *)(v19 + 24));
            Curl_cfree(*(_QWORD *)(v19 + 32));
            Curl_cfree(*(_QWORD *)(v19 + 8));
            Curl_cfree(*(_QWORD *)(v19 + 16));
            Curl_cfree(v19);
            return 0LL;
          }
          break;
        case 3:
LABEL_179:
          *(_BYTE *)(v19 + 57) = 0;
          if ( !(unsigned int)curl_strequal(v70, "TRUE") )
            goto LABEL_183;
          if ( v139 || c->running )
          {
            *(_BYTE *)(v19 + 57) = 1;
LABEL_183:
            v71 = 3;
          }
          else
          {
            v71 = 3;
            v72 = 1;
          }
          goto LABEL_195;
        case 4:
          v72 = (unsigned int)curlx_strtoofft(v70, 0LL, 10LL, v19 + 0x30) != 0;
          v71 = 4;
          goto LABEL_195;
        case 5:
          v80 = Curl_cstrdup(v70);
          *(_QWORD *)(v19 + 8) = v80;
          if ( !v80 )
          {
            v71 = 5;
            v72 = 1;
            goto LABEL_195;
          }
          if ( (unsigned int)curl_strnequal("__Secure-", v80, 9LL) )
          {
            v72 = 0;
            v81 = *(_BYTE *)(v19 + 64) | 1;
LABEL_187:
            *(_BYTE *)(v19 + 64) = v81;
            v71 = 5;
            goto LABEL_195;
          }
          v72 = 0;
          if ( (unsigned int)curl_strnequal("__Host-", *(_QWORD *)(v19 + 8), 7LL) )
          {
            v81 = *(_BYTE *)(v19 + 64) | 2;
            goto LABEL_187;
          }
          v71 = 5;
          goto LABEL_195;
        case 6:
          v82 = Curl_cstrdup(v70);
          v72 = v82 == 0;
          v71 = 6;
          *(_QWORD *)(v19 + 16) = v82;
          goto LABEL_195;
        default:
          goto LABEL_195;
      }
    }
  }
  if ( strlen(lineptr) > 0x1388 )
  {
LABEL_146:
    Curl_cfree(v19);
    return 0LL;
  }
  s = path;
  v137 = (__int64 *)(v19 + 0x30);
  v139 = secure;
  v138 = 0;
  v140 = c;
  v135 = 0x7FFFFFFFFFFFFFFFLL - v143;
  while ( 1 )
  {
    for ( j = lineptr + 1; ; ++j )
    {
      v21 = (unsigned __int8)*lineptr;
      if ( v21 != 32 && v21 != 9 )
        break;
      ++lineptr;
    }
    v22 = strcspn(lineptr, ";\t\r\n=");
    if ( !v22 )
    {
      v24 = lineptr;
      goto LABEL_126;
    }
    v23 = v22;
    v24 = &lineptr[v22];
    v25 = v22;
    do
    {
      v26 = (unsigned __int8)lineptr[v25 - 1];
      if ( v26 != 32 && v26 != 9 )
        break;
      --v25;
    }
    while ( v25 );
    v27 = domain;
    v28 = *(unsigned __int8 *)v24;
    if ( v28 == 61 )
    {
      v29 = &lineptr[v22 + 1];
      v30 = strcspn(v29, ";\r\n");
      v31 = v23 + v30;
      if ( v30 )
      {
        v32 = &j[v31];
        while ( 1 )
        {
          v33 = *((unsigned __int8 *)v32 - 1);
          if ( v33 != 32 && v33 != 9 )
            break;
          --v30;
          --v32;
          if ( !v30 )
            goto LABEL_28;
        }
        for ( k = 0LL; k != v30; ++k )
        {
          v35 = (unsigned __int8)j[v23 + k];
          if ( v35 != 32 && v35 != 9 )
          {
            v29 = &j[v23 + k];
            v36 = v30 - k;
            goto LABEL_29;
          }
        }
        v36 = 0LL;
        v29 = v32;
      }
      else
      {
LABEL_28:
        v36 = 0LL;
      }
LABEL_29:
      if ( memchr(v29, 9, v36) )
      {
        Curl_cfree(*(_QWORD *)(v19 + 40));
        Curl_cfree(*(_QWORD *)(v19 + 24));
        Curl_cfree(*(_QWORD *)(v19 + 32));
        Curl_cfree(*(_QWORD *)(v19 + 8));
        Curl_cfree(*(_QWORD *)(v19 + 16));
        Curl_cfree(v19);
        if ( (*((_BYTE *)&v141->set + 2238) & 0x10) != 0 )
          Curl_infof(v141, "cookie contains TAB, dropping");
        return 0LL;
      }
      v24 = &lineptr[v31 + 1];
    }
    else
    {
      v36 = 0LL;
      v29 = 0LL;
    }
    if ( v25 > 0xFFE || v36 > 0xFFE || v36 + v25 > 0x1000 )
    {
      Curl_cfree(*(_QWORD *)(v19 + 40));
      Curl_cfree(*(_QWORD *)(v19 + 24));
      Curl_cfree(*(_QWORD *)(v19 + 32));
      Curl_cfree(*(_QWORD *)(v19 + 8));
      Curl_cfree(*(_QWORD *)(v19 + 16));
      Curl_cfree(v19);
      if ( (*((_BYTE *)&v141->set + 2238) & 0x10) != 0 )
        Curl_infof(v141, "oversized cookie dropped, name/val %zu + %zu bytes", v25, v36);
      return 0LL;
    }
    if ( v21 == 95 && v25 >= 7 && lineptr[1] == 95 )
    {
      if ( (unsigned int)curl_strnequal("__Secure-", lineptr, 9LL) )
      {
        v37 = *(_BYTE *)(v19 + 64) | 1;
      }
      else
      {
        if ( !(unsigned int)curl_strnequal("__Host-", lineptr, 7LL) )
          goto LABEL_42;
        v37 = *(_BYTE *)(v19 + 64) | 2;
      }
      *(_BYTE *)(v19 + 64) = v37;
    }
LABEL_42:
    if ( !*(_QWORD *)(v19 + 8) )
      break;
    if ( !v36 )
    {
      if ( v25 == 8 )
      {
        if ( (unsigned int)curl_strnequal("httponly", lineptr, 8LL) )
        {
          *(_BYTE *)(v19 + 59) = 1;
LABEL_101:
          domain = v27;
          c = v140;
          goto LABEL_126;
        }
      }
      else if ( v25 == 6 && (unsigned int)curl_strnequal("secure", lineptr, 6LL) )
      {
        domain = v27;
        c = v140;
        if ( !v139 && v140->running )
          goto LABEL_335;
        *(_BYTE *)(v19 + 57) = 1;
        goto LABEL_126;
      }
      if ( v28 != 61 )
        goto LABEL_101;
    }
    if ( v25 == 7 )
    {
      domain = v27;
      if ( (unsigned int)curl_strnequal("version", lineptr, 7LL) )
      {
        c = v140;
        goto LABEL_126;
      }
      if ( (unsigned int)curl_strnequal("max-age", lineptr, 7LL) )
      {
        v57 = (_QWORD *)(v19 + 0x30);
        if ( *v29 == 34 )
          v58 = v29 + 1;
        else
          v58 = v29;
        v59 = curlx_strtoofft(v58, 0LL, 10LL, v137);
        if ( v59 )
        {
          c = v140;
          if ( v59 != 2 )
          {
            if ( v59 != 1 )
              goto LABEL_126;
LABEL_141:
            *v137 = 0x7FFFFFFFFFFFFFFFLL;
            goto LABEL_126;
          }
          goto LABEL_142;
        }
        v65 = *v137;
        c = v140;
        if ( !*v137 )
          goto LABEL_142;
        if ( v135 < v65 )
          goto LABEL_141;
        *v137 = v65 + v143;
      }
      else
      {
        c = v140;
        if ( (unsigned int)curl_strnequal("expires", lineptr, 7LL) )
        {
          v57 = (_QWORD *)(v19 + 0x30);
          if ( v36 <= 0x7F && !*v137 )
          {
            memcpy(dest, v29, v36);
            *((_BYTE *)dest + v36) = 0;
            v64 = Curl_getdate_capped(dest);
            *v137 = v64;
            if ( v64 )
            {
              if ( (v64 & 0x8000000000000000LL) != 0 )
                *v137 = 0LL;
              goto LABEL_126;
            }
LABEL_142:
            *v57 = 1LL;
          }
        }
      }
    }
    else
    {
      domain = v27;
      if ( v25 == 6 )
      {
        v47 = curl_strnequal("domain", lineptr, 6LL);
        c = v140;
        if ( v36 && v47 )
        {
          v48 = *(unsigned __int8 *)v29 == 46;
          if ( *v29 == 46 )
            v49 = v29 + 1;
          else
            v49 = v29;
          v50 = v36 - v48;
          if ( v36 - v48 == 9 && (unsigned int)curl_strnequal(v49, "localhost", 9LL)
            || (v51 = memchr(v49, 46, v50)) != 0LL && (unsigned __int64)(&v49[v50] - v51) > 1 )
          {
            if ( domain )
              v52 = domain;
            else
              v52 = v49;
            is_ipnum = Curl_host_is_ipnum(v52);
            if ( !domain )
              goto LABEL_115;
            if ( (is_ipnum & 1) == 0 )
              goto LABEL_93;
LABEL_112:
            if ( !strncmp(v49, domain, v50) && v50 == strlen(domain) )
            {
              is_ipnum = 1;
LABEL_115:
              Curl_cfree(*(_QWORD *)(v19 + 40));
              v60 = Curl_memdup(v49, v50 + 1);
              *(_QWORD *)(v19 + 40) = v60;
              if ( !v60 )
                goto LABEL_335;
              *(_BYTE *)(v60 + v50) = 0;
              v61 = *(_QWORD *)(v19 + 40);
              if ( is_ipnum & 1 | (v61 == 0) )
              {
                if ( !v61 )
                  goto LABEL_335;
                v138 |= v61 == 0;
              }
              else
              {
                *(_BYTE *)(v19 + 56) = 1;
              }
              goto LABEL_126;
            }
          }
          else
          {
            domain = ":";
            if ( (Curl_host_is_ipnum(":") & 1) != 0 )
              goto LABEL_112;
LABEL_93:
            v54 = strlen(domain);
            if ( v54 >= v50 )
            {
              v55 = &domain[v54 - v50];
              v56 = v54;
              if ( (unsigned int)curl_strnequal(v49, v55, v50) )
              {
                if ( v56 == v50 || *(v55 - 1) == 46 )
                {
                  is_ipnum = 0;
                  goto LABEL_115;
                }
              }
            }
          }
          if ( (*((_BYTE *)&v141->set + 2238) & 0x10) != 0 )
            Curl_infof(v141, "skipped cookie with bad tailmatch domain: %s", v49);
          v138 = 1;
        }
      }
      else
      {
        c = v140;
        if ( v25 == 4 && (unsigned int)curl_strnequal("path", lineptr, 4LL) )
        {
          Curl_cfree(*(_QWORD *)(v19 + 24));
          v38 = Curl_memdup(v29, v36 + 1);
          *(_QWORD *)(v19 + 24) = v38;
          if ( !v38 )
            goto LABEL_335;
          *(_BYTE *)(v38 + v36) = 0;
          if ( !*(_QWORD *)(v19 + 24) )
            goto LABEL_335;
          Curl_cfree(*(_QWORD *)(v19 + 32));
          v39 = (const char *)Curl_cstrdup(*(_QWORD *)(v19 + 24));
          if ( !v39 )
            goto LABEL_334;
          v40 = v39;
          v41 = strlen(v39);
          if ( *v40 == 34 )
            memmove(v40, v40 + 1, v41--);
          if ( v41 )
          {
            v42 = v41 - 1;
            if ( v40[v41 - 1] == 34 )
            {
              --v41;
              v40[v42] = 0;
            }
            if ( *v40 == 47 )
            {
              if ( v41 && v40[v41 - 1] == 47 )
                v40[v41 - 1] = 0;
              goto LABEL_125;
            }
          }
          else if ( *v40 == 47 )
          {
LABEL_125:
            *(_QWORD *)(v19 + 32) = v40;
            goto LABEL_126;
          }
          Curl_cfree(v40);
          v62 = Curl_memdup("/", 2LL);
          if ( !v62 )
            goto LABEL_334;
          v40 = (_BYTE *)v62;
          *(_BYTE *)(v62 + 1) = 0;
          goto LABEL_125;
        }
      }
    }
LABEL_126:
    for ( lineptr = (char *)(v24 + 1); ; ++lineptr )
    {
      v63 = (unsigned __int8)*(lineptr - 1);
      if ( v63 != 32 && v63 != 9 )
        break;
    }
    if ( v63 != 59 )
    {
      if ( (v138 & 1) != 0 )
        goto LABEL_335;
      if ( domain )
      {
        if ( !*(_QWORD *)(v19 + 40) )
        {
          v90 = Curl_cstrdup(domain);
          *(_QWORD *)(v19 + 40) = v90;
          if ( !v90 )
            goto LABEL_335;
        }
      }
      if ( !s
        || *(_QWORD *)(v19 + 24)
        || ((v91 = strchr(s, 63)) == 0LL ? (v92 = strrchr(s, 47)) : (v92 = (char *)Curl_memrchr(s, 47LL, v91 - s)), !v92) )
      {
LABEL_239:
        if ( !*(_QWORD *)(v19 + 8) )
          goto LABEL_335;
        ++v141->req.setcookies;
        v89 = *(_BYTE *)(v19 + 64);
        if ( (v89 & 1) != 0 )
          goto LABEL_205;
        goto LABEL_241;
      }
      v93 = v92 - s;
      v94 = (void *)Curl_cmalloc(v92 - s + 2);
      *(_QWORD *)(v19 + 24) = v94;
      if ( !v94 )
        goto LABEL_335;
      memcpy(v94, s, v93 + 1);
      *(_BYTE *)(*(_QWORD *)(v19 + 24) + v93 + 1) = 0;
      v95 = (const char *)Curl_cstrdup(*(_QWORD *)(v19 + 24));
      if ( v95 )
      {
        v96 = v95;
        v97 = strlen(v95);
        if ( *v96 == 34 )
          memmove(v96, v96 + 1, v97--);
        if ( v97 )
        {
          v98 = v97 - 1;
          if ( v96[v97 - 1] == 34 )
          {
            --v97;
            v96[v98] = 0;
          }
          if ( *v96 == 47 )
          {
            if ( v97 && v96[v97 - 1] == 47 )
              v96[v97 - 1] = 0;
            goto LABEL_238;
          }
        }
        else if ( *v96 == 47 )
        {
LABEL_238:
          *(_QWORD *)(v19 + 32) = v96;
          goto LABEL_239;
        }
        Curl_cfree(v96);
        v99 = Curl_memdup("/", 2LL);
        if ( v99 )
        {
          v96 = (_BYTE *)v99;
          *(_BYTE *)(v99 + 1) = 0;
          goto LABEL_238;
        }
      }
LABEL_334:
      *(_QWORD *)(v19 + 32) = 0LL;
      goto LABEL_335;
    }
  }
  v117 = v28 == 61;
  domain = v27;
  c = v140;
  if ( !v117 )
    goto LABEL_335;
  Curl_cfree(0LL);
  v43 = Curl_memdup(lineptr, v25 + 1);
  *(_QWORD *)(v19 + 8) = v43;
  if ( v43 )
    *(_BYTE *)(v43 + v25) = 0;
  Curl_cfree(*(_QWORD *)(v19 + 16));
  v44 = Curl_memdup(v29, v36 + 1);
  *(_QWORD *)(v19 + 16) = v44;
  if ( v44 )
    *(_BYTE *)(v44 + v36) = 0;
  v45 = *(const char **)(v19 + 8);
  if ( !v45 )
    goto LABEL_335;
  v46 = *(_QWORD *)(v19 + 16);
  if ( !v46 )
    goto LABEL_335;
  if ( !*(_BYTE *)(v46 + strcspn(*(const char **)(v19 + 16), invalid_octets_badoctets))
    && !v45[strcspn(v45, invalid_octets_badoctets)] )
  {
    goto LABEL_126;
  }
  if ( (*((_BYTE *)&v141->set + 2238) & 0x10) != 0 )
    Curl_infof(v141, "invalid octets in name/value, cookie dropped");
LABEL_335:
  Curl_cfree(*(_QWORD *)(v19 + 40));
  Curl_cfree(*(_QWORD *)(v19 + 24));
  Curl_cfree(*(_QWORD *)(v19 + 32));
  Curl_cfree(*(_QWORD *)(v19 + 8));
  Curl_cfree(*(_QWORD *)(v19 + 16));
  Curl_cfree(v19);
  return 0LL;
}
