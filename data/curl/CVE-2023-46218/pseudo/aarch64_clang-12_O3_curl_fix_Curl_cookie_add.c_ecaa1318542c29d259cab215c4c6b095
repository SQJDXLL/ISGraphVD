Cookie *__fastcall Curl_cookie_add(
        Curl_easy *data,
        CookieInfo *c,
        bool httpheader,
        bool noexpire,
        char *lineptr,
        char *domain,
        char *path,
        bool secure)
{
  time_t v16; // x0
  __int64 v17; // x28
  __int64 v18; // x0
  __int64 v19; // x19
  const char *v20; // x26
  char *j; // x27
  int v22; // w25
  size_t v23; // x0
  size_t v24; // x28
  unsigned __int64 v25; // x23
  int v26; // w8
  int v27; // w24
  char *v28; // x20
  size_t v29; // x0
  size_t v30; // x22
  const char *v31; // x8
  int v32; // w9
  __int64 k; // x9
  int v34; // w11
  size_t v35; // x28
  char v36; // w8
  __int64 v37; // x0
  const char *v38; // x0
  char *v39; // x20
  size_t v40; // x23
  size_t v41; // x8
  const char *v42; // x0
  const char *v43; // x20
  int v44; // w8
  char *v45; // x0
  int v46; // w0
  int v47; // w0
  size_t v48; // x23
  _BYTE *v49; // x0
  char *v50; // x0
  char is_ipnum; // w27
  const char *v52; // x25
  size_t v53; // x0
  Curl_easy *v54; // x24
  __int64 v55; // x0
  __int64 v56; // x0
  const char *v57; // x28
  size_t v58; // x27
  __int64 v59; // x0
  __int64 v60; // x8
  int v61; // t1
  char *v62; // x0
  char *v63; // x0
  char *v64; // x0
  const char *v65; // x20
  int v66; // w23
  char v67; // w22
  const char *v68; // x0
  __int64 v69; // x0
  __int64 v70; // x0
  const char *v71; // x0
  char *v72; // x20
  size_t v73; // x22
  size_t v74; // x8
  __int64 v75; // x0
  char v76; // w8
  __int64 v77; // x0
  __int64 v78; // x0
  bool v79; // w22
  __int64 v80; // x0
  char *v81; // x0
  __int64 v82; // x0
  Curl_easy *v83; // x20
  bool v84; // w24
  __int64 v85; // x0
  char *v86; // x0
  char *v87; // x0
  signed __int64 v88; // x20
  void *v89; // x0
  size_t v90; // x20
  const char *v91; // x0
  char *v92; // x20
  size_t v93; // x22
  size_t v94; // x8
  __int64 v95; // x0
  int v96; // w8
  time_t v97; // x0
  curl_off_t next_expiration; // x8
  time_t v99; // x20
  Cookie **v100; // x24
  Cookie *next; // x8
  Curl_easy *v102; // x27
  __int64 v103; // x20
  int v104; // w26
  Cookie *v105; // x25
  char *v106; // x0
  __int64 v107; // x1
  const char *spath; // x22
  __int64 v109; // x23
  char *v110; // x0
  size_t v111; // x2
  char *v112; // x0
  __int64 v113; // x1
  bool v114; // zf
  int v115; // w8
  char *v116; // x0
  __int64 v117; // x1
  const char *v118; // x0
  __int128 v119; // q0
  __int128 v120; // q1
  __int128 v121; // q2
  Cookie **v123; // x8
  curl_off_t v124; // x8
  __int64 i; // x23
  Cookie *v126; // x26
  Cookie *v127; // x27
  Cookie *v128; // x22
  curl_off_t expires; // x8
  Cookie **p_next; // x8
  const char *v131; // x2
  __int64 v132; // [xsp+8h] [xbp-D8h]
  __int64 *v133; // [xsp+10h] [xbp-D0h]
  char *v134; // [xsp+18h] [xbp-C8h]
  char *v135; // [xsp+20h] [xbp-C0h]
  char v136; // [xsp+2Ch] [xbp-B4h]
  char *s; // [xsp+30h] [xbp-B0h]
  bool v138; // [xsp+3Ch] [xbp-A4h]
  Curl_easy *v139; // [xsp+40h] [xbp-A0h]
  Curl_easy *v140; // [xsp+40h] [xbp-A0h]
  Curl_easy *v141; // [xsp+40h] [xbp-A0h]
  bool v142; // [xsp+4Ch] [xbp-94h]
  time_t v143; // [xsp+50h] [xbp-90h]
  char *dest[17]; // [xsp+58h] [xbp-88h] BYREF

  v16 = time(0uLL);
  v17 = 0LL;
  if ( data->req.setcookies > 0x31u )
    return (Cookie *)v17;
  v143 = v16;
  v18 = Curl_ccalloc(1LL, 72LL);
  if ( !v18 )
    return 0LL;
  v19 = v18;
  if ( !httpheader )
  {
    dest[0] = 0LL;
    if ( !strncmp(lineptr, "#HttpOnly_", 0xAuLL) )
    {
      *(_BYTE *)(v19 + 59) = 1;
      v61 = (unsigned __int8)lineptr[10];
      lineptr += 10;
      if ( v61 == 35 )
        goto LABEL_140;
    }
    else if ( *lineptr == 35 )
    {
      goto LABEL_140;
    }
    v62 = strchr(lineptr, 13);
    if ( v62 )
      *v62 = 0;
    v63 = strchr(lineptr, 10);
    if ( v63 )
      *v63 = 0;
    v64 = strtok_r(lineptr, "\t", dest);
    if ( !v64 )
      goto LABEL_197;
    v142 = secure;
    v140 = data;
    v65 = v64;
    v66 = 0;
    while ( 1 )
    {
      v67 = 0;
      switch ( v66 )
      {
        case 0:
          if ( *v65 == 46 )
            v68 = v65 + 1;
          else
            v68 = v65;
          v69 = Curl_cstrdup(v68);
          v66 = 0;
          *(_QWORD *)(v19 + 40) = v69;
          v67 = v69 == 0;
          goto LABEL_188;
        case 1:
          v67 = 0;
          *(_BYTE *)(v19 + 56) = (unsigned int)curl_strequal(v65, "TRUE") != 0;
          v66 = 1;
          goto LABEL_188;
        case 2:
          if ( !strcmp("TRUE", v65) || !strcmp("FALSE", v65) )
          {
            v78 = Curl_cstrdup("/");
            *(_QWORD *)(v19 + 24) = v78;
            v79 = v78 == 0;
            v80 = Curl_cstrdup("/");
            v67 = v79 || v80 == 0;
            *(_QWORD *)(v19 + 32) = v80;
            goto LABEL_173;
          }
          v70 = Curl_cstrdup(v65);
          *(_QWORD *)(v19 + 24) = v70;
          if ( !v70 )
          {
            v66 = 2;
            v67 = 1;
            goto LABEL_188;
          }
          v71 = (const char *)Curl_cstrdup(v70);
          v72 = (char *)v71;
          if ( !v71 )
            goto LABEL_187;
          v73 = strlen(v71);
          if ( *v72 == 34 )
            memmove(v72, v72 + 1, v73--);
          if ( v73 )
          {
            v74 = v73 - 1;
            if ( v72[v73 - 1] == 34 )
            {
              --v73;
              v72[v74] = 0;
            }
            if ( *v72 == 47 )
            {
              if ( v73 && v72[v73 - 1] == 47 )
                v72[v73 - 1] = 0;
              goto LABEL_187;
            }
LABEL_186:
            Curl_cfree(v72);
            v72 = (char *)Curl_strndup("/", 1LL);
            goto LABEL_187;
          }
          if ( *v72 != 47 )
            goto LABEL_186;
LABEL_187:
          *(_QWORD *)(v19 + 32) = v72;
          v67 = v72 == 0LL;
          v66 = 2;
LABEL_188:
          v81 = strtok_r(0uLL, "\t", dest);
          ++v66;
          if ( (v67 & 1) != 0 || (v65 = v81) == 0LL )
          {
            if ( v66 == 6 )
            {
              v82 = Curl_cstrdup(&unk_2A5D);
              v67 |= v82 == 0;
              if ( v82 )
                v66 = 7;
              else
                v66 = 6;
              *(_QWORD *)(v19 + 16) = v82;
            }
            v83 = v140;
            v84 = noexpire;
            if ( (v67 & 1) != 0 || v66 != 7 )
            {
LABEL_197:
              Curl_cfree(*(_QWORD *)(v19 + 40));
              Curl_cfree(*(_QWORD *)(v19 + 24));
              Curl_cfree(*(_QWORD *)(v19 + 32));
              Curl_cfree(*(_QWORD *)(v19 + 8));
              Curl_cfree(*(_QWORD *)(v19 + 16));
              Curl_cfree(v19);
              return 0LL;
            }
LABEL_231:
            if ( (*(_BYTE *)(v19 + 64) & 1) != 0 && !*(_BYTE *)(v19 + 57) )
              goto LABEL_292;
            if ( (*(_BYTE *)(v19 + 64) & 2) != 0 )
            {
              if ( !*(_BYTE *)(v19 + 57) )
                goto LABEL_292;
              v118 = *(const char **)(v19 + 24);
              if ( !v118 || strcmp(v118, "/") || *(_BYTE *)(v19 + 56) )
                goto LABEL_292;
            }
            if ( !c->running && c->newsession && !*(_QWORD *)(v19 + 48) )
              goto LABEL_292;
            *(_BYTE *)(v19 + 58) = c->running;
            v141 = v83;
            v96 = c->lastct + 1;
            c->lastct = v96;
            *(_DWORD *)(v19 + 60) = v96;
            if ( !v84 )
            {
              v97 = time(0uLL);
              next_expiration = c->next_expiration;
              v99 = v97;
              if ( v97 >= next_expiration || next_expiration == 0x7FFFFFFFFFFFFFFFLL )
              {
                c->next_expiration = 0x7FFFFFFFFFFFFFFFLL;
                for ( i = 0LL; i != 63; ++i )
                {
                  v126 = c->cookies[i];
                  if ( v126 )
                  {
                    v127 = 0LL;
                    do
                    {
                      while ( 1 )
                      {
                        v128 = v126;
                        expires = v126->expires;
                        v126 = v126->next;
                        if ( !expires || expires >= v99 )
                          break;
                        if ( v127 )
                          p_next = &v127->next;
                        else
                          p_next = &c->cookies[i];
                        *p_next = v126;
                        --c->numcookies;
                        Curl_cfree(v128->domain);
                        Curl_cfree(v128->path);
                        Curl_cfree(v128->spath);
                        Curl_cfree(v128->name);
                        Curl_cfree(v128->value);
                        Curl_cfree(v128);
                        if ( !v126 )
                          goto LABEL_309;
                      }
                      if ( expires && expires < c->next_expiration )
                        c->next_expiration = expires;
                      v127 = v128;
                    }
                    while ( v126 );
                  }
LABEL_309:
                  ;
                }
              }
            }
            v100 = &c->cookies[cookiehash(*(const char *const *)(v19 + 40))];
            next = *v100;
            if ( *v100 )
            {
              v102 = v141;
              v103 = 0LL;
              v17 = 0LL;
              v104 = 0;
              while ( 1 )
              {
                v105 = next;
                if ( !(unsigned int)curl_strequal(next->name, *(_QWORD *)(v19 + 8)) )
                  goto LABEL_241;
                v106 = v105->domain;
                v107 = *(_QWORD *)(v19 + 40);
                if ( v106 )
                {
                  if ( !v107 || !(unsigned int)curl_strequal(v106, v107) )
                    goto LABEL_241;
                }
                else if ( v107 )
                {
                  goto LABEL_241;
                }
                spath = v105->spath;
                if ( spath )
                {
                  v109 = *(_QWORD *)(v19 + 32);
                  if ( v109 )
                  {
                    if ( v105->secure && !*(_BYTE *)(v19 + 57) && !v142 )
                    {
                      v110 = strchr(spath + 1, 47);
                      v111 = v110 ? v110 - spath : strlen(spath);
                      if ( (unsigned int)curl_strnequal(spath, v109, v111) )
                      {
                        if ( v141 && (*((_BYTE *)&v141->set + 2229) & 0x20) != 0 )
                          Curl_infof(
                            v141,
                            "cookie '%s' for domain '%s' dropped, would overlay an existing cookie",
                            *(const char **)(v19 + 8),
                            *(const char **)(v19 + 40));
                        goto LABEL_292;
                      }
                    }
                  }
                }
LABEL_241:
                if ( !v103 )
                {
                  if ( (unsigned int)curl_strequal(v105->name, *(_QWORD *)(v19 + 8)) )
                  {
                    v112 = v105->domain;
                    v113 = *(_QWORD *)(v19 + 40);
                    if ( v112 )
                    {
                      if ( v113 && (unsigned int)curl_strequal(v112, v113) )
                      {
                        v114 = v105->tailmatch == *(unsigned __int8 *)(v19 + 56);
                        goto LABEL_262;
                      }
                      if ( (v104 & 1) == 0 )
                      {
LABEL_272:
                        v104 = 0;
                        goto LABEL_273;
                      }
                    }
                    else
                    {
                      v114 = v113 == 0;
LABEL_262:
                      v115 = v114;
                      if ( ((v104 | v115) & 1) == 0 )
                        goto LABEL_272;
                    }
                    v116 = v105->spath;
                    v117 = *(_QWORD *)(v19 + 32);
                    if ( v116 )
                    {
                      if ( v117 )
                      {
                        if ( (unsigned int)curl_strequal(v116, v117)
                          && (v105->spath != 0LL) != (*(_QWORD *)(v19 + 32) == 0LL) )
                        {
LABEL_275:
                          if ( !*(_BYTE *)(v19 + 58) && v105->livecookie )
                            goto LABEL_292;
                          v104 = 1;
                          v17 = (__int64)v105;
                          v103 = v19;
                          goto LABEL_242;
                        }
                      }
                      else if ( *(_QWORD *)(v19 + 32) )
                      {
                        goto LABEL_275;
                      }
                    }
                    else if ( !v117 )
                    {
                      goto LABEL_275;
                    }
                    goto LABEL_272;
                  }
LABEL_273:
                  v103 = 0LL;
                }
LABEL_242:
                next = v105->next;
                if ( !v105->next )
                {
                  if ( !v103 )
                    goto LABEL_296;
                  *(_QWORD *)v103 = *(_QWORD *)v17;
                  *(_DWORD *)(v103 + 60) = *(_DWORD *)(v17 + 60);
                  Curl_cfree(*(_QWORD *)(v17 + 8));
                  Curl_cfree(*(_QWORD *)(v17 + 16));
                  Curl_cfree(*(_QWORD *)(v17 + 40));
                  Curl_cfree(*(_QWORD *)(v17 + 24));
                  Curl_cfree(*(_QWORD *)(v17 + 32));
                  *(_OWORD *)v17 = *(_OWORD *)v103;
                  v120 = *(_OWORD *)(v103 + 0x20);
                  v119 = *(_OWORD *)(v103 + 48);
                  v121 = *(_OWORD *)(v103 + 16);
                  *(_QWORD *)(v17 + 64) = *(_QWORD *)(v103 + 64);
                  *(_OWORD *)(v17 + 0x20) = v120;
                  *(_OWORD *)(v17 + 48) = v119;
                  *(_OWORD *)(v17 + 16) = v121;
                  Curl_cfree(v103);
                  goto LABEL_297;
                }
              }
            }
            v102 = v141;
            v105 = 0LL;
            LOBYTE(v104) = 0;
LABEL_296:
            v17 = v19;
LABEL_297:
            if ( v102 && c->running && (*((_BYTE *)&v102->set + 2229) & 0x20) != 0 )
            {
              if ( (v104 & 1) != 0 )
                v131 = "Replaced";
              else
                v131 = "Added";
              Curl_infof(
                v102,
                "%s cookie %s=\"%s\" for domain %s, path %s, expire %ld",
                v131,
                *(const char **)(v17 + 8),
                *(const char **)(v17 + 16),
                *(const char **)(v17 + 0x28),
                *(const char **)(v17 + 24),
                *(_QWORD *)(v17 + 48));
              if ( (v104 & 1) == 0 )
              {
LABEL_301:
                if ( v105 )
                  v123 = &v105->next;
                else
                  v123 = v100;
                *v123 = (Cookie *)v17;
                ++c->numcookies;
              }
            }
            else if ( (v104 & 1) == 0 )
            {
              goto LABEL_301;
            }
            v124 = *(_QWORD *)(v17 + 48);
            if ( v124 && v124 < c->next_expiration )
              c->next_expiration = v124;
            return (Cookie *)v17;
          }
          break;
        case 3:
LABEL_173:
          *(_BYTE *)(v19 + 57) = 0;
          if ( !(unsigned int)curl_strequal(v65, "TRUE") )
            goto LABEL_177;
          if ( secure || c->running )
          {
            *(_BYTE *)(v19 + 57) = 1;
LABEL_177:
            v66 = 3;
          }
          else
          {
            v66 = 3;
            v67 = 1;
          }
          goto LABEL_188;
        case 4:
          v67 = (unsigned int)curlx_strtoofft(v65, 0LL, 10LL, v19 + 0x30) != 0;
          v66 = 4;
          goto LABEL_188;
        case 5:
          v75 = Curl_cstrdup(v65);
          *(_QWORD *)(v19 + 8) = v75;
          if ( !v75 )
          {
            v66 = 5;
            v67 = 1;
            goto LABEL_188;
          }
          if ( (unsigned int)curl_strnequal("__Secure-", v75, 9LL) )
          {
            v67 = 0;
            v76 = *(_BYTE *)(v19 + 64) | 1;
LABEL_181:
            *(_BYTE *)(v19 + 64) = v76;
            v66 = 5;
            goto LABEL_188;
          }
          v67 = 0;
          if ( (unsigned int)curl_strnequal("__Host-", *(_QWORD *)(v19 + 8), 7LL) )
          {
            v76 = *(_BYTE *)(v19 + 64) | 2;
            goto LABEL_181;
          }
          v66 = 5;
          goto LABEL_188;
        case 6:
          v77 = Curl_cstrdup(v65);
          v67 = v77 == 0;
          v66 = 6;
          *(_QWORD *)(v19 + 16) = v77;
          goto LABEL_188;
        default:
          goto LABEL_188;
      }
    }
  }
  if ( strlen(lineptr) > 0x1388 )
  {
LABEL_140:
    Curl_cfree(v19);
    return 0LL;
  }
  v133 = (__int64 *)(v19 + 0x30);
  v134 = path;
  v135 = (char *)&data->set + 0x8B2;
  s = domain;
  v138 = noexpire;
  v142 = secure;
  v136 = 0;
  v139 = data;
  v132 = 0x7FFFFFFFFFFFFFFFLL - v143;
  while ( 1 )
  {
    v20 = lineptr + 1;
    for ( j = lineptr; ; ++j )
    {
      v22 = (unsigned __int8)*j;
      if ( v22 != 32 && v22 != 9 )
        break;
      ++v20;
    }
    v23 = strcspn(j, ";\t\r\n=");
    if ( !v23 )
    {
      lineptr = j;
      goto LABEL_64;
    }
    v24 = v23;
    lineptr = &j[v23];
    v25 = v23;
    do
    {
      v26 = (unsigned __int8)j[v25 - 1];
      if ( v26 != 32 && v26 != 9 )
        break;
      --v25;
    }
    while ( v25 );
    v27 = (unsigned __int8)*lineptr;
    if ( v27 == 61 )
      break;
    v35 = 0LL;
    v28 = 0LL;
LABEL_31:
    if ( v25 > 0xFFE || v35 > 0xFFE || v35 + v25 > 0x1000 )
    {
      Curl_cfree(*(_QWORD *)(v19 + 40));
      Curl_cfree(*(_QWORD *)(v19 + 24));
      Curl_cfree(*(_QWORD *)(v19 + 32));
      Curl_cfree(*(_QWORD *)(v19 + 8));
      Curl_cfree(*(_QWORD *)(v19 + 16));
      Curl_cfree(v19);
      if ( (v135[3] & 0x20) != 0 )
        Curl_infof(v139, "oversized cookie dropped, name/val %zu + %zu bytes", v25, v35);
      return 0LL;
    }
    if ( v22 == 95 && v25 >= 7 && j[1] == 95 )
    {
      if ( (unsigned int)curl_strnequal("__Secure-", j, 9LL) )
      {
        v36 = *(_BYTE *)(v19 + 64) | 1;
      }
      else
      {
        if ( !(unsigned int)curl_strnequal("__Host-", j, 7LL) )
          goto LABEL_42;
        v36 = *(_BYTE *)(v19 + 64) | 2;
      }
      *(_BYTE *)(v19 + 64) = v36;
    }
LABEL_42:
    if ( !*(_QWORD *)(v19 + 8) )
    {
      if ( v27 != 61 )
        goto LABEL_292;
      Curl_cfree(0LL);
      *(_QWORD *)(v19 + 8) = Curl_strndup(j, v25);
      Curl_cfree(*(_QWORD *)(v19 + 16));
      v42 = (const char *)Curl_strndup(v28, v35);
      *(_QWORD *)(v19 + 16) = v42;
      if ( !v42 )
        goto LABEL_292;
      v43 = *(const char **)(v19 + 8);
      if ( !v43 )
        goto LABEL_292;
      if ( v42[strcspn(v42, invalid_octets_badoctets)] || v43[strcspn(v43, invalid_octets_badoctets)] )
      {
        if ( (v135[3] & 0x20) != 0 )
          Curl_infof(v139, "invalid octets in name/value, cookie dropped");
        goto LABEL_292;
      }
      goto LABEL_64;
    }
    if ( !v35 )
    {
      if ( v25 == 8 )
      {
        if ( (unsigned int)curl_strnequal("httponly", j, 8LL) )
        {
          *(_BYTE *)(v19 + 59) = 1;
          goto LABEL_64;
        }
      }
      else if ( v25 == 6 && (unsigned int)curl_strnequal("secure", j, 6LL) )
      {
        if ( !v142 && c->running )
          goto LABEL_292;
        *(_BYTE *)(v19 + 57) = 1;
        goto LABEL_64;
      }
      if ( v27 != 61 )
        goto LABEL_64;
    }
    if ( v25 != 7 )
    {
      if ( v25 != 6 )
      {
        if ( v25 == 4 && (unsigned int)curl_strnequal("path", j, 4LL) )
        {
          Curl_cfree(*(_QWORD *)(v19 + 24));
          v37 = Curl_strndup(v28, v35);
          *(_QWORD *)(v19 + 24) = v37;
          if ( !v37 )
            goto LABEL_292;
          Curl_cfree(*(_QWORD *)(v19 + 32));
          v38 = (const char *)Curl_cstrdup(*(_QWORD *)(v19 + 24));
          if ( !v38 )
            goto LABEL_225;
          v39 = (char *)v38;
          v40 = strlen(v38);
          if ( *v39 == 34 )
            memmove(v39, v39 + 1, v40--);
          if ( v40 )
          {
            v41 = v40 - 1;
            if ( v39[v40 - 1] == 34 )
            {
              --v40;
              v39[v41] = 0;
            }
            if ( *v39 != 47 )
            {
LABEL_109:
              Curl_cfree(v39);
              v55 = Curl_strndup("/", 1LL);
              *(_QWORD *)(v19 + 32) = v55;
              if ( !v55 )
                goto LABEL_292;
              goto LABEL_64;
            }
            if ( v40 && v39[v40 - 1] == 47 )
              v39[v40 - 1] = 0;
          }
          else if ( *v39 != 47 )
          {
            goto LABEL_109;
          }
          *(_QWORD *)(v19 + 32) = v39;
        }
        goto LABEL_64;
      }
      v47 = curl_strnequal("domain", j, 6LL);
      if ( !v35 || !v47 )
        goto LABEL_64;
      v48 = v35 - (*v28 == 46);
      if ( *v28 == 46 )
        ++v28;
      if ( v48 != 9 || !(unsigned int)curl_strnequal(v28, "localhost", 9LL) )
      {
        v49 = memchr(v28, 46, v48);
        if ( !v49 || (unsigned __int64)(&v28[v48] - v49) <= 1 )
        {
          v52 = ":";
          if ( (Curl_host_is_ipnum(":") & 1) != 0 )
            goto LABEL_104;
LABEL_96:
          v53 = strlen(v52);
          if ( v53 >= v48 )
          {
            v57 = &v52[v53 - v48];
            v58 = v53;
            s = (char *)v52;
            if ( (unsigned int)curl_strnequal(v28, v57, v48) && (v58 == v48 || *(v57 - 1) == 46) )
            {
              is_ipnum = 0;
              goto LABEL_122;
            }
            v54 = v139;
          }
          else
          {
            v54 = v139;
          }
LABEL_132:
          s = (char *)v52;
          if ( (v135[3] & 0x20) != 0 )
            Curl_infof(v54, "skipped cookie with bad tailmatch domain: %s", v28);
          v136 = 1;
          goto LABEL_64;
        }
      }
      if ( s )
        v50 = s;
      else
        v50 = v28;
      is_ipnum = Curl_host_is_ipnum(v50);
      if ( s )
      {
        v52 = s;
        if ( (is_ipnum & 1) == 0 )
          goto LABEL_96;
LABEL_104:
        v54 = v139;
        if ( strncmp(v28, v52, v48) || v48 != strlen(v52) )
          goto LABEL_132;
        s = (char *)v52;
        is_ipnum = 1;
      }
      else
      {
        s = 0LL;
      }
LABEL_122:
      Curl_cfree(*(_QWORD *)(v19 + 40));
      v59 = Curl_strndup(v28, v48);
      *(_QWORD *)(v19 + 40) = v59;
      if ( (is_ipnum & 1) == 0 && v59 )
      {
        *(_BYTE *)(v19 + 56) = 1;
        goto LABEL_64;
      }
      if ( v59 )
      {
        v136 |= v59 == 0;
        goto LABEL_64;
      }
      v136 = 1;
LABEL_198:
      if ( (v136 & 1) != 0
        || s && !*(_QWORD *)(v19 + 40) && (v85 = Curl_cstrdup(s), (*(_QWORD *)(v19 + 40) = v85) == 0LL) )
      {
LABEL_292:
        Curl_cfree(*(_QWORD *)(v19 + 40));
        Curl_cfree(*(_QWORD *)(v19 + 24));
        Curl_cfree(*(_QWORD *)(v19 + 32));
        Curl_cfree(*(_QWORD *)(v19 + 8));
        Curl_cfree(*(_QWORD *)(v19 + 16));
        Curl_cfree(v19);
        return 0LL;
      }
      if ( !v134 || *(_QWORD *)(v19 + 24) )
        goto LABEL_229;
      v86 = strchr(v134, 63);
      v87 = v86 ? (char *)Curl_memrchr(v134, 47LL, v86 - v134) : strrchr(v134, 47);
      if ( !v87 )
        goto LABEL_229;
      v88 = v87 - v134;
      v89 = (void *)Curl_cmalloc(v87 - v134 + 2);
      *(_QWORD *)(v19 + 24) = v89;
      if ( !v89 )
        goto LABEL_292;
      v90 = v88 + 1;
      memcpy(v89, v134, v90);
      *(_BYTE *)(*(_QWORD *)(v19 + 24) + v90) = 0;
      v91 = (const char *)Curl_cstrdup(*(_QWORD *)(v19 + 24));
      if ( !v91 )
      {
LABEL_225:
        *(_QWORD *)(v19 + 32) = 0LL;
        goto LABEL_292;
      }
      v92 = (char *)v91;
      v93 = strlen(v91);
      if ( *v92 == 34 )
        memmove(v92, v92 + 1, v93--);
      if ( v93 )
      {
        v94 = v93 - 1;
        if ( v92[v93 - 1] == 34 )
        {
          --v93;
          v92[v94] = 0;
        }
        if ( *v92 == 47 )
        {
          if ( v93 && v92[v93 - 1] == 47 )
            v92[v93 - 1] = 0;
LABEL_227:
          *(_QWORD *)(v19 + 32) = v92;
LABEL_229:
          if ( !*(_QWORD *)(v19 + 8) )
            goto LABEL_292;
          v83 = v139;
          v84 = v138;
          ++v139->req.setcookies;
          goto LABEL_231;
        }
      }
      else if ( *v92 == 47 )
      {
        goto LABEL_227;
      }
      Curl_cfree(v92);
      v95 = Curl_strndup("/", 1LL);
      *(_QWORD *)(v19 + 32) = v95;
      if ( !v95 )
        goto LABEL_292;
      goto LABEL_229;
    }
    if ( !(unsigned int)curl_strnequal("version", j, 7LL) )
    {
      if ( !(unsigned int)curl_strnequal("max-age", j, 7LL) )
      {
        if ( (unsigned int)curl_strnequal("expires", j, 7LL) && v35 <= 0x7F && !*v133 )
        {
          memcpy(dest, v28, v35);
          *((_BYTE *)dest + v35) = 0;
          v56 = Curl_getdate_capped(dest);
          *v133 = v56;
          if ( v56 )
          {
            if ( (v56 & 0x8000000000000000LL) != 0 )
              *v133 = 0LL;
          }
          else
          {
            *v133 = 1LL;
          }
        }
        goto LABEL_64;
      }
      if ( *v28 == 34 )
        v45 = v28 + 1;
      else
        v45 = v28;
      v46 = curlx_strtoofft(v45, 0LL, 10LL, v133);
      switch ( v46 )
      {
        case 0:
          v60 = *v133;
          if ( !*v133 )
          {
LABEL_130:
            *v133 = 1LL;
            goto LABEL_64;
          }
          if ( v132 >= v60 )
          {
            *v133 = v60 + v143;
            goto LABEL_64;
          }
LABEL_129:
          *v133 = 0x7FFFFFFFFFFFFFFFLL;
          goto LABEL_64;
        case 2:
          goto LABEL_130;
        case 1:
          goto LABEL_129;
      }
    }
    do
    {
      do
LABEL_64:
        v44 = (unsigned __int8)*lineptr++;
      while ( v44 == 32 );
    }
    while ( v44 == 9 );
    if ( v44 != 59 )
      goto LABEL_198;
  }
  v28 = &j[v23 + 1];
  v29 = strcspn(v28, ";\r\n");
  v30 = v24 + v29;
  if ( v29 )
  {
    v31 = &v20[v30];
    while ( 1 )
    {
      v32 = *((unsigned __int8 *)v31 - 1);
      if ( v32 != 32 && v32 != 9 )
        break;
      --v29;
      --v31;
      if ( !v29 )
        goto LABEL_28;
    }
    for ( k = 0LL; k != v29; ++k )
    {
      v34 = (unsigned __int8)v20[v24 + k];
      if ( v34 != 32 && v34 != 9 )
      {
        v28 = (char *)&v20[v24 + k];
        v35 = v29 - k;
        goto LABEL_29;
      }
    }
    v35 = 0LL;
    v28 = (char *)v31;
  }
  else
  {
LABEL_28:
    v35 = 0LL;
  }
LABEL_29:
  if ( !memchr(v28, 9, v35) )
  {
    lineptr = &j[v30 + 1];
    goto LABEL_31;
  }
  Curl_cfree(*(_QWORD *)(v19 + 40));
  Curl_cfree(*(_QWORD *)(v19 + 24));
  Curl_cfree(*(_QWORD *)(v19 + 32));
  Curl_cfree(*(_QWORD *)(v19 + 8));
  Curl_cfree(*(_QWORD *)(v19 + 16));
  Curl_cfree(v19);
  if ( (v135[3] & 0x20) != 0 )
    Curl_infof(v139, "cookie contains TAB, dropping");
  return 0LL;
}
