Cookie *__fastcall Curl_cookie_add(
        Curl_easy *data,
        CookieInfo *c,
        bool httpheader,
        bool noexpire,
        const char *lineptr,
        const char *domain,
        const char *path,
        bool secure)
{
  char *v9; // r7
  time_t v10; // r0
  unsigned int setcookies; // r3
  Cookie *v12; // r9
  bool v13; // zf
  size_t v14; // r6
  int v15; // r5
  char *v16; // r10
  char *v17; // r2
  int v18; // r4
  int v19; // t1
  size_t v20; // r3
  bool v21; // zf
  size_t running; // r4
  unsigned __int8 *v23; // r11
  size_t v24; // r0
  unsigned __int8 *v25; // r1
  size_t v26; // r8
  int v27; // r2
  int v28; // t1
  bool v29; // zf
  _BOOL4 v30; // r2
  int v31; // r3
  _BOOL4 v32; // r5
  bool v33; // zf
  int v34; // t1
  _BOOL4 v35; // r3
  _BOOL4 v36; // r3
  unsigned __int8 prefix; // r3
  char *v38; // r3
  CookieInfo *v39; // r2
  int lastct; // r3
  size_t v41; // r0
  Cookie *v42; // r5
  size_t v43; // r10
  int livecookie; // r7
  Cookie *v45; // r6
  char *v46; // r0
  char *v47; // r1
  const char *spath; // r8
  char *v49; // r11
  char *v50; // r0
  char *v51; // r1
  char *v52; // r0
  char *v53; // r1
  _BOOL4 v54; // r5
  char *v55; // r0
  int v56; // r3
  int v57; // r2
  char *v58; // r10
  int v59; // r10
  char *v60; // r0
  _BOOL4 v61; // r3
  int v62; // r1
  char *v64; // r0
  char *v65; // r0
  int v66; // r5
  int v67; // r5
  char *v68; // r0
  bool v69; // zf
  int v70; // r0
  char v71; // r3
  int v72; // r0
  int (__fastcall *v73)(char *); // r11
  const char *v74; // r0
  char *v75; // r5
  char *v76; // r0
  bool v77; // zf
  int v78; // r0
  int (__fastcall *v79)(const char *); // r1
  int v80; // r11
  int v81; // r0
  unsigned __int8 *v82; // r1
  int v83; // r4
  bool v84; // zf
  int v85; // r0
  bool v86; // zf
  _BYTE *v87; // r0
  const char *v88; // r5
  int is_ipnum; // r4
  int v90; // r0
  int v91; // r0
  int v92; // r0
  char *v93; // r0
  int v94; // r5
  char *v95; // r0
  bool v96; // zf
  int v97; // r0
  void (__fastcall *v98)(char *); // r3
  const char *v99; // r0
  const char *name; // r5
  bool v101; // zf
  int v102; // r0
  __int64 v103; // r2
  bool v104; // cf
  bool v105; // zf
  void *v106; // r0
  int v107; // r0
  Cookie *v108; // r0
  Cookie *v109; // r1
  Cookie *value; // r2
  Cookie *v111; // r3
  void (__fastcall *v112)(Cookie *); // r8
  Cookie *v113; // r1
  Cookie *expires; // r2
  Cookie *expires_high; // r3
  Cookie *creationtime; // r1
  Cookie *v117; // r2
  Cookie *v118; // r3
  curl_off_t v119; // r2
  CookieInfo *v120; // r12
  int v121; // r0
  char *v122; // r0
  size_t v123; // r2
  int v124; // r0
  char *v125; // r4
  char *v126; // r0
  char *v127; // r3
  char *v128; // r5
  int v129; // r3
  size_t v130; // r4
  char *v131; // r0
  char *v132; // r0
  int v133; // r0
  int v134; // [sp+0h] [bp-F8h] BYREF
  CookieInfo *ca; // [sp+18h] [bp-E0h]
  CookieInfo *cookies; // [sp+20h] [bp-D8h]
  Curl_easy *v137; // [sp+24h] [bp-D4h]
  time_t now; // [sp+28h] [bp-D0h]
  _BOOL4 v139; // [sp+2Ch] [bp-CCh]
  time_t v140; // [sp+30h] [bp-C8h]
  _BOOL4 badcookie; // [sp+34h] [bp-C4h]
  char *s; // [sp+38h] [bp-C0h]
  int v143; // [sp+3Ch] [bp-BCh]
  time_t v144; // [sp+40h] [bp-B8h]
  unsigned int v145; // [sp+44h] [bp-B4h]
  char *tok_buf; // [sp+48h] [bp-B0h] BYREF
  char date[128]; // [sp+4Ch] [bp-ACh] BYREF

  ca = (CookieInfo *)httpheader;
  badcookie = noexpire;
  v137 = data;
  cookies = c;
  now = (time_t)domain;
  v9 = (char *)lineptr;
  s = (char *)path;
  v139 = secure;
  v10 = time(0u);
  setcookies = data->req.setcookies;
  v140 = v10;
  if ( setcookies > 0x31 )
    return 0;
  v12 = (Cookie *)Curl_ccalloc(1, 48);
  if ( !v12 )
    return 0;
  if ( !ca )
  {
    tok_buf = 0;
    if ( !strncmp(lineptr, "#HttpOnly_", 0xAu) )
    {
      v9 = (char *)(lineptr + 0xA);
      v12->httponly = 1;
    }
    if ( *v9 == 35 )
    {
      Curl_cfree(v12);
      return 0;
    }
    v64 = strchr(v9, 13);
    if ( v64 )
      *v64 = 0;
    v65 = strchr(v9, 10);
    if ( v65 )
      *v65 = 0;
    v58 = strtok_r(v9, "\t", &tok_buf);
    if ( !v58 )
      goto LABEL_113;
    v66 = 0;
    now = (time_t)"__Host-";
    while ( 1 )
    {
      switch ( v66 )
      {
        case 0:
          if ( *v58 == 46 )
            ++v58;
          v67 = Curl_cstrdup(v58);
          v12->domain = (char *)v67;
          v68 = strtok_r(0u, "\t", &tok_buf);
          v69 = v67 == 0;
          if ( v67 )
            v69 = v68 == 0;
          v58 = v68;
          v54 = v67 == 0;
          if ( !v69 )
            goto LABEL_131;
          LOBYTE(v56) = !v54;
          goto LABEL_142;
        case 1:
LABEL_131:
          v70 = curl_strequal(v58, "TRUE");
          v71 = v70;
          if ( v70 )
            v71 = 1;
          v12->tailmatch = v71;
          v58 = strtok_r(0u, "\t", &tok_buf);
          if ( !v58 )
            goto LABEL_113;
          goto LABEL_134;
        case 2:
LABEL_134:
          v72 = strcmp("TRUE", v58);
          v73 = (int (__fastcall *)(char *))Curl_cstrdup;
          if ( v72 && strcmp("FALSE", v58) )
          {
            v74 = (const char *)v73(v58);
            v12->path = (char *)v74;
            if ( !v74 )
              goto LABEL_221;
            v75 = sanitize_cookie_path(v74);
            v12->spath = v75;
            v76 = strtok_r(0u, "\t", &tok_buf);
            v77 = v75 == 0;
            if ( v75 )
              v77 = v76 == 0;
            v58 = v76;
            v54 = v75 == 0;
            if ( v77 )
            {
              LOBYTE(v56) = !v54;
LABEL_142:
              if ( (v56 & 1) == 0 )
              {
LABEL_143:
                if ( !v54 )
                {
                  prefix = v12->prefix;
                  if ( (prefix & 1) != 0 )
                    goto LABEL_62;
                  goto LABEL_145;
                }
              }
LABEL_113:
              freecookie(v12);
              return 0;
            }
LABEL_100:
            v54 = 0;
LABEL_101:
            v12->secure = 0;
            if ( !curl_strequal(v58, "TRUE") )
              goto LABEL_102;
            goto LABEL_219;
          }
          ca = (CookieInfo *)"/";
          v78 = v73("/");
          v79 = (int (__fastcall *)(const char *))Curl_cstrdup;
          v80 = v78;
          v12->path = (char *)v78;
          v81 = v79("/");
          v12->spath = (char *)v81;
          if ( v81 )
          {
            v54 = v80 == 0;
            goto LABEL_101;
          }
          v12->secure = 0;
          if ( !curl_strequal(v58, "TRUE") )
          {
            strtok_r(0u, "\t", &tok_buf);
            LOBYTE(v56) = 0;
            v54 = 1;
            goto LABEL_142;
          }
          v54 = 1;
LABEL_219:
          if ( !v139 && !cookies->running )
          {
LABEL_221:
            strtok_r(0u, "\t", &tok_buf);
            goto LABEL_113;
          }
          v12->secure = 1;
LABEL_102:
          v55 = strtok_r(0u, "\t", &tok_buf);
          LOBYTE(v56) = !v54;
          if ( v55 )
            v57 = v56 & 1;
          else
            v57 = 0;
          v58 = v55;
          if ( !v57 )
            goto LABEL_142;
LABEL_106:
          v59 = curlx_strtoofft(v58, 0, 10, &v12->expires);
          v54 = v59;
          if ( v59 )
            v54 = 1;
          v60 = strtok_r(0u, "\t", &tok_buf);
          v61 = v59 == 0;
          if ( !v60 )
            v61 = 0;
          v58 = v60;
          if ( !v61 )
          {
            v56 = !v54;
            goto LABEL_142;
          }
LABEL_111:
          v62 = Curl_cstrdup(v58);
          v12->name = (char *)v62;
          if ( !v62 )
          {
            strtok_r(0u, "\t", &tok_buf);
            v12->value = (char *)Curl_cstrdup(&LC1);
            goto LABEL_113;
          }
          if ( curl_strnequal("__Secure-", v62, 9) )
          {
            v12->prefix |= 1u;
            v58 = strtok_r(0u, "\t", &tok_buf);
            if ( !v58 )
              goto LABEL_273;
          }
          else if ( curl_strnequal(now, v12->name, 7) )
          {
            v12->prefix |= 2u;
            v58 = strtok_r(0u, "\t", &tok_buf);
            if ( !v58 )
            {
LABEL_273:
              v121 = Curl_cstrdup(&LC1);
              v12->value = (char *)v121;
              if ( v121 )
                goto LABEL_61;
              goto LABEL_113;
            }
          }
          else
          {
            v58 = strtok_r(0u, "\t", &tok_buf);
            if ( !v58 )
              goto LABEL_273;
          }
LABEL_203:
          v94 = Curl_cstrdup(v58);
          v12->value = (char *)v94;
          v95 = strtok_r(0u, "\t", &tok_buf);
          v96 = v94 == 0;
          if ( v94 )
            v96 = v95 == 0;
          v54 = v94 == 0;
          if ( v96 )
            goto LABEL_143;
          v66 = 7;
LABEL_207:
          ++v66;
          v58 = strtok_r(0u, "\t", &tok_buf);
          if ( !v58 )
            goto LABEL_113;
          break;
        case 3:
          goto LABEL_100;
        case 4:
          goto LABEL_106;
        case 5:
          goto LABEL_111;
        case 6:
          goto LABEL_203;
        default:
          goto LABEL_207;
      }
    }
  }
  if ( strlen(lineptr) > (unsigned int)&loc_1388 )
  {
    running = 0;
    Curl_cfree(v12);
    return (Cookie *)running;
  }
  v145 = 0x7FFFFFFF - (v140 >> 0x1F);
  v143 = 0;
  v144 = v140 >> 31;
  while ( 1 )
  {
    v15 = (unsigned __int8)*v9;
    if ( !*v9 )
      break;
    v13 = v15 == 9;
    if ( v15 != 9 )
      v13 = v15 == 32;
    if ( v13 )
      goto LABEL_11;
    v14 = strcspn(v9, ";\t\r\n=");
    if ( v14 )
      goto LABEL_14;
LABEL_10:
    if ( v15 != 59 )
      goto LABEL_52;
LABEL_11:
    ++v9;
  }
  v14 = strcspn(v9, ";\t\r\n=");
  if ( !v14 )
    goto LABEL_52;
LABEL_14:
  v16 = &v9[v14];
  v17 = &v9[v14];
  while ( 1 )
  {
    v19 = (unsigned __int8)*--v17;
    v18 = v19;
    v20 = v14;
    v21 = v19 == 9;
    if ( v19 != 9 )
      v21 = v18 == 32;
    running = v21;
    --v14;
    if ( !v21 )
      break;
    if ( !v14 )
    {
      if ( *v16 == 61 )
      {
LABEL_24:
        v23 = (unsigned __int8 *)(v16 + 1);
        v24 = strcspn(v16 + 1, ";\r\n");
        v25 = (unsigned __int8 *)&v16[v24 + 1];
        v26 = v24;
        v16 += v24 + 1;
        while ( 1 )
        {
          if ( !v26 )
          {
            running = (size_t)ca;
            v30 = 0;
            goto LABEL_32;
          }
          v28 = *--v25;
          v27 = v28;
          v29 = v28 == 9;
          if ( v28 != 9 )
            v29 = v27 == 32;
          if ( !v29 )
            break;
          --v26;
        }
        v30 = 0;
        v82 = v23;
        while ( 1 )
        {
          v83 = *v82;
          v23 = v82;
          v84 = v83 == 9;
          if ( v83 != 9 )
            v84 = v83 == 32;
          running = v84;
          ++v82;
          if ( !v84 )
            break;
          --v26;
          v23 = v82;
          if ( !v26 )
            goto LABEL_32;
        }
        if ( !memchr(v23, 9, v26) )
        {
          running = (size_t)ca;
          v30 = v26 > 0xFFE;
          goto LABEL_32;
        }
        freecookie(v12);
        if ( (*(&v137->set.connect_only + 4) & 0x20) != 0 )
        {
          Curl_infof(v137, "cookie contains TAB, dropping");
          return (Cookie *)running;
        }
        return 0;
      }
      if ( !v12->name )
      {
LABEL_147:
        freecookie(v12);
        return 0;
      }
      goto LABEL_45;
    }
  }
  v14 = v20;
  if ( *v16 == 61 )
    goto LABEL_24;
  v30 = running;
  v23 = (unsigned __int8 *)running;
  v26 = running;
LABEL_32:
  if ( v14 > 0xFFE )
    v31 = v30 | 1;
  else
    v31 = v30;
  if ( v31 || v26 + v14 > 0x1000 )
  {
    freecookie(v12);
    if ( (*(&v137->set.connect_only + 4) & 0x20) != 0 )
      Curl_infof(v137, "oversized cookie dropped, name/val %zu + %zu bytes", v14, v26);
    return 0;
  }
  v32 = v15 == 0x5F;
  if ( v14 <= 6 )
    v32 = 0;
  if ( v32 && v9[1] == 95 )
  {
    if ( curl_strnequal("__Secure-", v9, 9) )
    {
      v12->prefix |= 1u;
    }
    else if ( curl_strnequal("__Host-", v9, 7) )
    {
      v12->prefix |= 2u;
    }
  }
  if ( !v12->name )
  {
    if ( !running )
      goto LABEL_147;
    Curl_cfree(0);
    v97 = Curl_strndup(v9, v14);
    v98 = (void (__fastcall *)(char *))Curl_cfree;
    v12->name = (char *)v97;
    v98(v12->value);
    v99 = (const char *)Curl_strndup(v23, v26);
    name = v12->name;
    v101 = name == 0;
    if ( name )
      v101 = v99 == 0;
    v12->value = (char *)v99;
    if ( v101 )
      goto LABEL_147;
    if ( v99[strcspn(v99, badoctets_0)] || name[strcspn(name, badoctets_0)] )
    {
      if ( (*(&v137->set.connect_only + 4) & 0x20) != 0 )
        Curl_infof(v137, "invalid octets in name/value, cookie dropped");
      goto LABEL_147;
    }
    goto LABEL_45;
  }
  if ( v26 )
  {
    if ( v14 == 4 )
      goto LABEL_192;
  }
  else
  {
    if ( v14 == 6 )
    {
      if ( curl_strnequal("secure", v9, 6) )
      {
        if ( !v139 && cookies->running )
          goto LABEL_147;
        v9 = v16;
        v12->secure = 1;
        goto LABEL_46;
      }
      if ( !running )
        goto LABEL_45;
LABEL_163:
      v85 = curl_strnequal("domain", v9, 6);
      v86 = v26 == 0;
      if ( v26 )
        v86 = v85 == 0;
      if ( v86 )
        goto LABEL_45;
      if ( *v23 == 46 )
      {
        --v26;
        ++v23;
      }
      if ( v26 != 9 || !curl_strnequal(v23, "localhost", 9) )
      {
        v87 = memchr(v23, 46, v26);
        if ( !v87 )
        {
          now = (time_t)":";
          goto LABEL_174;
        }
        if ( v26 - (v87 - v23) <= 1 )
        {
          now = (time_t)":";
          goto LABEL_174;
        }
      }
      if ( !now )
      {
        is_ipnum = Curl_host_is_ipnum(v23);
        Curl_cfree(v12->domain);
        v90 = Curl_strndup(v23, v26);
        v12->domain = (char *)v90;
        if ( !v90 )
          goto LABEL_147;
        if ( is_ipnum )
          goto LABEL_45;
        goto LABEL_187;
      }
LABEL_174:
      v88 = (const char *)now;
      if ( Curl_host_is_ipnum(now) )
      {
        if ( !strncmp((const char *)v23, v88, v26) && strlen(v88) == v26 )
        {
          Curl_cfree(v12->domain);
          v124 = Curl_strndup(v23, v26);
          v12->domain = (char *)v124;
          if ( !v124 )
            goto LABEL_147;
          goto LABEL_45;
        }
      }
      else if ( cookie_tailmatch((const char *)v23, v26, (const char *)now) )
      {
        Curl_cfree(v12->domain);
        v91 = Curl_strndup(v23, v26);
        v12->domain = (char *)v91;
        if ( !v91 )
          goto LABEL_147;
LABEL_187:
        v9 = v16;
        v12->tailmatch = 1;
        goto LABEL_46;
      }
      if ( (*(&v137->set.connect_only + 4) & 0x20) != 0 )
      {
        v143 = 1;
        v9 = v16;
        Curl_infof(v137, "skipped cookie with bad tailmatch domain: %s", (const char *)v23);
      }
      else
      {
        v9 = v16;
        v143 = 1;
      }
      goto LABEL_46;
    }
    if ( v14 == 8 )
    {
      if ( !curl_strnequal("httponly", v9, 8) )
        goto LABEL_45;
      v9 = v16;
      v12->httponly = 1;
      goto LABEL_46;
    }
    if ( !running )
      goto LABEL_45;
    if ( v14 == 4 )
    {
LABEL_192:
      if ( curl_strnequal("path", v9, v14) )
      {
        Curl_cfree(v12->path);
        v92 = Curl_strndup(v23, v26);
        v12->path = (char *)v92;
        if ( !v92 )
          goto LABEL_147;
        Curl_cfree(v12->spath);
        v93 = sanitize_cookie_path(v12->path);
        v12->spath = v93;
        if ( !v93 )
          goto LABEL_147;
      }
      goto LABEL_45;
    }
  }
  if ( v14 == 6 )
    goto LABEL_163;
  if ( v14 != 7 || curl_strnequal("version", v9, 7) )
    goto LABEL_45;
  if ( !curl_strnequal("max-age", v9, 7) )
  {
    if ( curl_strnequal("expires", v9, 7) )
    {
      v105 = v26 == 127;
      if ( v26 <= 0x7F )
        v105 = v12->expires == 0;
      if ( v105 )
      {
        v106 = memcpy(date, v23, v26);
        *((_BYTE *)&v134 + v26 + 0x4C) = 0;
        v107 = Curl_getdate_capped(v106);
        if ( v107 )
        {
          if ( v107 >> 31 == -1 )
            v12->expires = 0LL;
          else
            v12->expires = v107;
        }
        else
        {
          v12->expires = 1LL;
        }
      }
    }
LABEL_45:
    v9 = v16;
    goto LABEL_46;
  }
  if ( *v23 == 34 )
    ++v23;
  v102 = curlx_strtoofft(v23, 0, 10, &v12->expires);
  if ( v102 == 1 )
    goto LABEL_290;
  if ( v102 == 2 )
    goto LABEL_281;
  if ( v102 )
    goto LABEL_45;
  HIDWORD(v103) = v12->expires;
  LODWORD(v103) = HIDWORD(v12->expires);
  if ( !v103 )
  {
LABEL_281:
    v9 = v16;
    v12->expires = 1LL;
    goto LABEL_46;
  }
  if ( __SPAIR64__(v145, ~v140) < __SPAIR64__(v103, HIDWORD(v103)) )
  {
LABEL_290:
    v9 = v16;
    v12->expires = 0x7FFFFFFFFFFFFFFFLL;
    goto LABEL_46;
  }
  v9 = v16;
  v104 = __CFADD__(HIDWORD(v103), v140);
  LODWORD(v12->expires) = HIDWORD(v103) + v140;
  HIDWORD(v12->expires) = v144 + v104 + (_DWORD)v103;
LABEL_46:
  v15 = (unsigned __int8)*v16;
  if ( *v16 )
  {
    do
    {
      v33 = v15 == 9;
      if ( v15 != 9 )
        v33 = v15 == 32;
      if ( !v33 )
        goto LABEL_10;
      v34 = (unsigned __int8)*++v9;
      v15 = v34;
    }
    while ( v34 );
  }
LABEL_52:
  if ( v143 )
    goto LABEL_147;
  v35 = v12->domain == 0;
  if ( !now )
    v35 = 0;
  if ( v35 )
  {
    v133 = Curl_cstrdup(now);
    v12->domain = (char *)v133;
    if ( !v133 )
      goto LABEL_147;
  }
  v36 = v12->path == 0;
  if ( !s )
    v36 = 0;
  if ( v36 )
  {
    v125 = s;
    v126 = strchr(s, 63);
    v127 = v126 ? (char *)Curl_memrchr(s, 47, v126 - s) : strrchr(v125, 47);
    if ( v127 )
    {
      v128 = s;
      v129 = v127 - s;
      v130 = v129 + 1;
      v131 = (char *)Curl_cmalloc(v129 + 2);
      v12->path = v131;
      if ( !v131 )
        goto LABEL_147;
      memcpy(v131, v128, v130);
      v12->path[v130] = 0;
      v132 = sanitize_cookie_path(v12->path);
      v12->spath = v132;
      if ( !v132 )
        goto LABEL_147;
    }
  }
  if ( !v12->name )
    goto LABEL_147;
  ++v137->req.setcookies;
LABEL_61:
  prefix = v12->prefix;
  if ( (prefix & 1) != 0 )
  {
LABEL_62:
    running = v12->secure;
    if ( v12->secure )
    {
      if ( (prefix & 2) != 0 )
        goto LABEL_64;
      goto LABEL_68;
    }
    goto LABEL_297;
  }
LABEL_145:
  if ( (prefix & 2) != 0 )
  {
    if ( !v12->secure )
      goto LABEL_147;
LABEL_64:
    v38 = v12->path;
    if ( !v38 || *v38 != 47 || v38[1] || v12->tailmatch )
      goto LABEL_147;
  }
LABEL_68:
  running = cookies->running;
  if ( !cookies->running && cookies->newsession && !v12->expires )
  {
LABEL_297:
    freecookie(v12);
    return (Cookie *)running;
  }
  v39 = cookies;
  v13 = !badcookie;
  lastct = cookies->lastct;
  v12->livecookie = running;
  v39->lastct = ++lastct;
  v12->creationtime = lastct;
  if ( v13 )
    remove_expired(v39);
  v41 = cookiehash(v12->domain);
  v42 = cookies->cookies[v41];
  v43 = v41;
  if ( !v42 )
  {
    if ( cookies->running )
    {
      running = (size_t)v12;
      if ( (*(&v137->set.connect_only + 4) & 0x20) != 0 )
      {
LABEL_284:
        Curl_infof(
          v137,
          "%s cookie %s=\"%s\" for domain %s, path %s, expire %lld",
          "Added",
          *(const char **)(running + 4),
          *(const char **)(running + 8),
          *(const char **)(running + 20),
          *(const char **)(running + 12),
          *(_QWORD *)(running + 0x18));
        if ( v42 )
        {
LABEL_256:
          v42->next = (Cookie *)running;
LABEL_257:
          ++cookies->numcookies;
          goto LABEL_258;
        }
      }
    }
    else
    {
      running = (size_t)v12;
    }
    cookies->cookies[v43] = (Cookie *)running;
    goto LABEL_257;
  }
  livecookie = 0;
  running = 0;
  v45 = 0;
  while ( 1 )
  {
    if ( !curl_strequal(v42->name, v12->name) )
      goto LABEL_85;
    v46 = v42->domain;
    v47 = v12->domain;
    if ( v46 )
    {
      if ( !v47 || !curl_strequal(v46, v47) )
        goto LABEL_85;
    }
    else if ( v47 )
    {
      goto LABEL_85;
    }
    spath = v42->spath;
    if ( spath )
    {
      v49 = v12->spath;
      if ( v49 )
      {
        if ( v42->secure && !v139 && !v12->secure )
        {
          v122 = strchr(spath + 1, 47);
          v123 = v122 ? v122 - spath : strlen(spath);
          if ( curl_strnequal(spath, v49, v123) )
          {
            if ( (*(&v137->set.connect_only + 4) & 0x20) != 0 )
              Curl_infof(
                v137,
                "cookie '%s' for domain '%s' dropped, would overlay an existing cookie",
                v12->name,
                v12->domain);
            goto LABEL_147;
          }
        }
      }
    }
LABEL_85:
    if ( v45 || !curl_strequal(v42->name, v12->name) )
      goto LABEL_75;
    v50 = v42->domain;
    v51 = v12->domain;
    if ( v50 )
    {
      if ( !v51 || !curl_strequal(v50, v51) || v42->tailmatch != v12->tailmatch )
      {
LABEL_91:
        if ( !livecookie )
          goto LABEL_75;
      }
    }
    else if ( v51 )
    {
      goto LABEL_91;
    }
    v52 = v42->spath;
    v53 = v12->spath;
    if ( v52 )
    {
      if ( !v53 )
      {
        v45 = 0;
        livecookie = 0;
        goto LABEL_75;
      }
      if ( !curl_strequal(v52, v53) )
        goto LABEL_262;
      v52 = v42->spath;
      v53 = v12->spath;
    }
    if ( (v52 == 0) != (v53 == 0) )
    {
LABEL_262:
      livecookie = 0;
      goto LABEL_75;
    }
    livecookie = v12->livecookie;
    if ( v12->livecookie )
    {
      running = (size_t)v42;
      v45 = v12;
    }
    else
    {
      if ( v42->livecookie )
        goto LABEL_147;
      running = (size_t)v42;
      v45 = v12;
      livecookie = 1;
    }
LABEL_75:
    if ( !v42->next )
      break;
    v42 = v42->next;
  }
  if ( v45 )
  {
    v45->next = *(Cookie **)running;
    v108 = *(Cookie **)(running + 4);
    v45->creationtime = *(_DWORD *)(running + 36);
    Curl_cfree(v108);
    Curl_cfree(*(_DWORD *)(running + 8));
    Curl_cfree(*(_DWORD *)(running + 20));
    Curl_cfree(*(_DWORD *)(running + 12));
    Curl_cfree(*(_DWORD *)(running + 16));
    v109 = (Cookie *)v45->name;
    value = (Cookie *)v45->value;
    v111 = (Cookie *)v45->path;
    v112 = (void (__fastcall *)(Cookie *))Curl_cfree;
    *(_DWORD *)running = v45->next;
    *(_DWORD *)(running + 4) = v109;
    *(_DWORD *)(running + 8) = value;
    *(_DWORD *)(running + 12) = v111;
    v113 = (Cookie *)v45->domain;
    expires = (Cookie *)v45->expires;
    expires_high = (Cookie *)HIDWORD(v45->expires);
    *(_DWORD *)(running + 16) = v45->spath;
    *(_DWORD *)(running + 20) = v113;
    *(_DWORD *)(running + 24) = expires;
    *(_DWORD *)(running + 28) = expires_high;
    creationtime = (Cookie *)v45->creationtime;
    v117 = *(Cookie **)&v45->prefix;
    v118 = (Cookie *)*((_DWORD *)&v45->prefix + 1);
    *(_DWORD *)(running + 32) = *(_DWORD *)&v45->tailmatch;
    *(_DWORD *)(running + 36) = creationtime;
    *(_DWORD *)(running + 40) = v117;
    *(_DWORD *)(running + 44) = v118;
    v112(v45);
  }
  else
  {
    running = (size_t)v12;
  }
  if ( !cookies->running || (*(&v137->set.connect_only + 4) & 0x20) == 0 )
  {
    if ( livecookie )
      goto LABEL_258;
    goto LABEL_256;
  }
  if ( !livecookie )
    goto LABEL_284;
  Curl_infof(
    v137,
    "%s cookie %s=\"%s\" for domain %s, path %s, expire %lld",
    "Replaced",
    *(const char **)(running + 4),
    *(const char **)(running + 8),
    *(const char **)(running + 20),
    *(const char **)(running + 12),
    *(_QWORD *)(running + 0x18));
LABEL_258:
  v119 = *(_QWORD *)(running + 0x18);
  if ( v119 )
  {
    v120 = cookies;
    if ( v119 < cookies->next_expiration )
    {
      LODWORD(cookies->next_expiration) = v119;
      HIDWORD(v120->next_expiration) = HIDWORD(v119);
    }
  }
  return (Cookie *)running;
}
