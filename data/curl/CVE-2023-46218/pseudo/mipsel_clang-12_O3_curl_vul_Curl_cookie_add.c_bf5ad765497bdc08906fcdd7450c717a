Cookie *__fastcall Curl_cookie_add(
        Curl_easy *data,
        CookieInfo *c,
        int httpheader,
        int noexpire,
        int a5,
        int a6,
        int a7,
        int a8,
        const char *lineptr,
        const char *domain,
        const char *path,
        int secure)
{
  Cookie *v16; // $s3
  time_t v17; // $v0
  int v18; // $v0
  int v19; // $s5
  char *k; // $s5
  int v21; // $s1
  char *i; // $s1
  int v23; // $s2
  size_t v24; // $v0
  size_t v25; // $s4
  char *v26; // $v1
  unsigned int v27; // $s6
  int v28; // $v0
  size_t v29; // $s7
  char *v30; // $fp
  size_t v31; // $v0
  int v32; // $v1
  char *v33; // $a0
  _DWORD *v34; // $s1
  int j; // $v1
  int v36; // $a2
  char *v37; // $s7
  size_t v38; // $s4
  int v39; // $v0
  size_t v40; // $s4
  const char *v41; // $v0
  char *v42; // $s2
  size_t v43; // $s4
  char *v44; // $v1
  int v45; // $v0
  int v46; // $v0
  const char *v47; // $s2
  int v48; // $s5
  const char *v49; // $s4
  int v50; // $v0
  int v51; // $v0
  size_t v52; // $s2
  _BYTE *v53; // $v0
  const char *v54; // $s5
  const char *v55; // $a0
  int is_ipnum; // $v0
  int v57; // $s4
  size_t v58; // $v0
  const char *v59; // $v1
  size_t v60; // $s5
  size_t v61; // $s4
  size_t v62; // $v0
  int v63; // $v0
  int v64; // $v0
  int v65; // $v0
  int v66; // $v0
  int v67; // $v1
  _BOOL4 v68; // $v0
  int v69; // $v0
  unsigned int v70; // $v1
  _BOOL4 v71; // $a1
  int v72; // $v0
  int v73; // $v0
  int v74; // $s1
  char *v75; // $v0
  int v76; // $v0
  char *v77; // $v0
  char *v78; // $v0
  int v79; // $at
  int v80; // $s0
  __int64 v81; // $s2
  int next_expiration_high; // $v0
  _BOOL4 v83; // $a0
  unsigned int next_expiration; // $v1
  Cookie *v85; // $s1
  Cookie **v86; // $s0
  Cookie *next; // $v0
  Cookie **v88; // $s2
  Cookie *v89; // $s7
  char v90; // $s6
  Cookie *v91; // $s3
  int v92; // $a1
  const char *spath; // $s4
  int v94; // $s5
  char *v95; // $v0
  size_t v96; // $a2
  int v97; // $a1
  int v98; // $at
  bool v99; // dc
  int v100; // $at
  int v101; // $a1
  const char *v102; // $a0
  Cookie *v103; // $at
  Cookie *v104; // $v0
  Cookie *v105; // $v1
  char *v106; // $a1
  char *v107; // $a2
  char *v108; // $a3
  Cookie *v109; // $t0
  Cookie *v110; // $t1
  Cookie *v111; // $s2
  Cookie **v112; // $s7
  Cookie *v113; // $fp
  Cookie **p_next; // $s1
  __int64 v115; // $v0
  Cookie *v116; // $s4
  _BOOL4 v117; // $a2
  int v118; // $at
  _BOOL4 v119; // $a1
  const char *v120; // $a2
  __int64 v121; // $v0
  int v122; // $at
  _BOOL4 v123; // $a1
  int v124; // $s0
  void *v125; // $v0
  const char *v126; // $v0
  char *v127; // $s2
  size_t v128; // $s4
  char *v129; // $v1
  int v130; // $v0
  int v132; // [sp+30h] [-C0h]
  unsigned int *v133; // [sp+3Ch] [-B4h]
  char v134; // [sp+40h] [-B0h]
  Curl_easy *v136; // [sp+48h] [-A8h]
  int v137; // [sp+4Ch] [-A4h]
  int v138; // [sp+50h] [-A0h]
  int v139; // [sp+58h] [-98h]
  int v140; // [sp+60h] [-90h]
  size_t v141; // [sp+60h] [-90h]
  int v142; // [sp+64h] [-8Ch]
  CookieInfo *v143; // [sp+68h] [-88h]
  char *v144[32]; // [sp+70h] [-80h] BYREF

  v16 = 0;
  v17 = time(0u);
  if ( data->req.setcookies >= 0x32u )
    return v16;
  v143 = c;
  v19 = v17;
  v18 = Curl_ccalloc(1, 48);
  if ( !v18 )
    return v16;
  v138 = v19;
  k = (char *)lineptr;
  v21 = v18;
  v137 = noexpire;
  v142 = v18;
  if ( !httpheader )
  {
    v144[0] = 0;
    if ( !strncmp(lineptr, "#HttpOnly_", 0xAu) )
    {
      k = (char *)(lineptr + 10);
      *(_BYTE *)(v21 + 35) = 1;
      if ( lineptr[10] == 35 )
        goto LABEL_5;
    }
    else if ( *lineptr == 35 )
    {
      goto LABEL_5;
    }
    v77 = strchr(k, 13);
    if ( v77 )
      *v77 = 0;
    v78 = strchr(k, 10);
    if ( v78 )
      *v78 = 0;
    if ( strtok_r(k, "\t", v144) )
      JUMPOUT(0x1458);
LABEL_237:
    Curl_cfree(*(_DWORD *)(v21 + 20));
    Curl_cfree(*(_DWORD *)(v21 + 12));
    Curl_cfree(*(_DWORD *)(v21 + 16));
    Curl_cfree(*(_DWORD *)(v21 + 4));
    Curl_cfree(*(_DWORD *)(v21 + 8));
    Curl_cfree(v21);
    return v16;
  }
  if ( strlen(lineptr) >= 0x1389 )
  {
LABEL_5:
    Curl_cfree(v21);
    return v16;
  }
  v136 = data;
  v132 = 0x7FFFFFFF - (v138 >> 0x1F);
  v133 = (unsigned int *)(v21 + 0x18);
  v134 = 0;
  do
  {
    for ( i = k + 1; ; ++i )
    {
      v23 = (unsigned __int8)*k;
      if ( v23 != 32 && v23 != 9 )
        break;
      ++k;
    }
    v24 = strcspn(k, ";\t\r\n=");
    if ( !v24 )
    {
      v37 = k;
      goto LABEL_150;
    }
    v25 = v24;
    v26 = &k[v24];
    v27 = v24;
    while ( 1 )
    {
      v28 = (unsigned __int8)k[v27 - 1];
      if ( v28 != 32 && v28 != 9 )
        break;
      if ( !--v27 )
      {
        v27 = 0;
        break;
      }
    }
    v29 = 0;
    v30 = 0;
    v140 = (int)v26;
    v139 = (unsigned __int8)*v26;
    if ( v139 == 61 )
    {
      v31 = strcspn(&k[v25 + 1], ";\r\n");
      v141 = v25 + v31;
      if ( v31 )
      {
        v30 = &i[v25 + v31];
        while ( 1 )
        {
          v32 = (unsigned __int8)*(v30 - 1);
          if ( v32 != 32 && v32 != 9 )
            break;
          --v31;
          --v30;
          if ( !v31 )
          {
            v34 = (_DWORD *)v142;
            v30 = &k[v25 + 1];
            v29 = 0;
            goto LABEL_36;
          }
        }
        v33 = &i[v25];
        v34 = (_DWORD *)v142;
        for ( j = 0; j != v31; ++j )
        {
          v36 = (unsigned __int8)v33[j];
          if ( v36 != 32 && v36 != 9 )
          {
            v29 = v31 - j;
            v30 = &v33[j];
            goto LABEL_36;
          }
        }
        v29 = 0;
      }
      else
      {
        v34 = (_DWORD *)v142;
        v30 = &k[v25 + 1];
        v29 = 0;
      }
LABEL_36:
      if ( memchr(v30, 9, v29) )
      {
        Curl_cfree(v34[5]);
        Curl_cfree(v34[3]);
        Curl_cfree(v34[4]);
        Curl_cfree(v34[1]);
        Curl_cfree(v34[2]);
        Curl_cfree(v34);
        v16 = 0;
        if ( (*((_BYTE *)&data->set + 1338) & 0x10) != 0 )
          Curl_infof(data, "cookie contains TAB, dropping");
        return v16;
      }
      v140 = (int)&k[v141 + 1];
    }
    v38 = v29;
    if ( v27 >= 0xFFF || v29 >= 0xFFF || v29 + v27 >= 0x1001 )
    {
      Curl_cfree(*(_DWORD *)(v142 + 20));
      Curl_cfree(*(_DWORD *)(v142 + 12));
      Curl_cfree(*(_DWORD *)(v142 + 16));
      Curl_cfree(*(_DWORD *)(v142 + 4));
      Curl_cfree(*(_DWORD *)(v142 + 8));
      Curl_cfree(v142);
      v16 = 0;
      if ( (*((_BYTE *)&data->set + 1338) & 0x10) != 0 )
        ((void (__fastcall *)(Curl_easy *, const char *, unsigned int, size_t))Curl_infof)(
          data,
          "oversized cookie dropped, name/val %zu + %zu bytes",
          v27,
          v29);
      return v16;
    }
    if ( v23 == 95 && v27 >= 7 && k[1] == 95 )
    {
      if ( curl_strnequal("__Secure-", k, 9) )
      {
        *(_BYTE *)(v142 + 40) |= 1u;
      }
      else if ( curl_strnequal("__Host-", k, 7) )
      {
        *(_BYTE *)(v142 + 40) |= 2u;
      }
    }
    if ( *(_DWORD *)(v142 + 4) )
    {
      if ( !v29 )
      {
        if ( v27 == 8 )
        {
          if ( curl_strnequal("httponly", k, 8) )
          {
            v37 = (char *)v140;
            *(_BYTE *)(v142 + 35) = 1;
            goto LABEL_150;
          }
        }
        else if ( v27 == 6 && curl_strnequal("secure", k, 6) )
        {
          v37 = (char *)v140;
          if ( !secure && v143->running )
            goto LABEL_302;
          *(_BYTE *)(v142 + 33) = 1;
          goto LABEL_150;
        }
        if ( v139 != 61 )
        {
          v37 = (char *)v140;
          goto LABEL_150;
        }
      }
      if ( v27 == 7 )
      {
        v37 = (char *)v140;
        if ( !curl_strnequal("version", k, 7) )
        {
          if ( curl_strnequal("max-age", k, 7) )
          {
            if ( *v30 == 0x22 )
              ++v30;
            v63 = ((int (__fastcall *)(char *, _DWORD, int, unsigned int *))curlx_strtoofft)(v30, 0, 10, v133);
            if ( v63 )
            {
              if ( v63 == 2 )
              {
                v133[1] = 0;
                *v133 = 1;
              }
              else if ( v63 == 1 )
              {
                *v133 = -1;
                v133[1] = 0x7FFFFFFF;
              }
            }
            else
            {
              v69 = v133[1];
              v70 = *v133;
              if ( *(_QWORD *)v133 )
              {
                v71 = v132 >= v69;
                if ( v132 == v69 )
                  v71 = ~v138 >= v70;
                if ( v71 )
                {
                  *v133 = v70 + v138;
                  v133[1] = v69 + (v138 >> 0x1F) + __CFADD__(v70, v138);
                }
                else
                {
                  *v133 = -1;
                  v133[1] = 0x7FFFFFFF;
                }
              }
              else
              {
                v133[1] = 0;
                *v133 = 1;
              }
            }
          }
          else if ( curl_strnequal("expires", k, 7) && v38 < 0x80 && !*(_QWORD *)v133 )
          {
            memcpy(v144, v30, v38);
            *((_BYTE *)v144 + v38) = 0;
            v65 = ((int (__fastcall *)(char **))Curl_getdate_capped)(v144);
            *(_QWORD *)v133 = v65;
            if ( v65 )
            {
              if ( v65 < 0 )
              {
                v133[1] = 0;
                *v133 = 0;
              }
            }
            else
            {
              v133[1] = 0;
              *v133 = 1;
            }
          }
        }
        goto LABEL_150;
      }
      if ( v27 == 6 )
      {
        v50 = curl_strnequal("domain", k, 6);
        if ( !v29 )
        {
          v37 = (char *)v140;
          goto LABEL_150;
        }
        v37 = (char *)v140;
        if ( !v50 )
          goto LABEL_150;
        v51 = (unsigned __int8)*v30;
        if ( v51 == 0x2E )
          ++v30;
        v52 = (__PAIR64__(v38, v51 ^ 0x2Eu) - 1) >> 32;
        if ( v52 == 9 && curl_strnequal(v30, "localhost", 9)
          || (v53 = memchr(v30, 46, v52)) != 0 && (unsigned int)(&v30[v52] - v53) >= 2 )
        {
          v54 = domain;
          v55 = domain;
          if ( !domain )
            v55 = v30;
          is_ipnum = Curl_host_is_ipnum(v55);
          v57 = is_ipnum;
          if ( domain )
          {
            if ( !is_ipnum )
              goto LABEL_97;
LABEL_118:
            domain = v54;
            if ( strncmp(v30, v54, v52) || (v57 = 1, v52 != strlen(v54)) )
            {
LABEL_120:
              v134 = 1;
              if ( (*((_BYTE *)&data->set + 1338) & 0x10) != 0 )
                ((void (__fastcall *)(Curl_easy *, const char *, char *))Curl_infof)(
                  data,
                  "skipped cookie with bad tailmatch domain: %s",
                  v30);
              goto LABEL_150;
            }
          }
          else
          {
            domain = 0;
          }
        }
        else
        {
          v54 = ":";
          if ( Curl_host_is_ipnum(v54) )
            goto LABEL_118;
LABEL_97:
          v58 = strlen(v54);
          v59 = v54;
          domain = v54;
          if ( v58 < v52 )
            goto LABEL_120;
          v60 = v58;
          v61 = (size_t)&v59[v58 - v52];
          if ( !curl_strnequal(v30, v61, v52) )
            goto LABEL_120;
          v62 = v61;
          v57 = 0;
          if ( v60 != v52 && *(_BYTE *)(v62 - 1) != 46 )
            goto LABEL_120;
        }
        Curl_cfree(*(_DWORD *)(v142 + 20));
        v66 = Curl_memdup(v30, v52 + 1);
        *(_DWORD *)(v142 + 20) = v66;
        if ( !v66 )
          goto LABEL_302;
        *(_BYTE *)(v66 + v52) = 0;
        v67 = *(_DWORD *)(v142 + 20);
        v68 = v67 == 0;
        if ( v57 | v68 )
        {
          if ( !v67 )
            goto LABEL_302;
          v134 |= v68;
        }
        else
        {
          *(_BYTE *)(v142 + 32) = 1;
        }
        goto LABEL_150;
      }
      if ( v27 != 4 )
      {
        v37 = (char *)v140;
        goto LABEL_150;
      }
      if ( !curl_strnequal("path", k, 4) )
      {
        v37 = (char *)v140;
        goto LABEL_150;
      }
      Curl_cfree(*(_DWORD *)(v142 + 12));
      v40 = v29;
      v39 = Curl_memdup(v30, v29 + 1);
      v37 = (char *)v140;
      *(_DWORD *)(v142 + 12) = v39;
      if ( !v39 )
        goto LABEL_302;
      *(_BYTE *)(v39 + v40) = 0;
      if ( !*(_DWORD *)(v142 + 12) )
        goto LABEL_302;
      Curl_cfree(*(_DWORD *)(v142 + 16));
      v41 = (const char *)Curl_cstrdup(*(_DWORD *)(v142 + 12));
      if ( !v41 )
        goto LABEL_294;
      v42 = (char *)v41;
      v43 = strlen(v41);
      if ( *v42 == 34 )
        memmove(v42, v42 + 1, v43--);
      if ( v43 )
      {
        v44 = &v42[v43 - 1];
        if ( *v44 == 34 )
        {
          --v43;
          *v44 = 0;
        }
        if ( *v42 == 47 )
        {
          if ( v43 )
          {
            if ( v42[v43 - 1] == 47 )
              v42[v43 - 1] = 0;
            *(_DWORD *)(v142 + 16) = v42;
          }
          else
          {
            *(_DWORD *)(v142 + 16) = v42;
          }
          goto LABEL_150;
        }
      }
      else if ( *v42 == 47 )
      {
        *(_DWORD *)(v142 + 16) = v42;
        goto LABEL_150;
      }
      Curl_cfree(v42);
      v64 = Curl_memdup("/", 2);
      if ( !v64 )
      {
LABEL_294:
        *(_DWORD *)(v142 + 16) = 0;
        goto LABEL_302;
      }
      *(_BYTE *)(v64 + 1) = 0;
      *(_DWORD *)(v142 + 16) = v64;
    }
    else
    {
      v37 = (char *)v140;
      if ( v139 != 61 )
        goto LABEL_302;
      Curl_cfree(0);
      v45 = Curl_memdup(k, v27 + 1);
      *(_DWORD *)(v142 + 4) = v45;
      if ( v45 )
        *(_BYTE *)(v45 + v27) = 0;
      Curl_cfree(*(_DWORD *)(v142 + 8));
      v46 = Curl_memdup(v30, v38 + 1);
      *(_DWORD *)(v142 + 8) = v46;
      if ( v46 )
        *(_BYTE *)(v46 + v38) = 0;
      v47 = *(const char **)(v142 + 4);
      if ( !v47 )
        goto LABEL_302;
      v48 = *(_DWORD *)(v142 + 8);
      if ( !v48 )
        goto LABEL_302;
      v49 = (const char *)&invalid_octets_badoctets;
      if ( *(_BYTE *)(v48 + strcspn(*(const char **)(v142 + 8), v49)) || v47[strcspn(v47, v49)] )
      {
        if ( (*((_BYTE *)&data->set + 1338) & 0x10) != 0 )
          Curl_infof(data, "invalid octets in name/value, cookie dropped");
        goto LABEL_302;
      }
    }
LABEL_150:
    for ( k = v37 + 1; ; ++k )
    {
      v72 = (unsigned __int8)*(k - 1);
      if ( v72 != 32 && v72 != 9 )
        break;
    }
  }
  while ( v72 == 59 );
  if ( (v134 & 1) != 0 )
    goto LABEL_302;
  if ( domain )
  {
    if ( !*(_DWORD *)(v142 + 20) )
    {
      v73 = Curl_cstrdup(domain);
      *(_DWORD *)(v142 + 20) = v73;
      if ( !v73 )
        goto LABEL_302;
    }
  }
  v74 = v142;
  if ( !path || *(_DWORD *)(v142 + 12) )
    goto LABEL_299;
  v75 = strchr(path, 63);
  v76 = v75 ? ((int (__fastcall *)(const char *, int, int))Curl_memrchr)(path, 47, v75 - path) : (int)strrchr(path, 47);
  if ( !v76 )
    goto LABEL_299;
  v124 = v76 - (_DWORD)path;
  v125 = (void *)Curl_cmalloc(v76 - (_DWORD)path + 2);
  *(_DWORD *)(v142 + 12) = v125;
  if ( !v125 )
  {
LABEL_302:
    Curl_cfree(*(_DWORD *)(v142 + 20));
    Curl_cfree(*(_DWORD *)(v142 + 12));
    Curl_cfree(*(_DWORD *)(v142 + 16));
    Curl_cfree(*(_DWORD *)(v142 + 4));
    Curl_cfree(*(_DWORD *)(v142 + 8));
    Curl_cfree(v142);
    return 0;
  }
  memcpy(v125, path, v124 + 1);
  v74 = v142;
  *(_BYTE *)(*(_DWORD *)(v142 + 12) + v124 + 1) = 0;
  v126 = (const char *)Curl_cstrdup(*(_DWORD *)(v142 + 12));
  if ( !v126 )
  {
LABEL_301:
    *(_DWORD *)(v142 + 16) = 0;
    goto LABEL_302;
  }
  v127 = (char *)v126;
  v128 = strlen(v126);
  if ( *v127 == 34 )
    memmove(v127, v127 + 1, v128--);
  if ( !v128 )
  {
    if ( *v127 == 47 )
      goto LABEL_298;
LABEL_296:
    Curl_cfree(v127);
    v130 = Curl_memdup("/", 2);
    if ( v130 )
    {
      v127 = (char *)v130;
      *(_BYTE *)(v130 + 1) = 0;
      goto LABEL_298;
    }
    goto LABEL_301;
  }
  v129 = &v127[v128 - 1];
  if ( *v129 == 34 )
  {
    --v128;
    *v129 = 0;
  }
  if ( *v127 != 47 )
    goto LABEL_296;
  if ( v128 && v127[v128 - 1] == 47 )
    v127[v128 - 1] = 0;
LABEL_298:
  *(_DWORD *)(v142 + 16) = v127;
LABEL_299:
  if ( !*(_DWORD *)(v74 + 4) )
    goto LABEL_302;
  v21 = v142;
  v16 = 0;
  ++v136->req.setcookies;
  if ( (*(_BYTE *)(v142 + 40) & 1) != 0 && !*(_BYTE *)(v142 + 33) )
    goto LABEL_237;
  if ( (*(_BYTE *)(v142 + 40) & 2) != 0
    && (!*(_BYTE *)(v142 + 33) || (v102 = *(const char **)(v142 + 12)) == 0
                               || strcmp(v102, "/")
                               || *(_BYTE *)(v142 + 32))
    || !v143->running && v143->newsession && !*(_QWORD *)(v142 + 24) )
  {
    Curl_cfree(*(_DWORD *)(v142 + 20));
    Curl_cfree(*(_DWORD *)(v142 + 12));
    Curl_cfree(*(_DWORD *)(v142 + 16));
    Curl_cfree(*(_DWORD *)(v142 + 4));
    Curl_cfree(*(_DWORD *)(v142 + 8));
    Curl_cfree(v142);
    return v16;
  }
  *(_BYTE *)(v142 + 34) = v143->running;
  v79 = v143->lastct + 1;
  v143->lastct = v79;
  *(_DWORD *)(v142 + 36) = v79;
  if ( !v137 )
  {
    v80 = 0;
    v81 = time(0u);
    next_expiration_high = HIDWORD(v143->next_expiration);
    v83 = SHIDWORD(v81) >= next_expiration_high;
    next_expiration = v143->next_expiration;
    if ( next_expiration_high == HIDWORD(v81) )
      v83 = (unsigned int)v81 >= next_expiration;
    if ( v83 || !(~next_expiration | next_expiration_high ^ 0x7FFFFFFF) )
    {
      LODWORD(v143->next_expiration) = -1;
      HIDWORD(v143->next_expiration) = 0x7FFFFFFF;
      do
      {
        v112 = &v143->cookies[v80];
        v113 = *v112;
        if ( *v112 )
        {
          p_next = 0;
          do
          {
            LODWORD(v115) = HIDWORD(v113->expires);
            HIDWORD(v115) = v113->expires;
            v116 = v113;
            v113 = v113->next;
            if ( !v115 )
              goto LABEL_260;
            v117 = (int)v115 >= SHIDWORD(v81);
            if ( (unsigned int)v115 == HIDWORD(v81) )
              v117 = HIDWORD(v115) >= (unsigned int)v81;
            if ( v117 )
            {
LABEL_260:
              if ( v115 )
              {
                v118 = HIDWORD(v143->next_expiration);
                v119 = (int)v115 >= v118;
                if ( (unsigned int)v115 == v118 )
                  v119 = HIDWORD(v115) >= LODWORD(v143->next_expiration);
                p_next = &v116->next;
                if ( !v119 )
                {
                  LODWORD(v143->next_expiration) = HIDWORD(v115);
                  HIDWORD(v143->next_expiration) = v115;
                }
              }
              else
              {
                p_next = &v116->next;
              }
            }
            else
            {
              if ( p_next )
                *p_next = v113;
              else
                *v112 = v113;
              --v143->numcookies;
              Curl_cfree(v116->domain);
              Curl_cfree(v116->path);
              Curl_cfree(v116->spath);
              Curl_cfree(v116->name);
              Curl_cfree(v116->value);
              Curl_cfree(v116);
            }
          }
          while ( v113 );
        }
        ++v80;
      }
      while ( v80 != 63 );
    }
  }
  v85 = (Cookie *)v142;
  v86 = &v143->cookies[cookiehash(*(const char *const *)(v142 + 20))];
  next = *v86;
  if ( !*v86 )
  {
    v91 = 0;
    v90 = 0;
    goto LABEL_242;
  }
  v88 = 0;
  v89 = 0;
  v90 = 0;
  while ( 2 )
  {
    v91 = next;
    if ( ((int (__fastcall *)(char *, _DWORD))curl_strequal)(next->name, *(_DWORD *)(v142 + 4)) )
    {
      v92 = *(_DWORD *)(v142 + 20);
      if ( v91->domain )
      {
        if ( v92 && ((int (*)(void))curl_strequal)() )
        {
LABEL_189:
          spath = v91->spath;
          if ( spath )
          {
            v94 = *(_DWORD *)(v142 + 16);
            if ( v94 )
            {
              if ( v91->secure && !*(_BYTE *)(v142 + 33) && !secure )
              {
                v95 = strchr(spath + 1, 47);
                v96 = v95 ? v95 - spath : strlen(spath);
                if ( curl_strnequal(spath, v94, v96) )
                {
                  if ( v136 && (*((_BYTE *)&v136->set + 1338) & 0x10) != 0 )
                    ((void (__fastcall *)(Curl_easy *, const char *, _DWORD, _DWORD))Curl_infof)(
                      v136,
                      "cookie '%s' for domain '%s' dropped, would overlay an existing cookie",
                      *(_DWORD *)(v142 + 4),
                      *(_DWORD *)(v142 + 20));
                  goto LABEL_302;
                }
              }
            }
          }
        }
      }
      else if ( !v92 )
      {
        goto LABEL_189;
      }
    }
    if ( !v88 )
    {
      if ( !((int (__fastcall *)(char *, _DWORD))curl_strequal)(v91->name, *(_DWORD *)(v142 + 4)) )
      {
        v88 = 0;
        goto LABEL_184;
      }
      v97 = *(_DWORD *)(v142 + 20);
      if ( v91->domain )
      {
        if ( v97 && ((int (*)(void))curl_strequal)() )
        {
          v98 = v90 & 1 | (v91->tailmatch == *(unsigned __int8 *)(v142 + 32));
          v90 = 0;
          if ( !v98 )
          {
            v88 = 0;
            goto LABEL_184;
          }
        }
        else
        {
          v99 = (v90 & 1) != 0;
          v90 = 0;
          if ( !v99 )
          {
            v88 = 0;
            goto LABEL_184;
          }
        }
      }
      else
      {
        v100 = v90 & 1 | (v97 == 0);
        v90 = 0;
        if ( !v100 )
        {
          v88 = 0;
          goto LABEL_184;
        }
      }
      v101 = *(_DWORD *)(v142 + 16);
      if ( v91->spath )
      {
        if ( v101 )
        {
          if ( !((int (*)(void))curl_strequal)() )
          {
            v90 = 0;
            v88 = 0;
            goto LABEL_184;
          }
          v90 = 0;
          v88 = 0;
          if ( (v91->spath != 0) == (*(_DWORD *)(v142 + 16) == 0) )
            goto LABEL_184;
        }
        else if ( !*(_DWORD *)(v142 + 16) )
        {
          v90 = 0;
          v88 = 0;
          goto LABEL_184;
        }
      }
      else
      {
        v90 = 0;
        v88 = 0;
        if ( v101 )
          goto LABEL_184;
      }
      v90 = 1;
      if ( *(_BYTE *)(v142 + 34) )
      {
        v89 = v91;
        v88 = (Cookie **)v142;
      }
      else
      {
        v89 = v91;
        v88 = (Cookie **)v142;
        if ( v91->livecookie )
          goto LABEL_302;
      }
    }
LABEL_184:
    next = v91->next;
    if ( v91->next )
      continue;
    break;
  }
  if ( v88 )
  {
    *v88 = v89->next;
    v88[9] = (Cookie *)v89->creationtime;
    Curl_cfree(v89->name);
    Curl_cfree(v89->value);
    Curl_cfree(v89->domain);
    Curl_cfree(v89->path);
    Curl_cfree(v89->spath);
    v103 = v88[7];
    v104 = v88[8];
    v105 = v88[9];
    v106 = (char *)v88[3];
    v107 = (char *)v88[4];
    v108 = (char *)v88[5];
    v109 = v88[6];
    v110 = v88[11];
    *(_DWORD *)&v89->prefix = v88[10];
    *((_DWORD *)&v89->prefix + 1) = v110;
    v89->creationtime = (int)v105;
    *(_DWORD *)&v89->tailmatch = v104;
    HIDWORD(v89->expires) = v103;
    LODWORD(v89->expires) = v109;
    v89->domain = v108;
    v89->spath = v107;
    v89->path = v106;
    v89->value = (char *)v88[2];
    v89->name = (char *)v88[1];
    v89->next = *v88;
    Curl_cfree(v88);
    v85 = v89;
  }
LABEL_242:
  if ( v136 && v143->running && (*((_BYTE *)&v136->set + 1338) & 0x10) != 0 )
  {
    v111 = v85;
    v120 = "Added";
    if ( (v90 & 1) != 0 )
      v120 = "Replaced";
    ((void (__fastcall *)(Curl_easy *, const char *, const char *, char *))Curl_infof)(
      v136,
      "%s cookie %s=\"%s\" for domain %s, path %s, expire %lld",
      v120,
      v85->name);
    if ( (v90 & 1) == 0 )
    {
LABEL_270:
      if ( v91 )
        v91->next = v111;
      else
        *v86 = v111;
      ++v143->numcookies;
    }
  }
  else
  {
    v111 = v85;
    if ( (v90 & 1) == 0 )
      goto LABEL_270;
  }
  LODWORD(v121) = HIDWORD(v111->expires);
  HIDWORD(v121) = v111->expires;
  if ( !v121 )
    return v111;
  v122 = HIDWORD(v143->next_expiration);
  v123 = (int)v121 >= v122;
  if ( (unsigned int)v121 == v122 )
    v123 = HIDWORD(v121) >= LODWORD(v143->next_expiration);
  v16 = v111;
  if ( !v123 )
  {
    LODWORD(v143->next_expiration) = HIDWORD(v121);
    HIDWORD(v143->next_expiration) = v121;
  }
  return v16;
}
