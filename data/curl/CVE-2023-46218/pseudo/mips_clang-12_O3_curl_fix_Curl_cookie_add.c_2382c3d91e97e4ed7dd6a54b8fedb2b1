Cookie *__fastcall Curl_cookie_add(
        Curl_easy *data,
        CookieInfo *c,
        int httpheader,
        int noexpire,
        int a5,
        int a6,
        int a7,
        int a8,
        const char *lineptr,
        const char *domain,
        const char *path,
        int secure)
{
  int v16; // $s3
  time_t v17; // $v0
  int v18; // $v0
  int v19; // $s5
  char *k; // $s5
  int v21; // $s1
  char *i; // $s1
  int v23; // $s6
  size_t v24; // $v0
  size_t v25; // $s4
  char *v26; // $s7
  unsigned int v27; // $s2
  int v28; // $v0
  unsigned int v29; // $v1
  char *v30; // $fp
  size_t v31; // $v0
  size_t v32; // $a3
  size_t v33; // $a2
  int v34; // $v1
  _DWORD *v35; // $s7
  char *v36; // $a0
  int j; // $v1
  int v38; // $a2
  size_t v39; // $s1
  unsigned int v40; // $s4
  unsigned int v41; // $s6
  int v42; // $v0
  unsigned int v43; // $s6
  int v44; // $v0
  const char *v45; // $v0
  char *v46; // $s2
  size_t v47; // $s4
  char *v48; // $v1
  unsigned int v49; // $s6
  const char *v50; // $v0
  const char *v51; // $s2
  int v52; // $v1
  int v53; // $v0
  size_t v54; // $s2
  int v55; // $v0
  unsigned int v56; // $s2
  int v57; // $v0
  int v58; // $v0
  size_t v59; // $s2
  _BYTE *v60; // $v0
  const char *v61; // $s5
  const char *v62; // $a0
  int is_ipnum; // $v0
  int v64; // $s4
  size_t v65; // $v0
  const char *v66; // $v1
  size_t v67; // $s5
  size_t v68; // $s4
  size_t v69; // $v0
  int v70; // $v0
  int v71; // $v0
  int v72; // $v0
  int v73; // $v0
  int v74; // $v0
  unsigned int v75; // $v1
  _BOOL4 v76; // $a0
  char *v77; // $v0
  char *v78; // $v0
  int v79; // $v0
  char *v80; // $v0
  int v81; // $v0
  unsigned int v82; // $s4
  int v83; // $s0
  void *v84; // $v0
  const char *v85; // $v0
  char *v86; // $s2
  size_t v87; // $s4
  char *v88; // $v1
  int v89; // $v0
  int v90; // $at
  int v91; // $s0
  time_t v92; // $s2
  int v93; // $s3
  int next_expiration_high; // $v0
  _BOOL4 v95; // $a0
  unsigned int next_expiration; // $v1
  Cookie *v97; // $s1
  Cookie **v98; // $s0
  Cookie *next; // $v0
  Cookie **v100; // $s2
  Cookie *v101; // $s7
  char v102; // $s6
  Cookie *v103; // $s3
  int v104; // $a1
  const char *spath; // $s4
  int v106; // $s5
  char *v107; // $v0
  size_t v108; // $a2
  int v109; // $a1
  int v110; // $at
  bool v111; // dc
  int v112; // $at
  int v113; // $a1
  const char *v114; // $a0
  Cookie *v115; // $at
  Cookie *v116; // $v0
  Cookie *v117; // $v1
  char *v118; // $a1
  char *v119; // $a2
  char *v120; // $a3
  Cookie *v121; // $t0
  Cookie *v122; // $t1
  Cookie *v123; // $s2
  Cookie **v124; // $s7
  Cookie *v125; // $fp
  Cookie **p_next; // $s1
  curl_off_t expires; // $v1
  Cookie *v128; // $s4
  _BOOL4 v129; // $a1
  int v130; // $at
  _BOOL4 v131; // $a1
  const char *v132; // $a2
  curl_off_t v133; // $v1
  int v134; // $at
  _BOOL4 v135; // $a1
  int v137; // [sp+34h] [-BCh]
  int *v138; // [sp+3Ch] [-B4h]
  char v139; // [sp+47h] [-A9h]
  Curl_easy *v141; // [sp+4Ch] [-A4h]
  int v142; // [sp+50h] [-A0h]
  int v143; // [sp+54h] [-9Ch]
  int v144; // [sp+5Ch] [-94h]
  int v145; // [sp+64h] [-8Ch]
  CookieInfo *v146; // [sp+68h] [-88h]
  char *v147[32]; // [sp+70h] [-80h] BYREF

  v16 = 0;
  v17 = time(0u);
  if ( data->req.setcookies >= 0x32u )
    return (Cookie *)v16;
  v146 = c;
  v19 = v17;
  v18 = Curl_ccalloc(1, 48);
  if ( !v18 )
    return (Cookie *)v16;
  v143 = v19;
  k = (char *)lineptr;
  v21 = v18;
  v142 = noexpire;
  v145 = v18;
  if ( !httpheader )
  {
    v147[0] = 0;
    if ( strncmp(lineptr, "#HttpOnly_", 0xAu) )
    {
      if ( *lineptr == 35 )
        goto LABEL_5;
    }
    else
    {
      k = (char *)(lineptr + 10);
      *(_BYTE *)(v21 + 35) = 1;
      if ( lineptr[10] == 35 )
        goto LABEL_5;
    }
    v77 = strchr(k, 13);
    if ( v77 )
      *v77 = 0;
    v78 = strchr(k, 10);
    if ( v78 )
      *v78 = 0;
    if ( strtok_r(k, "\t", v147) )
      __asm { jr      $at }
    goto LABEL_248;
  }
  if ( strlen(lineptr) >= 0x1389 )
  {
LABEL_5:
    Curl_cfree(v21);
    return (Cookie *)v16;
  }
  v141 = data;
  v137 = 0x7FFFFFFF - (v143 >> 0x1F);
  v138 = (int *)(v21 + 0x18);
  v139 = 0;
  do
  {
    for ( i = k + 1; ; ++i )
    {
      v23 = (unsigned __int8)*k;
      if ( v23 != 32 && v23 != 9 )
        break;
      ++k;
    }
    v24 = strcspn(k, ";\t\r\n=");
    if ( !v24 )
    {
      v26 = k;
      goto LABEL_70;
    }
    v25 = v24;
    v26 = &k[v24];
    v27 = v24;
    while ( 1 )
    {
      v28 = (unsigned __int8)k[v27 - 1];
      if ( v28 != 32 && v28 != 9 )
        break;
      if ( !--v27 )
      {
        v27 = 0;
        break;
      }
    }
    v29 = 0;
    v30 = 0;
    v144 = (unsigned __int8)*v26;
    if ( v144 == 61 )
    {
      v31 = strcspn(&k[v25 + 1], ";\r\n");
      v32 = v25 + v31;
      v33 = 0;
      if ( v31 )
      {
        v30 = &i[v32];
        while ( 1 )
        {
          v34 = (unsigned __int8)*(v30 - 1);
          if ( v34 != 32 && v34 != 9 )
            break;
          --v31;
          --v30;
          if ( !v31 )
          {
            v30 = &k[v25 + 1];
            v35 = (_DWORD *)v145;
            v39 = v32;
            goto LABEL_36;
          }
        }
        v35 = (_DWORD *)v145;
        v36 = &i[v25];
        for ( j = 0; j != v31; ++j )
        {
          v38 = (unsigned __int8)v36[j];
          if ( v38 != 32 && v38 != 9 )
          {
            v39 = v32;
            v33 = v31 - j;
            v30 = &v36[j];
            goto LABEL_36;
          }
        }
        v39 = v32;
        v33 = 0;
      }
      else
      {
        v30 = &k[v25 + 1];
        v35 = (_DWORD *)v145;
        v39 = v25 + v31;
      }
LABEL_36:
      v40 = v33;
      if ( memchr(v30, 9, v33) )
      {
        Curl_cfree(v35[5]);
        Curl_cfree(v35[3]);
        Curl_cfree(v35[4]);
        Curl_cfree(v35[1]);
        Curl_cfree(v35[2]);
        Curl_cfree(v35);
        v16 = 0;
        if ( (*((_BYTE *)&data->set + 1337) & 4) != 0 )
          Curl_infof(data, "cookie contains TAB, dropping");
        return (Cookie *)v16;
      }
      v29 = v40;
      v26 = &k[v39 + 1];
    }
    if ( v27 >= 0xFFF || v29 >= 0xFFF || v29 + v27 >= 0x1001 )
    {
      v82 = v29;
      Curl_cfree(*(_DWORD *)(v145 + 20));
      Curl_cfree(*(_DWORD *)(v145 + 12));
      Curl_cfree(*(_DWORD *)(v145 + 16));
      Curl_cfree(*(_DWORD *)(v145 + 4));
      Curl_cfree(*(_DWORD *)(v145 + 8));
      Curl_cfree(v145);
      if ( (*((_BYTE *)&data->set + 1337) & 4) != 0 )
        Curl_infof(data, "oversized cookie dropped, name/val %zu + %zu bytes", v27, v82);
      return 0;
    }
    if ( v23 == 95 && v27 >= 7 && k[1] == 95 )
    {
      v41 = v29;
      if ( curl_strnequal("__Secure-", k, 9) )
      {
        v29 = v41;
        *(_BYTE *)(v145 + 40) |= 1u;
      }
      else
      {
        v42 = curl_strnequal("__Host-", k, 7);
        v29 = v41;
        if ( v42 )
          *(_BYTE *)(v145 + 40) |= 2u;
      }
    }
    if ( *(_DWORD *)(v145 + 4) )
    {
      if ( !v29 )
      {
        if ( v27 == 8 )
        {
          v70 = curl_strnequal("httponly", k, 8);
          v29 = 0;
          if ( v70 )
          {
            *(_BYTE *)(v145 + 35) = 1;
            goto LABEL_70;
          }
        }
        else if ( v27 == 6 )
        {
          v53 = curl_strnequal("secure", k, 6);
          v29 = 0;
          if ( v53 )
          {
            if ( !secure && v146->running )
              goto LABEL_231;
            *(_BYTE *)(v145 + 33) = 1;
            goto LABEL_70;
          }
        }
        if ( v144 != 61 )
          goto LABEL_70;
      }
      if ( v27 == 7 )
      {
        v54 = v29;
        if ( !curl_strnequal("version", k, 7) )
        {
          if ( curl_strnequal("max-age", k, 7) )
          {
            if ( *v30 == 0x22 )
              ++v30;
            v55 = ((int (__fastcall *)(char *, _DWORD, int, int *))curlx_strtoofft)(v30, 0, 10, v138);
            if ( v55 )
            {
              if ( v55 == 2 )
              {
                *v138 = 0;
                v138[1] = 1;
              }
              else if ( v55 == 1 )
              {
                v138[1] = -1;
                *v138 = 0x7FFFFFFF;
              }
            }
            else
            {
              v74 = *v138;
              v75 = v138[1];
              if ( *(_QWORD *)v138 )
              {
                v76 = v137 >= v74;
                if ( v137 == v74 )
                  v76 = ~v143 >= v75;
                if ( v76 )
                {
                  v138[1] = v75 + v143;
                  *v138 = v74 + (v143 >> 0x1F) + __CFADD__(v75, v143);
                }
                else
                {
                  v138[1] = -1;
                  *v138 = 0x7FFFFFFF;
                }
              }
              else
              {
                *v138 = 0;
                v138[1] = 1;
              }
            }
          }
          else if ( curl_strnequal("expires", k, 7) && v54 < 0x80 && !*(_QWORD *)v138 )
          {
            memcpy(v147, v30, v54);
            *((_BYTE *)v147 + v54) = 0;
            v72 = ((int (__fastcall *)(char **))Curl_getdate_capped)(v147);
            *(_QWORD *)v138 = v72;
            if ( v72 )
            {
              if ( v72 < 0 )
              {
                v138[1] = 0;
                *v138 = 0;
              }
            }
            else
            {
              *v138 = 0;
              v138[1] = 1;
            }
          }
        }
        goto LABEL_70;
      }
      if ( v27 == 6 )
      {
        v56 = v29;
        v57 = curl_strnequal("domain", k, 6);
        if ( !v56 || !v57 )
          goto LABEL_70;
        v58 = (unsigned __int8)*v30;
        if ( v58 == 0x2E )
          ++v30;
        v59 = (__PAIR64__(v56, v58 ^ 0x2Eu) - 1) >> 32;
        if ( v59 == 9 && curl_strnequal(v30, "localhost", 9)
          || (v60 = memchr(v30, 46, v59)) != 0 && (unsigned int)(&v30[v59] - v60) >= 2 )
        {
          v61 = domain;
          v62 = domain;
          if ( !domain )
            v62 = v30;
          is_ipnum = Curl_host_is_ipnum(v62);
          v64 = is_ipnum;
          if ( domain )
          {
            if ( !is_ipnum )
              goto LABEL_102;
LABEL_112:
            domain = v61;
            if ( strncmp(v30, v61, v59) || (v64 = 1, v59 != strlen(v61)) )
            {
LABEL_114:
              v139 = 1;
              if ( (*((_BYTE *)&data->set + 1337) & 4) != 0 )
                Curl_infof(data, "skipped cookie with bad tailmatch domain: %s", v30);
              goto LABEL_70;
            }
          }
          else
          {
            domain = 0;
          }
        }
        else
        {
          v61 = ":";
          if ( Curl_host_is_ipnum(v61) )
            goto LABEL_112;
LABEL_102:
          v65 = strlen(v61);
          v66 = v61;
          domain = v61;
          if ( v65 < v59 )
            goto LABEL_114;
          v67 = v65;
          v68 = (size_t)&v66[v65 - v59];
          if ( !curl_strnequal(v30, v68, v59) )
            goto LABEL_114;
          v69 = v68;
          v64 = 0;
          if ( v67 != v59 && *(_BYTE *)(v69 - 1) != 46 )
            goto LABEL_114;
        }
        Curl_cfree(*(_DWORD *)(v145 + 20));
        v73 = ((int (__fastcall *)(char *, size_t))Curl_strndup)(v30, v59);
        *(_DWORD *)(v145 + 20) = v73;
        if ( v64 || !v73 )
        {
          if ( !v73 )
            goto LABEL_231;
          v139 |= v73 == 0;
        }
        else
        {
          *(_BYTE *)(v145 + 32) = 1;
        }
        goto LABEL_70;
      }
      if ( v27 != 4 )
        goto LABEL_70;
      v43 = v29;
      if ( !curl_strnequal("path", k, 4) )
        goto LABEL_70;
      Curl_cfree(*(_DWORD *)(v145 + 12));
      v44 = ((int (__fastcall *)(char *, unsigned int))Curl_strndup)(v30, v43);
      *(_DWORD *)(v145 + 12) = v44;
      if ( !v44 )
        goto LABEL_231;
      Curl_cfree(*(_DWORD *)(v145 + 16));
      v45 = (const char *)Curl_cstrdup(*(_DWORD *)(v145 + 12));
      if ( !v45 )
      {
        *(_DWORD *)(v145 + 16) = 0;
        goto LABEL_231;
      }
      v46 = (char *)v45;
      v47 = strlen(v45);
      if ( *v46 == 34 )
        memmove(v46, v46 + 1, v47--);
      if ( v47 )
      {
        v48 = &v46[v47 - 1];
        if ( *v48 == 34 )
        {
          --v47;
          *v48 = 0;
        }
        if ( *v46 == 47 )
        {
          if ( v47 && v46[v47 - 1] == 47 )
            v46[v47 - 1] = 0;
LABEL_117:
          *(_DWORD *)(v145 + 16) = v46;
          goto LABEL_70;
        }
      }
      else if ( *v46 == 47 )
      {
        goto LABEL_117;
      }
      Curl_cfree(v46);
      v71 = ((int (__fastcall *)(const char *, int))Curl_strndup)("/", 1);
      *(_DWORD *)(v145 + 16) = v71;
      if ( !v71 )
        goto LABEL_231;
    }
    else
    {
      if ( v144 != 61 )
        goto LABEL_231;
      v49 = v29;
      Curl_cfree(0);
      *(_DWORD *)(v145 + 4) = ((int (__fastcall *)(char *, unsigned int))Curl_strndup)(k, v27);
      Curl_cfree(*(_DWORD *)(v145 + 8));
      v50 = (const char *)((int (__fastcall *)(char *, unsigned int))Curl_strndup)(v30, v49);
      *(_DWORD *)(v145 + 8) = v50;
      if ( !v50 )
        goto LABEL_231;
      v51 = *(const char **)(v145 + 4);
      if ( !v51 )
        goto LABEL_231;
      if ( v50[strcspn(v50, invalid_octets_badoctets)] || v51[strcspn(v51, invalid_octets_badoctets)] )
      {
        if ( (*((_BYTE *)&data->set + 1337) & 4) != 0 )
          Curl_infof(data, "invalid octets in name/value, cookie dropped");
        goto LABEL_231;
      }
    }
LABEL_70:
    for ( k = v26 + 1; ; ++k )
    {
      v52 = (unsigned __int8)*(k - 1);
      if ( v52 != 32 && v52 != 9 )
        break;
    }
  }
  while ( v52 == 59 );
  if ( (v139 & 1) != 0 )
    goto LABEL_231;
  if ( domain )
  {
    if ( !*(_DWORD *)(v145 + 20) )
    {
      v79 = Curl_cstrdup(domain);
      *(_DWORD *)(v145 + 20) = v79;
      if ( !v79 )
        goto LABEL_231;
    }
  }
  if ( !path || *(_DWORD *)(v145 + 12) )
    goto LABEL_183;
  v80 = strchr(path, 63);
  v81 = v80 ? ((int (__fastcall *)(const char *, int, int))Curl_memrchr)(path, 47, v80 - path) : (int)strrchr(path, 47);
  if ( !v81 )
    goto LABEL_183;
  v83 = v81 - (_DWORD)path;
  v84 = (void *)Curl_cmalloc(v81 - (_DWORD)path + 2);
  *(_DWORD *)(v145 + 12) = v84;
  if ( !v84 )
    goto LABEL_231;
  memcpy(v84, path, v83 + 1);
  *(_BYTE *)(*(_DWORD *)(v145 + 12) + v83 + 1) = 0;
  v85 = (const char *)Curl_cstrdup(*(_DWORD *)(v145 + 12));
  if ( !v85 )
  {
    *(_DWORD *)(v145 + 16) = 0;
LABEL_231:
    Curl_cfree(*(_DWORD *)(v145 + 20));
    Curl_cfree(*(_DWORD *)(v145 + 12));
    Curl_cfree(*(_DWORD *)(v145 + 16));
    Curl_cfree(*(_DWORD *)(v145 + 4));
    Curl_cfree(*(_DWORD *)(v145 + 8));
    Curl_cfree(v145);
    return 0;
  }
  v86 = (char *)v85;
  v87 = strlen(v85);
  if ( *v86 == 34 )
    memmove(v86, v86 + 1, v87--);
  if ( !v87 )
  {
    if ( *v86 == 47 )
      goto LABEL_181;
    goto LABEL_182;
  }
  v88 = &v86[v87 - 1];
  if ( *v88 == 34 )
  {
    --v87;
    *v88 = 0;
  }
  if ( *v86 != 47 )
  {
LABEL_182:
    Curl_cfree(v86);
    v89 = ((int (__fastcall *)(const char *, int))Curl_strndup)("/", 1);
    *(_DWORD *)(v145 + 16) = v89;
    if ( !v89 )
      goto LABEL_231;
    goto LABEL_183;
  }
  if ( v87 && v86[v87 - 1] == 47 )
    v86[v87 - 1] = 0;
LABEL_181:
  *(_DWORD *)(v145 + 16) = v86;
LABEL_183:
  if ( !*(_DWORD *)(v145 + 4) )
    goto LABEL_231;
  v21 = v145;
  v16 = 0;
  ++v141->req.setcookies;
  if ( (*(_BYTE *)(v145 + 40) & 1) != 0 && !*(_BYTE *)(v145 + 33)
    || (*(_BYTE *)(v145 + 40) & 2) != 0
    && (!*(_BYTE *)(v145 + 33) || (v114 = *(const char **)(v145 + 12)) == 0
                               || strcmp(v114, "/")
                               || *(_BYTE *)(v145 + 32))
    || !v146->running && v146->newsession && !*(_QWORD *)(v145 + 24) )
  {
LABEL_248:
    Curl_cfree(*(_DWORD *)(v21 + 20));
    Curl_cfree(*(_DWORD *)(v21 + 12));
    Curl_cfree(*(_DWORD *)(v21 + 16));
    Curl_cfree(*(_DWORD *)(v21 + 4));
    Curl_cfree(*(_DWORD *)(v21 + 8));
    Curl_cfree(v21);
    return (Cookie *)v16;
  }
  *(_BYTE *)(v145 + 34) = v146->running;
  v90 = v146->lastct + 1;
  v146->lastct = v90;
  *(_DWORD *)(v145 + 36) = v90;
  if ( !v142 )
  {
    v91 = 0;
    v92 = time(0u);
    v93 = v92 >> 0x1F;
    next_expiration_high = HIDWORD(v146->next_expiration);
    v95 = v92 >> 0x1F >= next_expiration_high;
    next_expiration = v146->next_expiration;
    if ( next_expiration_high == v92 >> 0x1F )
      v95 = v92 >= next_expiration;
    if ( v95 || !(~next_expiration | next_expiration_high ^ 0x7FFFFFFF) )
    {
      LODWORD(v146->next_expiration) = -1;
      HIDWORD(v146->next_expiration) = 0x7FFFFFFF;
      do
      {
        v124 = &v146->cookies[v91];
        v125 = *v124;
        if ( *v124 )
        {
          p_next = 0;
          do
          {
            expires = v125->expires;
            v128 = v125;
            v125 = v125->next;
            if ( !expires )
              goto LABEL_268;
            v129 = SHIDWORD(expires) >= v93;
            if ( HIDWORD(expires) == v93 )
              v129 = (unsigned int)expires >= v92;
            if ( v129 )
            {
LABEL_268:
              if ( expires )
              {
                v130 = HIDWORD(v146->next_expiration);
                v131 = SHIDWORD(expires) >= v130;
                if ( HIDWORD(expires) == v130 )
                  v131 = (unsigned int)expires >= LODWORD(v146->next_expiration);
                p_next = &v128->next;
                if ( !v131 )
                  v146->next_expiration = expires;
              }
              else
              {
                p_next = &v128->next;
              }
            }
            else
            {
              if ( p_next )
                *p_next = v125;
              else
                *v124 = v125;
              --v146->numcookies;
              Curl_cfree(v128->domain);
              Curl_cfree(v128->path);
              Curl_cfree(v128->spath);
              Curl_cfree(v128->name);
              Curl_cfree(v128->value);
              Curl_cfree(v128);
            }
          }
          while ( v125 );
        }
        ++v91;
      }
      while ( v91 != 63 );
    }
  }
  v97 = (Cookie *)v145;
  v98 = &v146->cookies[cookiehash(*(const char *const *)(v145 + 20))];
  next = *v98;
  if ( !*v98 )
  {
    v103 = 0;
    v102 = 0;
    goto LABEL_250;
  }
  v100 = 0;
  v101 = 0;
  v102 = 0;
  while ( 2 )
  {
    v103 = next;
    if ( ((int (__fastcall *)(char *, _DWORD))curl_strequal)(next->name, *(_DWORD *)(v145 + 4)) )
    {
      v104 = *(_DWORD *)(v145 + 20);
      if ( v103->domain )
      {
        if ( v104 && ((int (*)(void))curl_strequal)() )
        {
LABEL_202:
          spath = v103->spath;
          if ( spath )
          {
            v106 = *(_DWORD *)(v145 + 16);
            if ( v106 )
            {
              if ( v103->secure && !*(_BYTE *)(v145 + 33) && !secure )
              {
                v107 = strchr(spath + 1, 47);
                v108 = v107 ? v107 - spath : strlen(spath);
                if ( curl_strnequal(spath, v106, v108) )
                {
                  if ( v141 && (*((_BYTE *)&v141->set + 1337) & 4) != 0 )
                    Curl_infof(
                      v141,
                      "cookie '%s' for domain '%s' dropped, would overlay an existing cookie",
                      *(_DWORD *)(v145 + 4),
                      *(_DWORD *)(v145 + 20));
                  goto LABEL_231;
                }
              }
            }
          }
        }
      }
      else if ( !v104 )
      {
        goto LABEL_202;
      }
    }
    if ( !v100 )
    {
      if ( !((int (__fastcall *)(char *, _DWORD))curl_strequal)(v103->name, *(_DWORD *)(v145 + 4)) )
      {
        v100 = 0;
        goto LABEL_197;
      }
      v109 = *(_DWORD *)(v145 + 20);
      if ( v103->domain )
      {
        if ( v109 && ((int (*)(void))curl_strequal)() )
        {
          v110 = v102 & 1 | (v103->tailmatch == *(unsigned __int8 *)(v145 + 32));
          v102 = 0;
          if ( !v110 )
          {
            v100 = 0;
            goto LABEL_197;
          }
        }
        else
        {
          v111 = (v102 & 1) != 0;
          v102 = 0;
          if ( !v111 )
          {
            v100 = 0;
            goto LABEL_197;
          }
        }
      }
      else
      {
        v112 = v102 & 1 | (v109 == 0);
        v102 = 0;
        if ( !v112 )
        {
          v100 = 0;
          goto LABEL_197;
        }
      }
      v113 = *(_DWORD *)(v145 + 16);
      if ( v103->spath )
      {
        if ( v113 )
        {
          if ( !((int (*)(void))curl_strequal)() )
          {
            v102 = 0;
            v100 = 0;
            goto LABEL_197;
          }
          v102 = 0;
          v100 = 0;
          if ( (v103->spath != 0) == (*(_DWORD *)(v145 + 16) == 0) )
            goto LABEL_197;
        }
        else if ( !*(_DWORD *)(v145 + 16) )
        {
          v102 = 0;
          v100 = 0;
          goto LABEL_197;
        }
      }
      else
      {
        v102 = 0;
        v100 = 0;
        if ( v113 )
          goto LABEL_197;
      }
      v102 = 1;
      if ( *(_BYTE *)(v145 + 34) )
      {
        v101 = v103;
        v100 = (Cookie **)v145;
      }
      else
      {
        v101 = v103;
        v100 = (Cookie **)v145;
        if ( v103->livecookie )
          goto LABEL_231;
      }
    }
LABEL_197:
    next = v103->next;
    if ( v103->next )
      continue;
    break;
  }
  if ( v100 )
  {
    *v100 = v101->next;
    v100[9] = (Cookie *)v101->creationtime;
    Curl_cfree(v101->name);
    Curl_cfree(v101->value);
    Curl_cfree(v101->domain);
    Curl_cfree(v101->path);
    Curl_cfree(v101->spath);
    v115 = v100[7];
    v116 = v100[8];
    v117 = v100[9];
    v118 = (char *)v100[3];
    v119 = (char *)v100[4];
    v120 = (char *)v100[5];
    v121 = v100[6];
    v122 = v100[11];
    *(_DWORD *)&v101->prefix = v100[10];
    *((_DWORD *)&v101->prefix + 1) = v122;
    v101->creationtime = (int)v117;
    *(_DWORD *)&v101->tailmatch = v116;
    LODWORD(v101->expires) = v115;
    HIDWORD(v101->expires) = v121;
    v101->domain = v120;
    v101->spath = v119;
    v101->path = v118;
    v101->value = (char *)v100[2];
    v101->name = (char *)v100[1];
    v101->next = *v100;
    Curl_cfree(v100);
    v97 = v101;
  }
LABEL_250:
  if ( v141 && v146->running && (*((_BYTE *)&v141->set + 1337) & 4) != 0 )
  {
    v123 = v97;
    v132 = "Added";
    if ( (v102 & 1) != 0 )
      v132 = "Replaced";
    Curl_infof(v141, "%s cookie %s=\"%s\" for domain %s, path %s, expire %lld", v132, v97->name);
    if ( (v102 & 1) == 0 )
    {
LABEL_278:
      if ( v103 )
        v103->next = v123;
      else
        *v98 = v123;
      ++v146->numcookies;
    }
  }
  else
  {
    v123 = v97;
    if ( (v102 & 1) == 0 )
      goto LABEL_278;
  }
  v133 = v123->expires;
  if ( !v133 )
    return v123;
  v134 = HIDWORD(v146->next_expiration);
  v135 = SHIDWORD(v133) >= v134;
  if ( HIDWORD(v133) == v134 )
    v135 = (unsigned int)v133 >= LODWORD(v146->next_expiration);
  if ( !v135 )
    v146->next_expiration = v133;
  return v123;
}
