unsigned __int8 *__fastcall udhcp_get_option(int a1, int a2)
{
  int v2; // $t0
  unsigned int v3; // $t3
  int v4; // $t2
  int v5; // $a3
  int v6; // $t1
  unsigned __int8 *v7; // $a2
  int v8; // $v1
  unsigned __int8 *v9; // $v1
  int v10; // $v0

  v2 = a1 + 240;
  v3 = 0;
  v4 = 0;
  v5 = 0;
  v6 = 388;
  while ( 1 )
  {
    v7 = (unsigned __int8 *)(v2 + v5);
    if ( v5 >= v6 )
      break;
    v8 = *v7;
    if ( v8 == a2 )
    {
      v9 = v7 + 2;
      if ( v5 + v7[1] + 1 < v6 )
        return v9;
      break;
    }
    if ( v8 == 52 )
    {
      if ( v5 + v7[1] + 1 >= v6 )
        break;
      v3 = v7[3];
      v10 = v5 + *(unsigned __int8 *)(v2 + 1);
LABEL_23:
      v5 = v10 + 2;
    }
    else if ( *v7 >= 0x35u )
    {
      if ( v8 != 255 )
      {
LABEL_22:
        v10 = v5 + v7[1];
        goto LABEL_23;
      }
      if ( v4 || (v2 = a1 + 108, (v3 & 1) == 0) )
      {
        v9 = 0;
        if ( v4 != 1 )
          return v9;
        v2 = a1 + 44;
        if ( ((v3 >> 1) & 1) == 0 )
          return v9;
        v5 = 0;
        v6 = 64;
        v4 = 2;
      }
      else
      {
        v5 = 0;
        v6 = 128;
        v4 = 1;
      }
    }
    else
    {
      if ( *v7 )
        goto LABEL_22;
      ++v5;
    }
  }
  bb_error_msg("bogus packet, option fields too long");
  return 0;
}
