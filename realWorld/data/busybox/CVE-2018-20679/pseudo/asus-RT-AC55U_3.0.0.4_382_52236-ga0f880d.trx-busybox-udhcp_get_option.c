unsigned __int8 *__fastcall udhcp_get_option(unsigned __int8 *a1, int a2)
{
  unsigned __int8 *v2; // $v0
  int v3; // $a2
  int v4; // $v1
  int i; // $a3
  int v7; // $t0

  v2 = a1 + 240;
  v3 = 0;
  v4 = 1224;
  while ( 2 )
  {
    while ( 2 )
    {
      for ( i = *v2; ; i = *v2 )
      {
        if ( !i )
        {
          --v4;
          ++v2;
          goto LABEL_5;
        }
        if ( i == 255 )
          break;
        v7 = v2[1] + 2;
        v4 -= v7;
        if ( v4 < 0 )
        {
LABEL_7:
          sub_408C20("bad packet, malformed option field", a2, v3);
          return 0;
        }
        if ( i == a2 )
          return v2 + 2;
        if ( i == 52 )
          v3 |= v2[2];
        v2 += v7;
LABEL_5:
        if ( v4 <= 0 )
          goto LABEL_7;
      }
      v2 = a1 + 108;
      if ( (v3 & 0x101) == 1 )
      {
        v3 |= 0x101u;
        v4 = 128;
        continue;
      }
      break;
    }
    if ( (v3 & 0x202) == 2 )
    {
      v3 |= 0x202u;
      v2 = a1 + 44;
      v4 = 64;
      continue;
    }
    return 0;
  }
}
