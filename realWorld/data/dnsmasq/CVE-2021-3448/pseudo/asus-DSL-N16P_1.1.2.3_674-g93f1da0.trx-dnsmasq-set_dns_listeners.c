int __fastcall set_dns_listeners(int a1)
{
  int v2; // $v0
  _DWORD *v3; // $s0
  int v4; // $s2
  _DWORD *i; // $s0
  int v6; // $v0
  _DWORD *j; // $s0
  int v8; // $a0
  int v9; // $a1
  int v10; // $v0
  int v11; // $a0
  int v13; // $v0
  int v14; // $s0
  int v15; // [sp+18h] [-8h] BYREF

  v15 = 0;
  v2 = dnsmasq_daemon;
  v3 = *(_DWORD **)(dnsmasq_daemon + 1196);
  v4 = 0;
  if ( v3 )
  {
    do
    {
      ++v4;
      poll_listen(*v3, 1);
      v3 = (_DWORD *)v3[14];
    }
    while ( v3 );
    v2 = dnsmasq_daemon;
  }
  if ( *(_DWORD *)(v2 + 216) )
    get_new_frec(a1, &v15, 0);
  for ( i = *(_DWORD **)(dnsmasq_daemon + 496); i; i = (_DWORD *)i[12] )
    poll_listen(*i, 1);
  if ( *(_DWORD *)(dnsmasq_daemon + 216) && !*(_DWORD *)(dnsmasq_daemon + 132) )
  {
    v13 = dnsmasq_daemon + 608;
    v14 = 1;
    if ( *(_WORD *)(dnsmasq_daemon + 616) )
      goto LABEL_28;
    while ( v14 != 64 )
    {
      while ( 1 )
      {
        v13 = dnsmasq_daemon + 8 * (v14 + 76);
        ++v14;
        if ( !*(_WORD *)(v13 + 8) )
          break;
LABEL_28:
        poll_listen(*(_DWORD *)(v13 + 4), 1);
        if ( v14 == 64 )
        {
          v6 = dnsmasq_daemon;
          goto LABEL_11;
        }
      }
    }
  }
  v6 = dnsmasq_daemon;
LABEL_11:
  for ( j = *(_DWORD **)(v6 + 504); j; j = (_DWORD *)j[5] )
  {
    if ( *j != -1 && !v15 )
      poll_listen(*j, 1);
    v8 = j[1];
    if ( v8 != -1 )
    {
      v9 = 0;
      v10 = dnsmasq_daemon;
      while ( 1 )
      {
        v9 += 4;
        if ( !*(_DWORD *)(v10 + 532) )
          break;
        v10 = dnsmasq_daemon + v9;
        if ( v9 == 80 )
          goto LABEL_19;
      }
      poll_listen(v8, 1);
    }
LABEL_19:
    if ( *(_DWORD *)(dnsmasq_daemon + 392) >= v4 )
    {
      v11 = j[2];
      if ( v11 != -1 )
        poll_listen(v11, 1);
    }
  }
  return v15;
}
