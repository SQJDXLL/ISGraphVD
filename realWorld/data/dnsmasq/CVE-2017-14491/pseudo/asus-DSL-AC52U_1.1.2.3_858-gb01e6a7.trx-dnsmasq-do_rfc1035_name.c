_BYTE *__fastcall do_rfc1035_name(_BYTE *a1, _BYTE *a2, unsigned int a3)
{
  _BYTE *v3; // $t1
  int v4; // $v1
  char v5; // $v0
  unsigned int v6; // $v0
  char v7; // $t0
  _BYTE *v8; // $v1

  if ( a2 && *a2 )
  {
    while ( 1 )
    {
      v3 = a1 + 1;
      if ( a3 )
      {
        v3 = a1 + 1;
        if ( a3 < (unsigned int)(a1 + 1) )
          break;
      }
      v4 = (char)*a2;
      v5 = 0;
      if ( v4 != 46 )
      {
        v6 = (unsigned int)(v3 + 1);
        v7 = 0;
        while ( 1 )
        {
          ++a2;
          ++v7;
          v3 = (_BYTE *)v6;
          if ( a3 )
          {
            if ( a3 < v6 )
              return (_BYTE *)(v6 - 1);
          }
          *(_BYTE *)(v6 - 1) = v4;
          v4 = (char)*a2;
          ++v6;
          if ( !*a2 || v4 == 46 )
          {
            v5 = v7;
            break;
          }
        }
      }
      *a1 = v5;
      v8 = a2 + 1;
      if ( !*a2 )
        v8 = a2;
      a1 = v3;
      if ( v8 )
      {
        a2 = v8;
        if ( *v8 )
          continue;
      }
      return a1;
    }
  }
  return a1;
}
