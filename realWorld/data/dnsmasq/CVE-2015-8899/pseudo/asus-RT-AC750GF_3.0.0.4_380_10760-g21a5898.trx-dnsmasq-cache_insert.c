int __fastcall cache_insert(const char *a1, _DWORD *a2, int a3, unsigned int a4, unsigned __int16 a5)
{
  unsigned int v8; // $v1
  unsigned int v9; // $v1
  int v10; // $s5
  int v11; // $s0
  int v12; // $s3
  int v13; // $v0
  int result; // $v0
  int v15; // $s1
  int v16; // $a0
  int v17; // $a1
  int v18; // $v0
  int v19; // $v0
  int v20; // $s0
  char *v21; // $v0
  int v22; // $v1
  int v23; // $a1
  int v24; // $v1
  int v25; // $a0
  int v26[4]; // [sp+18h] [-18h] BYREF
  int *v27; // [sp+28h] [-8h]

  if ( (a5 & 0x980) != 0 )
  {
    log_query(a5 | 0x10000, a1, a2, 0);
    v8 = *(_DWORD *)(dnsmasq_daemon + 248);
    if ( v8 && v8 < a4 )
      a4 = *(_DWORD *)(dnsmasq_daemon + 248);
    v9 = *(_DWORD *)(dnsmasq_daemon + 244);
    if ( v9 && a4 < v9 )
      a4 = *(_DWORD *)(dnsmasq_daemon + 244);
  }
  v10 = 0;
  if ( dword_455270 )
    return v10;
  v10 = sub_4053FC(a1, a2, a3, a5);
  if ( v10 )
  {
    if ( (a5 & 0x180) != 0 && (a5 & 8) != 0 && a2 )
    {
      v13 = a5 & 0x100;
      if ( (a5 & 0x80) != 0 )
      {
        v13 = a5 & 0x100;
        if ( (*(_WORD *)(v10 + 36) & 0x80) != 0 )
        {
          v13 = a5 & 0x100;
          if ( *(_DWORD *)(v10 + 12) == *a2 )
            return v10;
        }
      }
      if ( v13
        && (*(_WORD *)(v10 + 36) & 0x100) != 0
        && *(_DWORD *)(v10 + 12) == *a2
        && *(_DWORD *)(v10 + 16) == a2[1]
        && *(_DWORD *)(v10 + 20) == a2[2] )
      {
        result = v10;
        if ( *(_DWORD *)(v10 + 24) == a2[3] )
          return result;
        v10 = 0;
        goto LABEL_41;
      }
    }
  }
  else
  {
    v11 = a5 & 4;
    v12 = 0;
    v27 = v26;
    while ( 1 )
    {
      v15 = dword_45525C;
      if ( !dword_45525C )
        break;
      if ( (*(_WORD *)(dword_45525C + 36) & 0xC) == 0 )
      {
        if ( a1 && strlen(a1) >= 0x32 )
        {
          v20 = dword_455260;
          if ( dword_455260 )
          {
            dword_455260 = *(_DWORD *)dword_455260;
          }
          else
          {
            if ( !dword_455274 && (a5 & 0x5000) == 0 )
              goto LABEL_41;
            v20 = whine_malloc(1028);
            if ( !v20 )
              goto LABEL_41;
            if ( dword_455274 )
              --dword_455274;
          }
        }
        else
        {
          v20 = 0;
        }
        sub_403D8C(v15);
        *(_WORD *)(v15 + 36) = a5;
        if ( v20 )
        {
          *(_DWORD *)(v15 + 40) = v20;
          *(_WORD *)(v15 + 36) = a5 | 0x200;
        }
        if ( a1 )
        {
          v21 = (char *)cache_get_name(v15);
          strcpy(v21, a1);
        }
        else
        {
          *(_BYTE *)cache_get_name(v15) = 0;
        }
        v22 = a3;
        if ( a2 )
        {
          v23 = a2[3];
          v24 = a2[1];
          v25 = a2[2];
          *(_DWORD *)(v15 + 12) = *a2;
          *(_DWORD *)(v15 + 16) = v24;
          *(_DWORD *)(v15 + 20) = v25;
          *(_DWORD *)(v15 + 24) = v23;
          v22 = a3;
        }
        v10 = v15;
        *(_DWORD *)(v15 + 28) = a4 + v22;
        *(_DWORD *)v15 = dword_455268;
        dword_455268 = v15;
        return v10;
      }
      if ( v12 )
      {
        if ( !dword_45526C )
        {
          my_syslog(3, "Internal error in cache.", a3, 0);
          dword_45526C = 1;
        }
        goto LABEL_41;
      }
      if ( v11 )
      {
        v16 = *(_DWORD *)(dword_45525C + 20);
        v17 = *(_DWORD *)(dword_45525C + 24);
        v18 = *(_DWORD *)(dword_45525C + 12);
        v26[1] = *(_DWORD *)(dword_45525C + 16);
        v26[2] = v16;
        v26[3] = v17;
        v26[0] = v18;
        v19 = cache_get_name(dword_45525C);
        sub_4053FC(v19, v27, a3, *(unsigned __int16 *)(v15 + 36));
        v12 = 1;
        ++dword_455248;
      }
      else
      {
        v11 = 1;
        sub_4053FC(0, 0, a3, 0);
      }
    }
  }
  v10 = 0;
LABEL_41:
  dword_455270 = 1;
  return v10;
}
