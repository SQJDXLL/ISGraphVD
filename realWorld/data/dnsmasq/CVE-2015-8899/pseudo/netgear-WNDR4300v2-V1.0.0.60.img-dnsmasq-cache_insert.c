int __fastcall cache_insert(int a1, int a2, int a3, int a4, unsigned __int16 a5)
{
  int v6; // $s2
  int v8; // $s5
  int v9; // $s0
  __int16 v10; // $s3
  int v11; // $s1
  int v12; // $a3
  int v13; // $a0
  int v14; // $v1
  _DWORD *v15; // $v0
  __int16 v16; // $v1
  int v17; // $a0
  _BYTE *v18; // $v1
  bool v19; // dc

  v6 = a1;
  v8 = 4;
  if ( (a5 & 0x100) != 0 )
    v8 = 16;
  log_query(a5 | 0x400, a1, a2, 0, 0, 0);
  if ( (a5 & 0x24) == 0x24 )
    v6 = 0;
  v9 = 0;
  if ( !dword_4335FC )
  {
    v10 = a5 & 0xFFFD;
    if ( sub_403518(v6, a2, a3, a5 & 0xFFFD) )
    {
      v11 = a5 & 4;
      while ( 1 )
      {
        v9 = dword_4335E4;
        if ( !dword_4335E4 )
        {
          dword_4335FC = 1;
          return v9;
        }
        v12 = *(unsigned __int16 *)(dword_4335E4 + 36);
        if ( (v12 & 0xC) == 0 )
          break;
        if ( v11 )
        {
          if ( (v12 & 0x200) != 0 || (v13 = dword_4335E4 + 40, (v12 & 0x10) != 0) )
            v13 = *(_DWORD *)(dword_4335E4 + 40);
          sub_403518(v13, dword_4335E4 + 20, a3, v12);
          ++dword_4335F8;
        }
        else
        {
          sub_403518(0, 0, a3, 0);
          v11 = 1;
        }
      }
      if ( !v6 || (unsigned int)strlen(v6) < 0x28 )
      {
        v14 = 0;
        goto LABEL_29;
      }
      v14 = dword_433600;
      if ( dword_433600 )
      {
        dword_433600 = *(_DWORD *)dword_433600;
LABEL_29:
        v15 = *(_DWORD **)(v9 + 4);
        if ( v15 )
          *v15 = *(_DWORD *)v9;
        else
          dword_4335E0 = *(_DWORD *)v9;
        if ( *(_DWORD *)v9 )
          *(_DWORD *)(*(_DWORD *)v9 + 4) = *(_DWORD *)(v9 + 4);
        else
          dword_4335E4 = *(_DWORD *)(v9 + 4);
        *(_WORD *)(v9 + 36) = v10;
        if ( v14 )
        {
          *(_DWORD *)(v9 + 40) = v14;
          *(_WORD *)(v9 + 36) = v10 | 0x200;
        }
        v16 = *(_WORD *)(v9 + 36);
        if ( v6 )
        {
          if ( (*(_WORD *)(v9 + 36) & 0x200) != 0 )
          {
            v17 = *(_DWORD *)(v9 + 40);
          }
          else
          {
            v17 = v9 + 40;
            if ( (v16 & 0x10) != 0 )
              v17 = *(_DWORD *)(v9 + 40);
          }
          strcpy(v17, v6);
        }
        else
        {
          if ( (*(_WORD *)(v9 + 36) & 0x200) != 0 )
          {
            v18 = *(_BYTE **)(v9 + 40);
          }
          else
          {
            v19 = (v16 & 0x10) == 0;
            v18 = (_BYTE *)(v9 + 40);
            if ( !v19 )
              v18 = *(_BYTE **)(v9 + 40);
          }
          *v18 = 0;
        }
        if ( a2 )
          memcpy(v9 + 20, a2, v8);
        else
          *(_DWORD *)(v9 + 20) = 0;
        *(_DWORD *)(v9 + 12) = a4 + a3;
        *(_DWORD *)v9 = dword_4335F0;
        dword_4335F0 = v9;
        return v9;
      }
      if ( dword_433604 )
      {
        v14 = malloc(1028);
        if ( v14 )
        {
          --dword_433604;
          goto LABEL_29;
        }
      }
      dword_4335FC = 1;
    }
    else
    {
      dword_4335FC = 1;
    }
    v9 = 0;
  }
  return v9;
}
